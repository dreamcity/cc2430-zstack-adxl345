///////////////////////////////////////////////////////////////////////////////
//                                                                            /
// IAR 8051 C/C++ Compiler V7.30B/W32                   10/Mar/2013  13:19:53 /
// Copyright 2004-2007 IAR Systems. All rights reserved.                      /
//                                                                            /
//    Core               =  plain                                             /
//    Code model         =  banked                                            /
//    Data model         =  large                                             /
//    Calling convention =  xdata reentrant                                   /
//    Constant location  =  data                                              /
//    Dptr setup         =  1,16                                              /
//    Source file        =  C:\Texas Instruments\ZStack-1.4.3-1.2.1\Component /
//                          s\mt\MTEL.c                                       /
//    Command line       =  -f "C:\Texas Instruments\ZStack-1.4.3-1.2.1\Proje /
//                          cts\zstack\Samples\cc2430-zstack-adxl345\CC2430DB /
//                          \..\..\..\Tools\CC2430DB\f8wEndev.cfg"            /
//                          (-DCPU32MHZ -DFORCE_MAC_NEAR -DROOT=__near_func   /
//                          -DMAC_OPT_FFD=0 -DBLINK_LEDS "-DCONST=const       /
//                          __code" -DGENERIC=__generic) -f "C:\Texas         /
//                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sa /
//                          mples\cc2430-zstack-adxl345\CC2430DB\..\..\..\Too /
//                          ls\CC2430DB\f8wConfig.cfg" (-DSECURE=0            /
//                          -DDEFAULT_CHANLIST=0x00000800                     /
//                          -DZDAPP_CONFIG_PAN_ID=0xFFFF                      /
//                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_M /
//                          ASK=0x007F -DBEACON_REQUEST_DELAY=100             /
//                          -DBEACON_REQ_DELAY_MASK=0x00FF                    /
//                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_P /
//                          OLLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7           /
//                          -DMAX_RREQ_ENTRIES=10 -DAPSC_MAX_FRAME_RETRIES=3  /
//                          -DNWK_MAX_DATA_RETRIES=2                          /
//                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9        /
//                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=20          /
//                          -DNWK_MAX_BINDING_ENTRIES=10                      /
//                          -DMAX_BINDING_CLUSTER_IDS=5                       /
//                          "-DDEFAULT_KEY={0x01, 0x03, 0x05, 0x07, 0x09,     /
//                          0x0B, 0x0D, 0x0F, 0x00, 0x02, 0x04, 0x06, 0x08,   /
//                          0x0A, 0x0C, 0x0D}" -DRFD_RCVC_ALWAYS_ON=FALSE     /
//                          -DPOLL_RATE=1000 -DQUEUED_POLL_RATE=100           /
//                          -DRESPONSE_POLL_RATE=100) -DREJOIN_POLL_RATE=440  /
//                          "C:\Texas Instruments\ZStack-1.4.3-1.2.1\Componen /
//                          ts\mt\MTEL.c" -D CC2430EB -D AXD_END -D           /
//                          NWK_AUTO_POLL -D REFLECTOR -D ZTOOL_P1 -D         /
//                          MT_TASK -D xMT_ZDO_FUNC -D LCD_SUPPORTED=DEBUG    /
//                          -D xPOWER_SAVING -lC "C:\Texas                    /
//                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sa /
//                          mples\cc2430-zstack-adxl345\CC2430DB\EndDeviceEB\ /
//                          List\" -lA "C:\Texas Instruments\ZStack-1.4.3-1.2 /
//                          .1\Projects\zstack\Samples\cc2430-zstack-adxl345\ /
//                          CC2430DB\EndDeviceEB\List\" --diag_suppress       /
//                          Pe001,Pa010 --diag_remark pe550 -o "C:\Texas      /
//                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sa /
//                          mples\cc2430-zstack-adxl345\CC2430DB\EndDeviceEB\ /
//                          Obj\" -e --require_prototypes -z2 --no_cse        /
//                          --no_unroll --no_inline --no_code_motion          /
//                          --no_tbaa --debug --core=plain --dptr=16,1        /
//                          --data_model=large --code_model=banked            /
//                          --calling_convention=xdata_reentrant              /
//                          --place_constants=data --nr_virtual_regs 8 -I     /
//                          "C:\Texas Instruments\ZStack-1.4.3-1.2.1\Projects /
//                          \zstack\Samples\cc2430-zstack-adxl345\CC2430DB\"  /
//                          -I "C:\Texas Instruments\ZStack-1.4.3-1.2.1\Proje /
//                          cts\zstack\Samples\cc2430-zstack-adxl345\CC2430DB /
//                          \..\SOURCE\" -I "C:\Texas                         /
//                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sa /
//                          mples\cc2430-zstack-adxl345\CC2430DB\..\Drivers\" /
//                           -I "C:\Texas Instruments\ZStack-1.4.3-1.2.1\Proj /
//                          ects\zstack\Samples\cc2430-zstack-adxl345\CC2430D /
//                          B\..\..\..\ZMAIN\TI2430DB\" -I "C:\Texas          /
//                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sa /
//                          mples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\ /
//                          ..\COMPONENTS\MT\" -I "C:\Texas                   /
//                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sa /
//                          mples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\ /
//                          ..\COMPONENTS\HAL\INCLUDE\" -I "C:\Texas          /
//                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sa /
//                          mples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\ /
//                          ..\COMPONENTS\HAL\TARGET\CC2430EB\" -I "C:\Texas  /
//                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sa /
//                          mples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\ /
//                          ..\COMPONENTS\OSAL\MCU\CCSOC\" -I "C:\Texas       /
//                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sa /
//                          mples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\ /
//                          ..\COMPONENTS\OSAL\INCLUDE\" -I "C:\Texas         /
//                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sa /
//                          mples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\ /
//                          ..\COMPONENTS\STACK\AF\" -I "C:\Texas             /
//                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sa /
//                          mples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\ /
//                          ..\COMPONENTS\STACK\NWK\" -I "C:\Texas            /
//                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sa /
//                          mples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\ /
//                          ..\COMPONENTS\STACK\SEC\" -I "C:\Texas            /
//                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sa /
//                          mples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\ /
//                          ..\COMPONENTS\STACK\SYS\" -I "C:\Texas            /
//                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sa /
//                          mples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\ /
//                          ..\COMPONENTS\STACK\ZDO\" -I "C:\Texas            /
//                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sa /
//                          mples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\ /
//                          ..\COMPONENTS\ZMAC\F8W\" -I "C:\Texas             /
//                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sa /
//                          mples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\ /
//                          ..\COMPONENTS\ZMAC\" -I "C:\Texas                 /
//                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sa /
//                          mples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\ /
//                          ..\COMPONENTS\SERVICES\SADDR\" -I "C:\Texas       /
//                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sa /
//                          mples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\ /
//                          ..\COMPONENTS\SERVICES\SDATA\" -I "C:\Texas       /
//                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sa /
//                          mples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\ /
//                          ..\COMPONENTS\MAC\INCLUDE\" -I "C:\Texas          /
//                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sa /
//                          mples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\ /
//                          ..\COMPONENTS\MAC\HIGH_LEVEL\" -I "C:\Texas       /
//                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sa /
//                          mples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\ /
//                          ..\COMPONENTS\MAC\LOW_LEVEL\SRF03\" -I "C:\Texas  /
//                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sa /
//                          mples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\ /
//                          ..\COMPONENTS\MAC\LOW_LEVEL\SRF03\SINGLE_CHIP\"   /
//                          -I "C:\Program Files\IAR Systems\Embedded         /
//                          Workbench 4.0 Evaluation version\8051\INC\" -I    /
//                          "C:\Program Files\IAR Systems\Embedded Workbench  /
//                          4.0 Evaluation version\8051\INC\CLIB\"            /
//    List file          =  C:\Texas Instruments\ZStack-1.4.3-1.2.1\Projects\ /
//                          zstack\Samples\cc2430-zstack-adxl345\CC2430DB\End /
//                          DeviceEB\List\MTEL.s51                            /
//                                                                            /
//                                                                            /
///////////////////////////////////////////////////////////////////////////////

        NAME MTEL

        RTMODEL "__calling_convention", "xdata_reentrant"
        RTMODEL "__code_model", "banked"
        RTMODEL "__core", "plain"
        RTMODEL "__data_model", "large"
        RTMODEL "__dptr_size", "16"
        RTMODEL "__extended_stack", "disabled"
        RTMODEL "__location_for_constants", "data"
        RTMODEL "__number_of_dptrs", "1"
        RTMODEL "__rt_version", "1"

        RSEG DOVERLAY:DATA:NOROOT(0)
        RSEG IOVERLAY:IDATA:NOROOT(0)
        RSEG ISTACK:IDATA:NOROOT(0)
        RSEG PSTACK:XDATA:NOROOT(0)
        RSEG XSTACK:XDATA:NOROOT(0)

        EXTERN ??MTProcessAppMsg?relay
        EXTERN ??MTProcessAppRspMsg?relay
        EXTERN ??MTProcessLedControl?relay
        EXTERN ??MT_BuildAndSendZToolResponse?relay
        EXTERN ??MT_BuildSPIMsg?relay
        EXTERN ??MT_ProcessCommand?relay
        EXTERN ??MT_ProcessDebugMsg?relay
        EXTERN ??MT_ProcessDebugStr?relay
        EXTERN ??MT_ProcessGetDeviceInfo?relay
        EXTERN ??MT_ProcessGetNV?relay
        EXTERN ??MT_ProcessGetNvInfo?relay
        EXTERN ??MT_ProcessSerialCommand?relay
        EXTERN ??MT_ProcessSetNV?relay
        EXTERN ??MT_RAMRead?relay
        EXTERN ??MT_RAMWrite?relay
        EXTERN ??MT_Reset?relay
        EXTERN ??MT_ReverseBytes?relay
        EXTERN ??MT_SendErrorNotification?relay
        EXTERN ??MT_SetDebugThreshold?relay
        EXTERN ?ALLOC_XSTACK8
        EXTERN ?BANKED_ENTER_XDATA
        EXTERN ?BANKED_LEAVE_XDATA
        EXTERN ?BDISPATCH
        EXTERN ?BRET
        EXTERN ?DEALLOC_XSTACK8
        EXTERN ?L_ADD
        EXTERN ?L_MOV_TO_X
        EXTERN ?L_MOV_X
        EXTERN ?L_SHL
        EXTERN ?PUSH_XSTACK8_X_TWO
        EXTERN ?PUSH_XSTACK_I_THREE
        EXTERN ?PUSH_XSTACK_I_TWO
        EXTERN ?UC_SWITCH_SPARSE
        EXTERN ?UL_DIV_MOD
        EXTERN ?UL_SHR
        EXTERN ?US_SWITCH_DENSE
        EXTERN ?V0
        EXTERN ?XSP
        EXTERN ?XSTACK_DISP0_8
        EXTERN __INIT_XDATA_I
        EXTERN __INIT_XDATA_Z

        PUBLIC ??MTProcessAppMsg?relay
        FUNCTION ??MTProcessAppMsg?relay,0203H
        PUBLIC ??MTProcessAppRspMsg?relay
        FUNCTION ??MTProcessAppRspMsg?relay,0203H
        PUBLIC ??MTProcessLedControl?relay
        FUNCTION ??MTProcessLedControl?relay,0203H
        PUBLIC ??MT_BuildAndSendZToolCB?relay
        FUNCTION ??MT_BuildAndSendZToolCB?relay,0203H
        PUBLIC ??MT_BuildAndSendZToolResponse?relay
        FUNCTION ??MT_BuildAndSendZToolResponse?relay,0203H
        PUBLIC ??MT_BuildSPIMsg?relay
        FUNCTION ??MT_BuildSPIMsg?relay,0203H
        PUBLIC ??MT_IndReset?relay
        FUNCTION ??MT_IndReset?relay,0203H
        PUBLIC ??MT_ProcessCommand?relay
        FUNCTION ??MT_ProcessCommand?relay,0203H
        PUBLIC ??MT_ProcessDebugMsg?relay
        FUNCTION ??MT_ProcessDebugMsg?relay,0203H
        PUBLIC ??MT_ProcessDebugStr?relay
        FUNCTION ??MT_ProcessDebugStr?relay,0203H
        PUBLIC ??MT_ProcessEvent?relay
        FUNCTION ??MT_ProcessEvent?relay,0203H
        PUBLIC ??MT_ProcessGetDeviceInfo?relay
        FUNCTION ??MT_ProcessGetDeviceInfo?relay,0203H
        PUBLIC ??MT_ProcessGetNV?relay
        FUNCTION ??MT_ProcessGetNV?relay,0203H
        PUBLIC ??MT_ProcessGetNvInfo?relay
        FUNCTION ??MT_ProcessGetNvInfo?relay,0203H
        PUBLIC ??MT_ProcessSerialCommand?relay
        FUNCTION ??MT_ProcessSerialCommand?relay,0203H
        PUBLIC ??MT_ProcessSetNV?relay
        FUNCTION ??MT_ProcessSetNV?relay,0203H
        PUBLIC ??MT_RAMRead?relay
        FUNCTION ??MT_RAMRead?relay,0203H
        PUBLIC ??MT_RAMWrite?relay
        FUNCTION ??MT_RAMWrite?relay,0203H
        PUBLIC ??MT_Reset?relay
        FUNCTION ??MT_Reset?relay,0203H
        PUBLIC ??MT_ReverseBytes?relay
        FUNCTION ??MT_ReverseBytes?relay,0203H
        PUBLIC ??MT_SendErrorNotification?relay
        FUNCTION ??MT_SendErrorNotification?relay,0203H
        PUBLIC ??MT_SendSPIRespMsg?relay
        FUNCTION ??MT_SendSPIRespMsg?relay,0203H
        PUBLIC ??MT_SetDebugThreshold?relay
        FUNCTION ??MT_SetDebugThreshold?relay,0203H
        PUBLIC ??MT_TaskInit?relay
        FUNCTION ??MT_TaskInit?relay,0203H
        PUBLIC MTProcessAppMsg
        FUNCTION MTProcessAppMsg,021203H
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 21, STACK
        PUBLIC MTProcessAppRspMsg
        FUNCTION MTProcessAppRspMsg,021203H
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 12, STACK
        PUBLIC MTProcessLedControl
        FUNCTION MTProcessLedControl,021203H
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 12, STACK
        PUBLIC MTVersionString
        PUBLIC MT_BuildAndSendZToolCB
        FUNCTION MT_BuildAndSendZToolCB,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 22, STACK
        PUBLIC MT_BuildAndSendZToolResponse
        FUNCTION MT_BuildAndSendZToolResponse,021203H
        ARGFRAME XSTACK, 45, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 18, STACK
        PUBLIC MT_BuildSPIMsg
        FUNCTION MT_BuildSPIMsg,021203H
        ARGFRAME XSTACK, 29, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 21, STACK
        PUBLIC MT_IndReset
        FUNCTION MT_IndReset,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 13, STACK
        PUBLIC MT_ProcessCommand
        FUNCTION MT_ProcessCommand,0a1203H
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 14, STACK
        PUBLIC MT_ProcessDebugMsg
        FUNCTION MT_ProcessDebugMsg,021203H
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 29, STACK
        PUBLIC MT_ProcessDebugStr
        FUNCTION MT_ProcessDebugStr,021203H
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 14, STACK
        PUBLIC MT_ProcessEvent
        FUNCTION MT_ProcessEvent,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        PUBLIC MT_ProcessGetDeviceInfo
        FUNCTION MT_ProcessGetDeviceInfo,021203H
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 25, STACK
        PUBLIC MT_ProcessGetNV
        FUNCTION MT_ProcessGetNV,021203H
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 22, STACK
        PUBLIC MT_ProcessGetNvInfo
        FUNCTION MT_ProcessGetNvInfo,021203H
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 28, STACK
        PUBLIC MT_ProcessSerialCommand
        FUNCTION MT_ProcessSerialCommand,0a1203H
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 47, STACK
        PUBLIC MT_ProcessSetNV
        FUNCTION MT_ProcessSetNV,021203H
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 18, STACK
        PUBLIC MT_RAMRead
        FUNCTION MT_RAMRead,0203H
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 9, STACK
        PUBLIC MT_RAMWrite
        FUNCTION MT_RAMWrite,0203H
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 3, STACK
        PUBLIC MT_Reset
        FUNCTION MT_Reset,080203H
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 12, STACK
        PUBLIC MT_ReverseBytes
        FUNCTION MT_ReverseBytes,0203H
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 10, STACK
        PUBLIC MT_SendErrorNotification
        FUNCTION MT_SendErrorNotification,021203H
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 13, STACK
        PUBLIC MT_SendSPIRespMsg
        FUNCTION MT_SendSPIRespMsg,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 17, STACK
        PUBLIC MT_SetDebugThreshold
        FUNCTION MT_SetDebugThreshold,0203H
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 2, STACK
        PUBLIC MT_TaskID
        PUBLIC MT_TaskInit
        FUNCTION MT_TaskInit,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        PUBWEAK WDCTL
        PUBWEAK _A_IEN0
        PUBWEAK __Constant_3e8
        PUBWEAK __Constant_53544159
        PUBLIC debugCompId
        PUBLIC debugThreshold
        PUBLIC longvar
        PUBWEAK mboxMsg
        PUBLIC save_cmd
        PUBLIC temp_glob_ptr1
        PUBLIC temp_glob_ptr2
        
        CFI Names cfiNames0
        CFI StackFrame CFA_SP SP DATA
        CFI StackFrame CFA_PSP16 PSP16 XDATA
        CFI StackFrame CFA_XSP16 XSP16 XDATA
        CFI StaticOverlayFrame CFA_IOVERLAY IOVERLAY
        CFI StaticOverlayFrame CFA_DOVERLAY DOVERLAY
        CFI Resource `PSW.CY`:1, `B.BR0`:1, `B.BR1`:1, `B.BR2`:1, `B.BR3`:1
        CFI Resource `B.BR4`:1, `B.BR5`:1, `B.BR6`:1, `B.BR7`:1, `VB.BR8`:1
        CFI Resource `VB.BR9`:1, `VB.BR10`:1, `VB.BR11`:1, `VB.BR12`:1
        CFI Resource `VB.BR13`:1, `VB.BR14`:1, `VB.BR15`:1, VB:8, B:8, A:8
        CFI Resource PSW:8, DPL0:8, DPH0:8, R0:8, R1:8, R2:8, R3:8, R4:8, R5:8
        CFI Resource R6:8, R7:8, V0:8, V1:8, V2:8, V3:8, V4:8, V5:8, V6:8, V7:8
        CFI Resource SP:8, PSPH:8, PSPL:8, PSP16:16, XSPH:8, XSPL:8, XSP16:16
        CFI VirtualResource ?RET:24
        CFI Resource ?BRET_EXT:8
        CFI VirtualResource ?RET_HIGH:8, ?RET_LOW:8
        CFI ResourceParts PSP16 PSPH, PSPL
        CFI ResourceParts XSP16 XSPH, XSPL
        CFI ResourceParts ?RET ?BRET_EXT, ?RET_HIGH, ?RET_LOW
        CFI EndNames cfiNames0
        
        CFI Common cfiCommon0 Using cfiNames0
        CFI CodeAlign 1
        CFI DataAlign -1
        CFI ReturnAddress ?RET CODE
        CFI CFA_DOVERLAY Used
        CFI CFA_IOVERLAY Used
        CFI CFA_SP SP+-3
        CFI CFA_PSP16 PSP16+0
        CFI CFA_XSP16 XSP16+0
        CFI `PSW.CY` SameValue
        CFI `B.BR0` SameValue
        CFI `B.BR1` SameValue
        CFI `B.BR2` SameValue
        CFI `B.BR3` SameValue
        CFI `B.BR4` SameValue
        CFI `B.BR5` SameValue
        CFI `B.BR6` SameValue
        CFI `B.BR7` SameValue
        CFI `VB.BR8` SameValue
        CFI `VB.BR9` SameValue
        CFI `VB.BR10` SameValue
        CFI `VB.BR11` SameValue
        CFI `VB.BR12` SameValue
        CFI `VB.BR13` SameValue
        CFI `VB.BR14` SameValue
        CFI `VB.BR15` SameValue
        CFI VB SameValue
        CFI B Undefined
        CFI A Undefined
        CFI PSW SameValue
        CFI DPL0 SameValue
        CFI DPH0 SameValue
        CFI R0 Undefined
        CFI R1 Undefined
        CFI R2 Undefined
        CFI R3 Undefined
        CFI R4 Undefined
        CFI R5 Undefined
        CFI R6 SameValue
        CFI R7 SameValue
        CFI V0 SameValue
        CFI V1 SameValue
        CFI V2 SameValue
        CFI V3 SameValue
        CFI V4 SameValue
        CFI V5 SameValue
        CFI V6 SameValue
        CFI V7 SameValue
        CFI PSPH Undefined
        CFI PSPL Undefined
        CFI XSPH Undefined
        CFI XSPL Undefined
        CFI ?RET Concat
        CFI ?BRET_EXT Frame(CFA_SP, 3)
        CFI ?RET_HIGH Frame(CFA_SP, 2)
        CFI ?RET_LOW Frame(CFA_SP, 1)
        CFI EndCommon cfiCommon0
        
SPIMgr_Init         SYMBOL "SPIMgr_Init"
osal_msg_receive    SYMBOL "osal_msg_receive"
osal_memcpy         SYMBOL "osal_memcpy"
SPIMgr_CalcFCS      SYMBOL "SPIMgr_CalcFCS"
osal_mem_alloc      SYMBOL "osal_mem_alloc"
HalUARTWrite        SYMBOL "HalUARTWrite"
osal_mem_free       SYMBOL "osal_mem_free"
osal_msg_allocate   SYMBOL "osal_msg_allocate"
osal_msg_send       SYMBOL "osal_msg_send"
osal_msg_deallocate SYMBOL "osal_msg_deallocate"
osal_nv_item_len    SYMBOL "osal_nv_item_len"
osal_nv_write       SYMBOL "osal_nv_write"
osal_memset         SYMBOL "osal_memset"
osal_nv_read        SYMBOL "osal_nv_read"
NLME_GetShortAddr   SYMBOL "NLME_GetShortAddr"
NLME_GetProtocolVersion SYMBOL "NLME_GetProtocolVersion"
osal_strlen         SYMBOL "osal_strlen"
osal_GetSystemClock SYMBOL "osal_GetSystemClock"
OnBoard_SendKeys    SYMBOL "OnBoard_SendKeys"
HalLedSet           SYMBOL "HalLedSet"
afFindEndPointDesc  SYMBOL "afFindEndPointDesc"
??HalLedSet?relay   SYMBOL "?relay", HalLedSet
??HalUARTWrite?relay SYMBOL "?relay", HalUARTWrite
??NLME_GetProtocolVersion?relay SYMBOL "?relay", NLME_GetProtocolVersion
??NLME_GetShortAddr?relay SYMBOL "?relay", NLME_GetShortAddr
??OnBoard_SendKeys?relay SYMBOL "?relay", OnBoard_SendKeys
??SPIMgr_CalcFCS?relay SYMBOL "?relay", SPIMgr_CalcFCS
??SPIMgr_Init?relay SYMBOL "?relay", SPIMgr_Init
??afFindEndPointDesc?relay SYMBOL "?relay", afFindEndPointDesc
??osal_GetSystemClock?relay SYMBOL "?relay", osal_GetSystemClock
??osal_mem_alloc?relay SYMBOL "?relay", osal_mem_alloc
??osal_mem_free?relay SYMBOL "?relay", osal_mem_free
??osal_memcpy?relay SYMBOL "?relay", osal_memcpy
??osal_memset?relay SYMBOL "?relay", osal_memset
??osal_msg_allocate?relay SYMBOL "?relay", osal_msg_allocate
??osal_msg_deallocate?relay SYMBOL "?relay", osal_msg_deallocate
??osal_msg_receive?relay SYMBOL "?relay", osal_msg_receive
??osal_msg_send?relay SYMBOL "?relay", osal_msg_send
??osal_nv_item_len?relay SYMBOL "?relay", osal_nv_item_len
??osal_nv_read?relay SYMBOL "?relay", osal_nv_read
??osal_nv_write?relay SYMBOL "?relay", osal_nv_write
??osal_strlen?relay SYMBOL "?relay", osal_strlen
MTProcessAppMsg     SYMBOL "MTProcessAppMsg"
??MTProcessAppMsg?relay SYMBOL "?relay", MTProcessAppMsg
MTProcessAppRspMsg  SYMBOL "MTProcessAppRspMsg"
??MTProcessAppRspMsg?relay SYMBOL "?relay", MTProcessAppRspMsg
MTProcessLedControl SYMBOL "MTProcessLedControl"
??MTProcessLedControl?relay SYMBOL "?relay", MTProcessLedControl
MT_BuildAndSendZToolCB SYMBOL "MT_BuildAndSendZToolCB"
??MT_BuildAndSendZToolCB?relay SYMBOL "?relay", MT_BuildAndSendZToolCB
MT_BuildAndSendZToolResponse SYMBOL "MT_BuildAndSendZToolResponse"
??MT_BuildAndSendZToolResponse?relay SYMBOL "?relay", MT_BuildAndSendZToolResponse
MT_BuildSPIMsg      SYMBOL "MT_BuildSPIMsg"
??MT_BuildSPIMsg?relay SYMBOL "?relay", MT_BuildSPIMsg
MT_IndReset         SYMBOL "MT_IndReset"
??MT_IndReset?relay SYMBOL "?relay", MT_IndReset
MT_ProcessCommand   SYMBOL "MT_ProcessCommand"
??MT_ProcessCommand?relay SYMBOL "?relay", MT_ProcessCommand
MT_ProcessDebugMsg  SYMBOL "MT_ProcessDebugMsg"
??MT_ProcessDebugMsg?relay SYMBOL "?relay", MT_ProcessDebugMsg
MT_ProcessDebugStr  SYMBOL "MT_ProcessDebugStr"
??MT_ProcessDebugStr?relay SYMBOL "?relay", MT_ProcessDebugStr
MT_ProcessEvent     SYMBOL "MT_ProcessEvent"
??MT_ProcessEvent?relay SYMBOL "?relay", MT_ProcessEvent
MT_ProcessGetDeviceInfo SYMBOL "MT_ProcessGetDeviceInfo"
??MT_ProcessGetDeviceInfo?relay SYMBOL "?relay", MT_ProcessGetDeviceInfo
MT_ProcessGetNV     SYMBOL "MT_ProcessGetNV"
??MT_ProcessGetNV?relay SYMBOL "?relay", MT_ProcessGetNV
MT_ProcessGetNvInfo SYMBOL "MT_ProcessGetNvInfo"
??MT_ProcessGetNvInfo?relay SYMBOL "?relay", MT_ProcessGetNvInfo
MT_ProcessSerialCommand SYMBOL "MT_ProcessSerialCommand"
??MT_ProcessSerialCommand?relay SYMBOL "?relay", MT_ProcessSerialCommand
MT_ProcessSetNV     SYMBOL "MT_ProcessSetNV"
??MT_ProcessSetNV?relay SYMBOL "?relay", MT_ProcessSetNV
MT_RAMRead          SYMBOL "MT_RAMRead"
??MT_RAMRead?relay  SYMBOL "?relay", MT_RAMRead
MT_RAMWrite         SYMBOL "MT_RAMWrite"
??MT_RAMWrite?relay SYMBOL "?relay", MT_RAMWrite
MT_Reset            SYMBOL "MT_Reset"
??MT_Reset?relay    SYMBOL "?relay", MT_Reset
MT_ReverseBytes     SYMBOL "MT_ReverseBytes"
??MT_ReverseBytes?relay SYMBOL "?relay", MT_ReverseBytes
MT_SendErrorNotification SYMBOL "MT_SendErrorNotification"
??MT_SendErrorNotification?relay SYMBOL "?relay", MT_SendErrorNotification
MT_SendSPIRespMsg   SYMBOL "MT_SendSPIRespMsg"
??MT_SendSPIRespMsg?relay SYMBOL "?relay", MT_SendSPIRespMsg
MT_SetDebugThreshold SYMBOL "MT_SetDebugThreshold"
??MT_SetDebugThreshold?relay SYMBOL "?relay", MT_SetDebugThreshold
MT_TaskInit         SYMBOL "MT_TaskInit"
??MT_TaskInit?relay SYMBOL "?relay", MT_TaskInit

        EXTERN SPIMgr_Init
        FUNCTION SPIMgr_Init,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_msg_receive
        FUNCTION osal_msg_receive,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_memcpy
        FUNCTION osal_memcpy,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN SPIMgr_CalcFCS
        FUNCTION SPIMgr_CalcFCS,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_mem_alloc
        FUNCTION osal_mem_alloc,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 24, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN HalUARTWrite
        FUNCTION HalUARTWrite,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 27, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_mem_free
        FUNCTION osal_mem_free,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 24, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_msg_allocate
        FUNCTION osal_msg_allocate,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 27, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_msg_send
        FUNCTION osal_msg_send,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 19, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_msg_deallocate
        FUNCTION osal_msg_deallocate,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 27, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_nv_item_len
        FUNCTION osal_nv_item_len,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_nv_write
        FUNCTION osal_nv_write,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 47, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_memset
        FUNCTION osal_memset,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 24, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_nv_read
        FUNCTION osal_nv_read,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 28, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN NLME_GetShortAddr
        FUNCTION NLME_GetShortAddr,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 21, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN NLME_GetProtocolVersion
        FUNCTION NLME_GetProtocolVersion,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_strlen
        FUNCTION osal_strlen,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN ZMacSetReq
        FUNCTION ZMacSetReq,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN ZMacGetReq
        FUNCTION ZMacGetReq,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_GetSystemClock
        FUNCTION osal_GetSystemClock,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN OnBoard_SendKeys
        FUNCTION OnBoard_SendKeys,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN HalLedSet
        FUNCTION HalLedSet,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 12, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN afFindEndPointDesc
        FUNCTION afFindEndPointDesc,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN ??HalLedSet?relay
        FUNCTION ??HalLedSet?relay,00H
        EXTERN ??HalUARTWrite?relay
        FUNCTION ??HalUARTWrite?relay,00H
        EXTERN ??NLME_GetProtocolVersion?relay
        FUNCTION ??NLME_GetProtocolVersion?relay,00H
        EXTERN ??NLME_GetShortAddr?relay
        FUNCTION ??NLME_GetShortAddr?relay,00H
        EXTERN ??OnBoard_SendKeys?relay
        FUNCTION ??OnBoard_SendKeys?relay,00H
        EXTERN ??SPIMgr_CalcFCS?relay
        FUNCTION ??SPIMgr_CalcFCS?relay,00H
        EXTERN ??SPIMgr_Init?relay
        FUNCTION ??SPIMgr_Init?relay,00H
        EXTERN ??afFindEndPointDesc?relay
        FUNCTION ??afFindEndPointDesc?relay,00H
        EXTERN ??osal_GetSystemClock?relay
        FUNCTION ??osal_GetSystemClock?relay,00H
        EXTERN ??osal_mem_alloc?relay
        FUNCTION ??osal_mem_alloc?relay,00H
        EXTERN ??osal_mem_free?relay
        FUNCTION ??osal_mem_free?relay,00H
        EXTERN ??osal_memcpy?relay
        FUNCTION ??osal_memcpy?relay,00H
        EXTERN ??osal_memset?relay
        FUNCTION ??osal_memset?relay,00H
        EXTERN ??osal_msg_allocate?relay
        FUNCTION ??osal_msg_allocate?relay,00H
        EXTERN ??osal_msg_deallocate?relay
        FUNCTION ??osal_msg_deallocate?relay,00H
        EXTERN ??osal_msg_receive?relay
        FUNCTION ??osal_msg_receive?relay,00H
        EXTERN ??osal_msg_send?relay
        FUNCTION ??osal_msg_send?relay,00H
        EXTERN ??osal_nv_item_len?relay
        FUNCTION ??osal_nv_item_len?relay,00H
        EXTERN ??osal_nv_read?relay
        FUNCTION ??osal_nv_read?relay,00H
        EXTERN ??osal_nv_write?relay
        FUNCTION ??osal_nv_write?relay,00H
        EXTERN ??osal_strlen?relay
        FUNCTION ??osal_strlen?relay,00H
        EXTERN devState

// C:\Texas Instruments\ZStack-1.4.3-1.2.1\Components\mt\MTEL.c
//    1 /**************************************************************************************************
//    2   Filename:       MTEL.c
//    3   Revised:        $Date: 2007-12-07 14:27:57 -0800 (Fri, 07 Dec 2007) $
//    4   Revision:       $Revision: 16045 $
//    5 
//    6   Description:    MonitorTest Event Loop functions. Everything in the MonitorTest Task.
//    7 
//    8 
//    9   Copyright 2004-2007 Texas Instruments Incorporated. All rights reserved.
//   10 
//   11   IMPORTANT: Your use of this Software is limited to those specific rights
//   12   granted under the terms of a software license agreement between the user
//   13   who downloaded the software, his/her employer (which must be your employer)
//   14   and Texas Instruments Incorporated (the "License").  You may not use this
//   15   Software unless you agree to abide by the terms of the License. The License
//   16   limits your use, and you acknowledge, that the Software may not be modified,
//   17   copied or distributed unless embedded on a Texas Instruments microcontroller
//   18   or used solely and exclusively in conjunction with a Texas Instruments radio
//   19   frequency transceiver, which is integrated into your product.  Other than for
//   20   the foregoing purpose, you may not use, reproduce, copy, prepare derivative
//   21   works of, modify, distribute, perform, display or sell this Software and/or
//   22   its documentation for any purpose.
//   23 
//   24   YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
//   25   PROVIDED “AS IS” WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED, 
//   26   INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE, 
//   27   NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
//   28   TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
//   29   NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
//   30   LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
//   31   INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
//   32   OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
//   33   OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
//   34   (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
//   35 
//   36   Should you have any questions regarding your right to use this Software,
//   37   contact Texas Instruments Incorporated at www.TI.com. 
//   38 **************************************************************************************************/
//   39 
//   40 #if defined( MT_TASK )
//   41 
//   42 /*********************************************************************
//   43  * INCLUDES
//   44  */
//   45 #include "ZComDef.h"
//   46 #include "OnBoard.h"

        ASEGN SFR_AN:DATA:NOROOT,0a8H
// union <unnamed> volatile __sfr _A_IEN0
_A_IEN0:
        DS 1

        ASEGN SFR_AN:DATA:NOROOT,0c9H
// unsigned char volatile __sfr WDCTL
WDCTL:
        DS 1

        ASEGN XDATA_AN:XDATA:NOROOT,0e000H
// mboxMsg_t __xdata mboxMsg
mboxMsg:
        DS 8

        RSEG XDATA_I:XDATA:NOROOT(0)
        DATA
`?<Constant "1.00 (F8W1.4.3)">`:
        DS 16
        REQUIRE `?<Initializer for <Constant "1.00 (F8W1.4.3)">`
        REQUIRE __INIT_XDATA_I

        RSEG XDATA_I:XDATA:NOROOT(0)
        DATA
`?<Constant "1.10 (F8W1.4.3)">`:
        DS 16
        REQUIRE `?<Initializer for <Constant "1.10 (F8W1.4.3)">`
        REQUIRE __INIT_XDATA_I
//   47 #include "OSAL.h"
//   48 #include "OSAL_Memory.h"
//   49 #include "OSAL_Nv.h"
//   50 #include "MTEL.h"
//   51 #include "DebugTrace.h"
//   52 #include "ZMAC.h"
//   53 
//   54 #if !defined ( NONWK )
//   55   #include "NLMEDE.h"
//   56   #include "nwk_bufs.h"
//   57   #include "ZDObject.h"
//   58   #include "ssp.h"
//   59   #include "nwk_util.h"
//   60 #endif
//   61 
//   62 #if defined( MT_MAC_FUNC ) || defined( MT_MAC_CB_FUNC )
//   63   #include "MT_MAC.h"
//   64 #endif
//   65 #if defined( MT_NWK_FUNC ) || defined( MT_NWK_CB_FUNC )
//   66   #include "MT_NWK.h"
//   67   #include "nwk.h"
//   68   #include "nwk_bufs.h"
//   69 #endif
//   70 #if defined( MT_AF_FUNC ) || defined( MT_AF_CB_FUNC )
//   71   #include "MT_AF.h"
//   72 #endif
//   73 #if defined( MT_USER_TEST_FUNC )
//   74   #include "AF.h"
//   75 #endif
//   76 #if defined( MT_ZDO_FUNC )
//   77   #include "MT_ZDO.h"
//   78 #endif
//   79 #if defined (MT_SAPI_FUNC)
//   80 	#include "MT_SAPI.h"
//   81 #endif
//   82 #if defined( APP_TP )
//   83  #include "TestProfile.h"
//   84 #endif
//   85 #if defined( APP_TP2 )
//   86  #include "TestProfile2.h"
//   87 #endif
//   88 
//   89 #if defined(APP_TGEN)
//   90   #include "TrafficGenApp.h"
//   91 #endif
//   92 #if defined(APP_DEBUG)
//   93 	#include "DebugApp.h"
//   94 #endif
//   95 #if defined (NWK_TEST)
//   96 	#include "HWTTApp.h"
//   97 #endif
//   98 
//   99 /* HAL */
//  100 #include "hal_uart.h"
//  101 #include "hal_led.h"
//  102 #include "hal_key.h"
//  103 #include "hal_mailbox.h"
//  104 #include "SPIMgr.h"
//  105 
//  106 /*********************************************************************
//  107  * MACROS
//  108  */
//  109 #define MTEL_DEBUG_INFO( nParams, p1, p2, p3 ) DEBUG_INFO( COMPID_MTEL, nParams, p1, p2, p3 )
//  110 
//  111 #if defined( EXTERNAL_RAM )
//  112   #define IS_MEM_VALID( Addr )  \ 
//  113         /* Check for valid internal RAM address. */\ 
//  114     ( ( (((Addr) >= MCU_RAM_BEG) && ((Addr) <= MCU_RAM_END)) ||  \ 
//  115         /* Check for valid external RAM address. */\ 
//  116         (((Addr) >= EXT_RAM_BEG) && ((Addr) <= EXT_RAM_END)) ) ? TRUE : FALSE )
//  117 #else
//  118   #define IS_MEM_VALID( Addr )  \ 
//  119         /* Check for valid internal RAM address. */\ 
//  120     ( ( ((Addr) >= MCU_RAM_BEG) && ((Addr) <= MCU_RAM_END) ) ? TRUE : FALSE )
//  121 #endif
//  122 
//  123 /*********************************************************************
//  124  * CONSTANTS
//  125  */
//  126 
//  127 #ifdef ZPORT
//  128 const char *MTVersionString[] = {"1.00 (F8W1.4.3-ZP)", "1.10 (F8W1.4.3-ZP)"};
//  129 #else

        RSEG XDATA_I:XDATA:NOROOT(0)
        DATA
//  130 const char *MTVersionString[] = {"1.00 (F8W1.4.3)", "1.10 (F8W1.4.3)"};
MTVersionString:
        DS 4
        REQUIRE `?<Initializer for MTVersionString>`
        REQUIRE __INIT_XDATA_I

        RSEG XDATA_I:XDATA:NOROOT(0)
        DATA
__Constant_3e8:
        DS 4
        REQUIRE `?<Initializer for __Constant_3e8>`
        REQUIRE __INIT_XDATA_I

        RSEG XDATA_I:XDATA:NOROOT(0)
        DATA
__Constant_53544159:
        DS 4
        REQUIRE `?<Initializer for __Constant_53544159>`
        REQUIRE __INIT_XDATA_I
//  131 #endif
//  132 
//  133 /*********************************************************************
//  134  * TYPEDEFS
//  135  */
//  136 
//  137 /*********************************************************************
//  138  * GLOBAL VARIABLES
//  139  */

        RSEG XDATA_Z:XDATA:NOROOT(0)
//  140 byte MT_TaskID;
MT_TaskID:
        DS 1
        REQUIRE __INIT_XDATA_Z

        RSEG XDATA_Z:XDATA:NOROOT(0)
//  141 byte debugThreshold;
debugThreshold:
        DS 1
        REQUIRE __INIT_XDATA_Z

        RSEG XDATA_Z:XDATA:NOROOT(0)
//  142 byte debugCompId;
debugCompId:
        DS 1
        REQUIRE __INIT_XDATA_Z
//  143 

        RSEG XDATA_Z:XDATA:NOROOT(0)
//  144 UINT16 save_cmd;
save_cmd:
        DS 2
        REQUIRE __INIT_XDATA_Z
//  145 
//  146 //DEBUG

        RSEG XDATA_Z:XDATA:NOROOT(0)
//  147 uint32 longvar;
longvar:
        DS 4
        REQUIRE __INIT_XDATA_Z

        RSEG XDATA_Z:XDATA:NOROOT(0)
//  148 uint16 *temp_glob_ptr1;
temp_glob_ptr1:
        DS 2
        REQUIRE __INIT_XDATA_Z

        RSEG XDATA_Z:XDATA:NOROOT(0)
//  149 uint16 *temp_glob_ptr2;
temp_glob_ptr2:
        DS 2
        REQUIRE __INIT_XDATA_Z
//  150 
//  151 /*********************************************************************
//  152  * EXTERNAL VARIABLES
//  153  */
//  154 
//  155 /*********************************************************************
//  156  * EXTERNAL FUNCTIONS
//  157  */
//  158 extern unsigned int mac_sim_eventLoop( void );
//  159 
//  160 #ifdef MACSIM
//  161   // Used to pass Zignet message
//  162   extern void MACSIM_TranslateMsg( byte *buf, byte bLen );
//  163 #endif
//  164 
//  165 /*********************************************************************
//  166  * LOCAL VARIABLES
//  167  */
//  168 
//  169 /*********************************************************************
//  170  * LOCAL FUNCTIONS
//  171  */
//  172 void MT_MsgQueueInit( void );
//  173 void MT_ProcessCommand( mtOSALSerialData_t *msg );
//  174 void MT_ProcessSerialCommand( byte *msg );
//  175 byte MT_RAMRead( UINT16 addr, byte *pData );
//  176 byte MT_RAMWrite( UINT16 addr , byte val );
//  177 void MT_ProcessDebugMsg( mtDebugMsg_t *pData );
//  178 void MT_ProcessDebugStr( mtDebugStr_t *pData );
//  179 byte MT_SetDebugThreshold( byte comp_id, byte threshold );
//  180 void MT_SendErrorNotification( byte err );
//  181 void MT_ResetMsgQueue( void );
//  182 byte MT_QueueMsg( byte *msg , byte len );
//  183 void MT_ProcessQueue( void );
//  184 void MT_SendSPIRespMsg( byte ret, uint16 cmd_id, byte msgLen, byte respLen);
//  185 void MT_Reset(byte typID);
//  186 byte MT_ProcessSetNV( byte *pData );
//  187 void MT_ProcessGetNV( byte *pData );
//  188 void MT_ProcessGetNvInfo( void );
//  189 void MT_ProcessGetDeviceInfo( void );
//  190 byte MTProcessAppMsg( byte *pData, byte len );
//  191 void MTProcessAppRspMsg( byte *pData, byte len );
//  192 
//  193 #if (defined HAL_LED) && (HAL_LED == TRUE)
//  194 byte MTProcessLedControl( byte *pData );
//  195 #endif
//  196 
//  197 #if defined ( MT_USER_TEST_FUNC )
//  198 void MT_ProcessAppUserCmd( byte *pData );
//  199 #endif
//  200 
//  201 /*********************************************************************
//  202  * @fn      MT_TaskInit
//  203  *
//  204  * @brief
//  205  *
//  206  *   MonitorTest Task Initialization.  This function is put into the
//  207  *   task table.
//  208  *
//  209  * @param   byte task_id - task ID of the MT Task
//  210  *
//  211  * @return  void
//  212  *
//  213  *********************************************************************/

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  214 void MT_TaskInit( byte task_id )
MT_TaskInit:
        CFI Block cfiBlock0 Using cfiCommon0
        CFI Function MT_TaskInit
//  215 {
        FUNCALL MT_TaskInit, SPIMgr_Init
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
        MOV     A,R1
//  216   MT_TaskID = task_id;
        MOV     DPTR,#MT_TaskID
        MOVX    @DPTR,A
//  217 
//  218   debugThreshold = 0;
        MOV     A,#0x0
        MOV     DPTR,#debugThreshold
        MOVX    @DPTR,A
//  219   debugCompId = 0;
        MOV     A,#0x0
        MOV     DPTR,#debugCompId
        MOVX    @DPTR,A
//  220 
//  221   // Initialize the Serial port
//  222   SPIMgr_Init();
        ; Setup parameters for call to function SPIMgr_Init
        LCALL   ??SPIMgr_Init?relay
//  223 
//  224 } /* MT_TaskInit() */
        MOV     R7,#0x1
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock0
//  225 
//  226 #ifdef ZTOOL_PORT
//  227 /*********************************************************************
//  228  * @fn      MT_IndReset()
//  229  *
//  230  * @brief   Sends a ZTOOL "reset response" message.
//  231  *
//  232  * @param   None
//  233  *
//  234  * @return  None
//  235  *
//  236  *********************************************************************/

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  237 void MT_IndReset( void )
MT_IndReset:
        CFI Block cfiBlock1 Using cfiCommon0
        CFI Function MT_IndReset
//  238 {
        FUNCALL MT_IndReset, MT_BuildAndSendZToolResponse
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 13, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 13, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xa
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 1
        MOV     A,#-0x1
        LCALL   ?ALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 11)
//  239 
//  240   byte rsp = 0;  // Reset type==0 indicates Z-Stack reset
        MOV     A,#0x0
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    @DPTR,A
//  241 
//  242   // Send out Reset Response message
//  243   MT_BuildAndSendZToolResponse( (SPI_0DATA_MSG_LEN + sizeof( rsp )),
//  244                                 (SPI_RESPONSE_BIT | SPI_CMD_SYS_RESET),
//  245                                 sizeof( rsp ), &rsp );
        ; Setup parameters for call to function MT_BuildAndSendZToolResponse
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 13)
        MOV     R4,#0x1
        MOV     R2,#0x5
        MOV     R3,#0x10
        MOV     R1,#0x6
        LCALL   ??MT_BuildAndSendZToolResponse?relay
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 11)
//  246 }
        MOV     A,#0x1
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 10)
        MOV     R7,#0x2
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock1
//  247 #endif
//  248 
//  249 /*********************************************************************
//  250  * @fn      MT_ProcessEvent
//  251  *
//  252  * @brief
//  253  *
//  254  *   MonitorTest Task Event Processor.  This task is put into the
//  255  *   task table.
//  256  *
//  257  * @param   byte task_id - task ID of the MT Task
//  258  * @param   UINT16 events - event(s) for the MT Task
//  259  *
//  260  * @return  void
//  261  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  262 UINT16 MT_ProcessEvent( byte task_id, UINT16 events )
MT_ProcessEvent:
        CFI Block cfiBlock2 Using cfiCommon0
        CFI Function MT_ProcessEvent
//  263 {
        FUNCALL MT_ProcessEvent, osal_msg_receive
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessEvent, MT_ProcessCommand
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessEvent, MT_SendErrorNotification
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xe
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-11)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-12)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-13)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-14)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 14)
        ; Saved register size: 14
        ; Auto size: 0
        MOV     A,R2
        MOV     R6,A
        MOV     A,R3
        MOV     R7,A
//  264   uint8 *msg_ptr;
//  265 
//  266   // Could be multiple events, so switch won't work
//  267 
//  268   if ( events & SYS_EVENT_MSG )
        MOV     A,#0x0
        ANL     A,R6
        MOV     R0,A
        MOV     A,#-0x80
        ANL     A,R7
        MOV     R1,A
        MOV     A,#0x0
        XRL     A,R0
        JNZ     ??MT_ProcessEvent_0
        MOV     A,#0x0
        XRL     A,R1
??MT_ProcessEvent_0:
        JZ      ??MT_ProcessEvent_1
//  269   {
//  270     while ( (msg_ptr = osal_msg_receive( MT_TaskID )) )
??MT_ProcessEvent_2:
        ; Setup parameters for call to function osal_msg_receive
        MOV     DPTR,#MT_TaskID
        MOVX    A,@DPTR
        MOV     R1,A
        LCALL   ??osal_msg_receive?relay
        MOV     ?V0 + 4,R2
        MOV     ?V0 + 5,R3
        MOV     R0,?V0 + 4
        MOV     R1,?V0 + 5
        MOV     ?V0 + 0,R0
        MOV     ?V0 + 1,R1
        MOV     A,R0
        XRL     A,#0x0
        JNZ     ??MT_ProcessEvent_3
        MOV     A,R1
        XRL     A,#0x0
??MT_ProcessEvent_3:
        JZ      ??MT_ProcessEvent_4
//  271     {
//  272       MT_ProcessCommand( (mtOSALSerialData_t *)msg_ptr );
        ; Setup parameters for call to function MT_ProcessCommand
        MOV     R2,?V0 + 0
        MOV     R3,?V0 + 1
        LCALL   ??MT_ProcessCommand?relay
        SJMP    ??MT_ProcessEvent_2
//  273     }
//  274 
//  275     // Return unproccessed events
//  276     return (events ^ SYS_EVENT_MSG);
??MT_ProcessEvent_4:
        MOV     A,#0x0
        XRL     A,R6
        MOV     R2,A
        MOV     A,#-0x80
        XRL     A,R7
        MOV     R3,A
        SJMP    ??MT_ProcessEvent_5
//  277   }
//  278 
//  279 #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
//  280   if ( events & MT_ZTOOL_SERIAL_RCV_BUFFER_FULL )
??MT_ProcessEvent_1:
        MOV     A,R6
        ANL     A,#0x4
        JZ      ??MT_ProcessEvent_6
//  281   {
//  282     // Do sometype of error processing
//  283     MT_SendErrorNotification(RECEIVE_BUFFER_FULL);
        ; Setup parameters for call to function MT_SendErrorNotification
        MOV     R1,#0x2
        LCALL   ??MT_SendErrorNotification?relay
//  284 
//  285     // Return unproccessed events
//  286     return (events ^ MT_ZTOOL_SERIAL_RCV_BUFFER_FULL);
        MOV     A,#0x4
        XRL     A,R6
        MOV     R2,A
        MOV     A,#0x0
        XRL     A,R7
        MOV     R3,A
        SJMP    ??MT_ProcessEvent_5
//  287   }
//  288 #endif
//  289 
//  290   // Discard or make more handlers
//  291   return 0;
??MT_ProcessEvent_6:
        MOV     R2,#0x0
        MOV     R3,#0x0
??MT_ProcessEvent_5:
        MOV     R7,#0x6
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock2
//  292 
//  293 } /* MT_ProcessEvent() */
//  294 
//  295 #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
//  296 /*********************************************************************
//  297  * @fn      MT_BuildSPIMsg
//  298  *
//  299  * @brief
//  300  *
//  301  *   Format an SPI message.
//  302  *
//  303  * @param   UINT16 cmd - command id
//  304  * @param   byte *msg - pointer to message buffer
//  305  * @param   byte dataLen - length of data field
//  306  * @param   byte *pData - pointer to data field
//  307  *
//  308  * @return  void
//  309  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  310 void MT_BuildSPIMsg( UINT16 cmd, byte *msg, byte dataLen, byte *pData )
MT_BuildSPIMsg:
        CFI Block cfiBlock3 Using cfiCommon0
        CFI Function MT_BuildSPIMsg
//  311 {
        FUNCALL MT_BuildSPIMsg, osal_memcpy
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 21, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 21, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_BuildSPIMsg, SPIMgr_CalcFCS
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 18, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x10
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-11)))
        CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-12)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-13)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-14)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-15)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-16)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 16)
        ; Saved register size: 16
        ; Auto size: 2
        MOV     A,#-0x2
        LCALL   ?ALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 18)
        MOV     ?V0 + 4,R2
        MOV     ?V0 + 5,R3
        MOV     A,R4
        MOV     R6,A
        MOV     A,R5
        MOV     R7,A
        MOV     ?V0 + 3,R1
        MOV     A,#0x12
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        MOV     ?V0 + 6,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     ?V0 + 7,A
//  312   byte *msgPtr;
//  313 
//  314   *msg++ = SOP_VALUE;
        MOV     A,#0x2
        MOV     DPL,R6
        MOV     DPH,R7
        MOVX    @DPTR,A
        MOV     DPL,R6
        MOV     DPH,R7
        INC     DPTR
        MOV     R6,DPL
        MOV     R7,DPH
//  315 
//  316   msgPtr = msg;
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     A,R6
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R7
        MOVX    @DPTR,A
//  317 
//  318   *msg++ = (byte)(HI_UINT16( cmd ));
        MOV     DPL,R6
        MOV     DPH,R7
        MOV     A,?V0 + 5
        MOVX    @DPTR,A
        MOV     DPL,R6
        MOV     DPH,R7
        INC     DPTR
        MOV     R6,DPL
        MOV     R7,DPH
//  319   *msg++ = (byte)(LO_UINT16( cmd ));
        MOV     DPL,R6
        MOV     DPH,R7
        MOV     A,?V0 + 4
        MOVX    @DPTR,A
        MOV     DPL,R6
        MOV     DPH,R7
        INC     DPTR
        MOV     R6,DPL
        MOV     R7,DPH
//  320 
//  321   if ( pData )
        MOV     A,?V0 + 6
        XRL     A,#0x0
        JNZ     ??MT_BuildSPIMsg_0
        MOV     A,?V0 + 7
        XRL     A,#0x0
??MT_BuildSPIMsg_0:
        JZ      ??MT_BuildSPIMsg_1
//  322   {
//  323     *msg++ = dataLen;
        MOV     DPL,R6
        MOV     DPH,R7
        MOV     A,?V0 + 3
        MOVX    @DPTR,A
        MOV     DPL,R6
        MOV     DPH,R7
        INC     DPTR
        MOV     R6,DPL
        MOV     R7,DPH
//  324 
//  325     msg = osal_memcpy( msg, pData, dataLen );
        ; Setup parameters for call to function osal_memcpy
        MOV     ?V0 + 0,?V0 + 6
        MOV     ?V0 + 1,?V0 + 7
        MOV     ?V0 + 2,#0x0
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_THREE
        CFI CFA_XSP16 add(XSP16, 21)
        MOV     A,?V0 + 3
        MOV     ?V0 + 0,A
        MOV     R4,?V0 + 0
        MOV     R5,#0x0
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??osal_memcpy?relay
        MOV     A,#0x3
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 18)
        MOV     ?V0 + 0,R2
        MOV     ?V0 + 1,R3
        MOV     R6,?V0 + 0
        MOV     R7,?V0 + 1
        SJMP    ??MT_BuildSPIMsg_2
//  326   }
//  327   else
//  328     *msg++ = 0;
??MT_BuildSPIMsg_1:
        MOV     A,#0x0
        MOV     DPL,R6
        MOV     DPH,R7
        MOVX    @DPTR,A
        MOV     DPL,R6
        MOV     DPH,R7
        INC     DPTR
        MOV     R6,DPL
        MOV     R7,DPH
//  329 
//  330   *msg = SPIMgr_CalcFCS( msgPtr, (byte)(3 + dataLen) );
??MT_BuildSPIMsg_2:
        ; Setup parameters for call to function SPIMgr_CalcFCS
        MOV     A,#0x3
        ADD     A,?V0 + 3
        MOV     R1,A
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R2,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R3,A
        LCALL   ??SPIMgr_CalcFCS?relay
        MOV     A,R1
        MOV     DPL,R6
        MOV     DPH,R7
        MOVX    @DPTR,A
//  331 }
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 16)
        MOV     R7,#0x8
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock3
//  332 #endif
//  333 
//  334 #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
//  335 /*********************************************************************
//  336  * @fn      MT_BuildAndSendZToolResponse
//  337  *
//  338  * @brief
//  339  *
//  340  *   Build and send a ZTOOL msg
//  341  *
//  342  * @param   byte err
//  343  *
//  344  * @return  void
//  345  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  346 void MT_BuildAndSendZToolResponse( byte msgLen, uint16 cmd,
MT_BuildAndSendZToolResponse:
        CFI Block cfiBlock4 Using cfiCommon0
        CFI Function MT_BuildAndSendZToolResponse
//  347                                    byte dataLen, byte *pData )
//  348 {
        FUNCALL MT_BuildAndSendZToolResponse, osal_mem_alloc
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 16, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 16, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_BuildAndSendZToolResponse, MT_BuildSPIMsg
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 18, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_BuildAndSendZToolResponse, HalUARTWrite
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 16, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 16, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_BuildAndSendZToolResponse, osal_mem_free
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 16, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 16, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x10
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-11)))
        CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-12)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-13)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-14)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-15)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-16)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 16)
        ; Saved register size: 16
        ; Auto size: 0
        MOV     ?V0 + 1,R1
        MOV     ?V0 + 4,R2
        MOV     ?V0 + 5,R3
        MOV     ?V0 + 0,R4
        MOV     A,#0x10
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        MOV     ?V0 + 6,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     ?V0 + 7,A
//  349   byte *msg_ptr;
//  350 
//  351   // Get a message buffer to build response message
//  352   msg_ptr = osal_mem_alloc( msgLen );
        ; Setup parameters for call to function osal_mem_alloc
        MOV     A,?V0 + 1
        MOV     ?V0 + 2,A
        MOV     R2,?V0 + 2
        MOV     R3,#0x0
        LCALL   ??osal_mem_alloc?relay
        MOV     ?V0 + 2,R2
        MOV     ?V0 + 3,R3
        MOV     R6,?V0 + 2
        MOV     R7,?V0 + 3
//  353   if ( msg_ptr )
        MOV     A,R6
        XRL     A,#0x0
        JNZ     ??MT_BuildAndSendZToolResponse_0
        MOV     A,R7
        XRL     A,#0x0
??MT_BuildAndSendZToolResponse_0:
        JZ      ??MT_BuildAndSendZToolResponse_1
//  354   {
//  355 #ifdef SPI_MGR_DEFAULT_PORT
//  356     MT_BuildSPIMsg( cmd, msg_ptr, dataLen, pData );
        ; Setup parameters for call to function MT_BuildSPIMsg
        MOV     ?V0 + 2,?V0 + 6
        MOV     ?V0 + 3,?V0 + 7
        MOV     R0,#?V0 + 2
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 18)
        MOV     R1,?V0 + 0
        MOV     A,R6
        MOV     R4,A
        MOV     A,R7
        MOV     R5,A
        MOV     R2,?V0 + 4
        MOV     R3,?V0 + 5
        LCALL   ??MT_BuildSPIMsg?relay
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 16)
//  357     HalUARTWrite ( SPI_MGR_DEFAULT_PORT, msg_ptr, msgLen );
        ; Setup parameters for call to function HalUARTWrite
        MOV     A,?V0 + 1
        MOV     ?V0 + 2,A
        MOV     R4,?V0 + 2
        MOV     R5,#0x0
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        MOV     R1,#0x0
        LCALL   ??HalUARTWrite?relay
//  358 #endif
//  359     osal_mem_free( msg_ptr );
        ; Setup parameters for call to function osal_mem_free
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??osal_mem_free?relay
//  360   }
//  361 }
??MT_BuildAndSendZToolResponse_1:
        MOV     R7,#0x8
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock4
//  362 #endif
//  363 
//  364 #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
//  365 /*********************************************************************
//  366  * @fn      MT_BuildAndSendZToolCB
//  367  *
//  368  * @brief
//  369  *
//  370  *   Build and send a ZTOOL Callback msg
//  371  *
//  372  * @param   len - length of data portion of the message
//  373  *
//  374  * @return  void
//  375  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  376 void MT_BuildAndSendZToolCB( uint16 callbackID, byte len, byte *pData )
MT_BuildAndSendZToolCB:
        CFI Block cfiBlock5 Using cfiCommon0
        CFI Function MT_BuildAndSendZToolCB
//  377 {
        FUNCALL MT_BuildAndSendZToolCB, osal_msg_allocate
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 19, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 19, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_BuildAndSendZToolCB, osal_memcpy
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_BuildAndSendZToolCB, osal_msg_send
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 19, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 19, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x10
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-11)))
        CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-12)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-13)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-14)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-15)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-16)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 16)
        ; Saved register size: 16
        ; Auto size: 3
        MOV     A,#-0x3
        LCALL   ?ALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 19)
        MOV     A,#0x1
        LCALL   ?XSTACK_DISP0_8
        MOV     A,R4
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R5
        MOVX    @DPTR,A
        MOV     ?V0 + 4,R2
        MOV     ?V0 + 5,R3
        MOV     ?V0 + 3,R1
//  378   byte msgLen;
//  379   mtOSALSerialData_t *msgPtr;
//  380   byte *msg;
//  381 
//  382   msgLen = sizeof ( mtOSALSerialData_t ) + SPI_0DATA_MSG_LEN + len;
        MOV     A,#0x9
        ADD     A,?V0 + 3
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    @DPTR,A
//  383 
//  384   msgPtr = (mtOSALSerialData_t *)osal_msg_allocate( msgLen );
        ; Setup parameters for call to function osal_msg_allocate
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     ?V0 + 0,A
        MOV     R2,?V0 + 0
        MOV     R3,#0x0
        LCALL   ??osal_msg_allocate?relay
        MOV     ?V0 + 0,R2
        MOV     ?V0 + 1,R3
        MOV     ?V0 + 6,?V0 + 0
        MOV     ?V0 + 7,?V0 + 1
//  385   if ( msgPtr )
        MOV     A,?V0 + 6
        XRL     A,#0x0
        JNZ     ??MT_BuildAndSendZToolCB_0
        MOV     A,?V0 + 7
        XRL     A,#0x0
??MT_BuildAndSendZToolCB_0:
        JNZ     $+5
        LJMP    ??MT_BuildAndSendZToolCB_1 & 0xFFFF
//  386   {
//  387     msgPtr->hdr.event = CB_FUNC;
        MOV     A,#0x4
        MOV     DPL,?V0 + 6
        MOV     DPH,?V0 + 7
        MOVX    @DPTR,A
//  388     msgPtr->msg = (uint8 *)(msgPtr+1);
        MOV     A,?V0 + 6
        ADD     A,#0x4
        MOV     R0,A
        MOV     A,?V0 + 7
        ADDC    A,#0x0
        MOV     R1,A
        MOV     DPL,?V0 + 6
        MOV     DPH,?V0 + 7
        INC     DPTR
        INC     DPTR
        MOV     A,R0
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R1
        MOVX    @DPTR,A
//  389     msg = msgPtr->msg;
        MOV     DPL,?V0 + 6
        MOV     DPH,?V0 + 7
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     A,R0
        MOV     R6,A
        MOV     A,R1
        MOV     R7,A
//  390 
//  391     //First byte is used as the event type for MT
//  392     *msg++ = SOP_VALUE;
        MOV     A,#0x2
        MOV     DPL,R6
        MOV     DPH,R7
        MOVX    @DPTR,A
        MOV     DPL,R6
        MOV     DPH,R7
        INC     DPTR
        MOV     R6,DPL
        MOV     R7,DPH
//  393     *msg++ = HI_UINT16( callbackID );
        MOV     DPL,R6
        MOV     DPH,R7
        MOV     A,?V0 + 5
        MOVX    @DPTR,A
        MOV     DPL,R6
        MOV     DPH,R7
        INC     DPTR
        MOV     R6,DPL
        MOV     R7,DPH
//  394     *msg++ = LO_UINT16( callbackID );
        MOV     DPL,R6
        MOV     DPH,R7
        MOV     A,?V0 + 4
        MOVX    @DPTR,A
        MOV     DPL,R6
        MOV     DPH,R7
        INC     DPTR
        MOV     R6,DPL
        MOV     R7,DPH
//  395     *msg++ = len;
        MOV     DPL,R6
        MOV     DPH,R7
        MOV     A,?V0 + 3
        MOVX    @DPTR,A
        MOV     DPL,R6
        MOV     DPH,R7
        INC     DPTR
        MOV     R6,DPL
        MOV     R7,DPH
//  396 
//  397     //Fill up the data bytes
//  398     osal_memcpy( msg, pData, len );
        ; Setup parameters for call to function osal_memcpy
        MOV     A,#0x1
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        MOV     ?V0 + 0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     ?V0 + 1,A
        MOV     ?V0 + 2,#0x0
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_THREE
        CFI CFA_XSP16 add(XSP16, 22)
        MOV     A,?V0 + 3
        MOV     ?V0 + 0,A
        MOV     R4,?V0 + 0
        MOV     R5,#0x0
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??osal_memcpy?relay
        MOV     A,#0x3
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 19)
//  399 
//  400     osal_msg_send( MT_TaskID, (uint8 *)msgPtr );
        ; Setup parameters for call to function osal_msg_send
        MOV     R2,?V0 + 6
        MOV     R3,?V0 + 7
        MOV     DPTR,#MT_TaskID
        MOVX    A,@DPTR
        MOV     R1,A
        LCALL   ??osal_msg_send?relay
//  401   }
//  402 }
??MT_BuildAndSendZToolCB_1:
        MOV     A,#0x3
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 16)
        MOV     R7,#0x8
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock5
//  403 #endif
//  404 
//  405 /*********************************************************************
//  406  * @fn      MT_ProcessCommand
//  407  *
//  408  * @brief
//  409  *
//  410  *   Process Event Messages.
//  411  *
//  412  * @param   byte *msg - pointer to event message
//  413  *
//  414  * @return
//  415  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  416 void MT_ProcessCommand( mtOSALSerialData_t *msg )
MT_ProcessCommand:
        CFI Block cfiBlock6 Using cfiCommon0
        CFI Function MT_ProcessCommand
//  417 {
        FUNCALL MT_ProcessCommand, MT_ProcessSerialCommand
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessCommand, MT_ProcessDebugMsg
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessCommand, MT_ProcessDebugStr
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessCommand, SPIMgr_CalcFCS
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessCommand, HalUARTWrite
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessCommand, MTProcessAppRspMsg
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessCommand, osal_msg_deallocate
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xe
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-11)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-12)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-13)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-14)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 14)
        ; Saved register size: 14
        ; Auto size: 0
        MOV     ?V0 + 2,R2
        MOV     ?V0 + 3,R3
//  418   byte deallocate;
//  419 #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
//  420   byte *msg_ptr;
//  421   byte len;
//  422 
//  423   // A little setup for AF, CB_FUNC and MT_SYS_APP_RSP_MSG
//  424   msg_ptr = msg->msg;
        MOV     DPL,?V0 + 2
        MOV     DPH,?V0 + 3
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     A,R0
        MOV     R6,A
        MOV     A,R1
        MOV     R7,A
//  425 #endif // ZTOOL
//  426 
//  427   deallocate = true;
        MOV     ?V0 + 1,#0x1
//  428 
//  429   // Use the first byte of the message as the command ID
//  430   switch ( msg->hdr.event )
        MOV     DPL,?V0 + 2
        MOV     DPH,?V0 + 3
        MOVX    A,@DPTR
        LCALL   ?UC_SWITCH_SPARSE
`?<Jumptable for MT_ProcessCommand>_0`:
        DATA
        DB        0
        DB        5
        DB        1
        DW        ??MT_ProcessCommand_0
        DB        2
        DW        ??MT_ProcessCommand_1
        DB        4
        DW        ??MT_ProcessCommand_2
        DB        6
        DW        ??MT_ProcessCommand_3
        DB        36
        DW        ??MT_ProcessCommand_4
        DW        ??MT_ProcessCommand_5
        CODE
//  431   {
//  432 #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
//  433     case CMD_SERIAL_MSG:
//  434       MT_ProcessSerialCommand( msg->msg );
??MT_ProcessCommand_0:
        ; Setup parameters for call to function MT_ProcessSerialCommand
        MOV     DPL,?V0 + 2
        MOV     DPH,?V0 + 3
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R2,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R3,A
        LCALL   ??MT_ProcessSerialCommand?relay
        SJMP    ??MT_ProcessCommand_5
//  435       break;
//  436 
//  437     case CMD_DEBUG_MSG:
//  438       MT_ProcessDebugMsg( (mtDebugMsg_t *)msg );
??MT_ProcessCommand_1:
        ; Setup parameters for call to function MT_ProcessDebugMsg
        MOV     R2,?V0 + 2
        MOV     R3,?V0 + 3
        LCALL   ??MT_ProcessDebugMsg?relay
        SJMP    ??MT_ProcessCommand_5
//  439       break;
//  440 
//  441     case CMD_DEBUG_STR:
//  442       MT_ProcessDebugStr( (mtDebugStr_t *)msg );
??MT_ProcessCommand_3:
        ; Setup parameters for call to function MT_ProcessDebugStr
        MOV     R2,?V0 + 2
        MOV     R3,?V0 + 3
        LCALL   ??MT_ProcessDebugStr?relay
        SJMP    ??MT_ProcessCommand_5
//  443       break;
//  444 
//  445     case CB_FUNC:
//  446       /*
//  447         Build SPI message here instead of redundantly calling MT_BuildSPIMsg
//  448         because we have copied data already in the allocated message
//  449       */
//  450 
//  451       /* msg_ptr is the beginning of the intended SPI message */
//  452       len = SPI_0DATA_MSG_LEN + msg_ptr[DATALEN_FIELD];
??MT_ProcessCommand_2:
        MOV     DPL,R6
        MOV     DPH,R7
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        ADD     A,#0x5
        MOV     ?V0 + 0,A
//  453 
//  454       /*
//  455         FCS goes to the last byte in the message and is calculated over all
//  456         the bytes except FCS and SOP
//  457       */
//  458       msg_ptr[len-1] = SPIMgr_CalcFCS( msg_ptr + 1 , (byte)(len-2) );
        ; Setup parameters for call to function SPIMgr_CalcFCS
        MOV     A,#-0x2
        ADD     A,?V0 + 0
        MOV     R1,A
        MOV     DPL,R6
        MOV     DPH,R7
        INC     DPTR
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??SPIMgr_CalcFCS?relay
        MOV     A,R1
        PUSH    A
        CFI CFA_SP SP+-1
        MOV     ?V0 + 4,?V0 + 0
        MOV     ?V0 + 5,#0x0
        MOV     A,R6
        ADD     A,?V0 + 4
        MOV     R0,A
        MOV     A,R7
        ADDC    A,?V0 + 5
        MOV     R1,A
        MOV     A,#-0x1
        ADD     A,R0
        MOV     DPL,A
        MOV     A,#-0x1
        ADDC    A,R1
        MOV     DPH,A
        POP     A
        CFI CFA_SP SP+0
        MOVX    @DPTR,A
//  459 
//  460 #ifdef SPI_MGR_DEFAULT_PORT
//  461       HalUARTWrite ( SPI_MGR_DEFAULT_PORT, msg_ptr, len );
        ; Setup parameters for call to function HalUARTWrite
        MOV     A,?V0 + 0
        MOV     ?V0 + 4,A
        MOV     R4,?V0 + 4
        MOV     R5,#0x0
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        MOV     R1,#0x0
        LCALL   ??HalUARTWrite?relay
        SJMP    ??MT_ProcessCommand_5
//  462 #endif
//  463       break;
//  464 
//  465 #if !defined ( NONWK )
//  466     case MT_SYS_APP_RSP_MSG:
//  467       len = SPI_0DATA_MSG_LEN + msg_ptr[DATALEN_FIELD];
??MT_ProcessCommand_4:
        MOV     DPL,R6
        MOV     DPH,R7
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        ADD     A,#0x5
        MOV     ?V0 + 0,A
//  468       MTProcessAppRspMsg( msg_ptr, len );
        ; Setup parameters for call to function MTProcessAppRspMsg
        MOV     R1,?V0 + 0
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??MTProcessAppRspMsg?relay
//  469       break;
//  470 #endif  // NONWK
//  471 #endif  // ZTOOL
//  472 
//  473     default:
//  474       break;
//  475   }
//  476 
//  477   if ( deallocate )
??MT_ProcessCommand_5:
        MOV     A,?V0 + 1
        JZ      ??MT_ProcessCommand_6
//  478   {
//  479     osal_msg_deallocate( (uint8 *)msg );
        ; Setup parameters for call to function osal_msg_deallocate
        MOV     R2,?V0 + 2
        MOV     R3,?V0 + 3
        LCALL   ??osal_msg_deallocate?relay
//  480   }
//  481 }
??MT_ProcessCommand_6:
        MOV     R7,#0x6
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock6
//  482 
//  483 #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
//  484 /*********************************************************************
//  485  * @fn      MT_ProcessDebugMsg
//  486  *
//  487  * @brief
//  488  *
//  489  *   Build and send a debug message.
//  490  *
//  491  * @param   byte *data - pointer to the data portion of the debug message
//  492  *
//  493  * @return  void
//  494  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  495 void MT_ProcessDebugMsg( mtDebugMsg_t *msg )
MT_ProcessDebugMsg:
        CFI Block cfiBlock7 Using cfiCommon0
        CFI Function MT_ProcessDebugMsg
//  496 {
        FUNCALL MT_ProcessDebugMsg, osal_msg_allocate
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 27, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 27, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessDebugMsg, MT_BuildSPIMsg
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 29, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 29, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessDebugMsg, HalUARTWrite
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 27, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 27, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessDebugMsg, osal_msg_deallocate
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 27, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 27, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x10
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-11)))
        CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-12)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-13)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-14)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-15)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-16)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 16)
        ; Saved register size: 16
        ; Auto size: 11
        MOV     A,#-0xb
        LCALL   ?ALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 27)
        MOV     ?V0 + 0,R2
        MOV     ?V0 + 1,R3
//  497   byte *msg_ptr;
//  498   byte dataLen;
//  499   uint8 buf[11];
//  500   uint8 *pBuf;
//  501 
//  502   // Calculate the data length based
//  503   dataLen = 5 + (msg->numParams * sizeof ( uint16 ));
        MOV     B,#0x2
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MUL     AB
        ADD     A,#0x5
        MOV     ?V0 + 2,A
//  504 
//  505   // Get a message buffer to build the debug message
//  506   msg_ptr = osal_msg_allocate( (byte)(SPI_0DATA_MSG_LEN + dataLen + 1) );
        ; Setup parameters for call to function osal_msg_allocate
        MOV     A,#0x6
        ADD     A,?V0 + 2
        MOV     ?V0 + 3,A
        MOV     R2,?V0 + 3
        MOV     R3,#0x0
        LCALL   ??osal_msg_allocate?relay
        MOV     ?V0 + 4,R2
        MOV     ?V0 + 5,R3
        MOV     ?V0 + 6,?V0 + 4
        MOV     ?V0 + 7,?V0 + 5
//  507   if ( msg_ptr )
        MOV     A,?V0 + 6
        XRL     A,#0x0
        JNZ     ??MT_ProcessDebugMsg_0
        MOV     A,?V0 + 7
        XRL     A,#0x0
??MT_ProcessDebugMsg_0:
        JNZ     $+5
        LJMP    ??MT_ProcessDebugMsg_1 & 0xFFFF
//  508   {
//  509     // Build the message
//  510     pBuf = buf;
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R6,DPL
        MOV     R7,DPH
//  511     *pBuf++ = msg->compID;
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPL,R6
        MOV     DPH,R7
        MOVX    @DPTR,A
        MOV     DPL,R6
        MOV     DPH,R7
        INC     DPTR
        MOV     R6,DPL
        MOV     R7,DPH
//  512     *pBuf++ = msg->severity;
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPL,R6
        MOV     DPH,R7
        MOVX    @DPTR,A
        MOV     DPL,R6
        MOV     DPH,R7
        INC     DPTR
        MOV     R6,DPL
        MOV     R7,DPH
//  513     *pBuf++ = msg->numParams;
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPL,R6
        MOV     DPH,R7
        MOVX    @DPTR,A
        MOV     DPL,R6
        MOV     DPH,R7
        INC     DPTR
        MOV     R6,DPL
        MOV     R7,DPH
//  514 
//  515     if ( msg->numParams >= 1 )
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        CLR     C
        SUBB    A,#0x1
        JC      ??MT_ProcessDebugMsg_2
//  516     {
//  517       *pBuf++ = HI_UINT16( msg->param1 );
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     A,R1
        MOV     DPL,R6
        MOV     DPH,R7
        MOVX    @DPTR,A
        MOV     DPL,R6
        MOV     DPH,R7
        INC     DPTR
        MOV     R6,DPL
        MOV     R7,DPH
//  518       *pBuf++ = LO_UINT16( msg->param1 );
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPL,R6
        MOV     DPH,R7
        MOVX    @DPTR,A
        MOV     DPL,R6
        MOV     DPH,R7
        INC     DPTR
        MOV     R6,DPL
        MOV     R7,DPH
//  519     }
//  520 
//  521     if ( msg->numParams >= 2 )
??MT_ProcessDebugMsg_2:
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        CLR     C
        SUBB    A,#0x2
        JC      ??MT_ProcessDebugMsg_3
//  522     {
//  523       *pBuf++ = HI_UINT16( msg->param2 );
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     A,R1
        MOV     DPL,R6
        MOV     DPH,R7
        MOVX    @DPTR,A
        MOV     DPL,R6
        MOV     DPH,R7
        INC     DPTR
        MOV     R6,DPL
        MOV     R7,DPH
//  524       *pBuf++ = LO_UINT16( msg->param2 );
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPL,R6
        MOV     DPH,R7
        MOVX    @DPTR,A
        MOV     DPL,R6
        MOV     DPH,R7
        INC     DPTR
        MOV     R6,DPL
        MOV     R7,DPH
//  525     }
//  526 
//  527     if ( msg->numParams == 3 )
??MT_ProcessDebugMsg_3:
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        XRL     A,#0x3
        JNZ     ??MT_ProcessDebugMsg_4
//  528     {
//  529       *pBuf++ = HI_UINT16( msg->param3 );
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     A,R1
        MOV     DPL,R6
        MOV     DPH,R7
        MOVX    @DPTR,A
        MOV     DPL,R6
        MOV     DPH,R7
        INC     DPTR
        MOV     R6,DPL
        MOV     R7,DPH
//  530       *pBuf++ = LO_UINT16( msg->param3 );
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPL,R6
        MOV     DPH,R7
        MOVX    @DPTR,A
        MOV     DPL,R6
        MOV     DPH,R7
        INC     DPTR
        MOV     R6,DPL
        MOV     R7,DPH
//  531     }
//  532 
//  533     *pBuf++ = HI_UINT16( msg->timestamp );
??MT_ProcessDebugMsg_4:
        MOV     A,?V0 + 0
        ADD     A,#0xb
        MOV     DPL,A
        MOV     A,?V0 + 1
        ADDC    A,#0x0
        MOV     DPH,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     A,R1
        MOV     DPL,R6
        MOV     DPH,R7
        MOVX    @DPTR,A
        MOV     DPL,R6
        MOV     DPH,R7
        INC     DPTR
        MOV     R6,DPL
        MOV     R7,DPH
//  534     *pBuf++ = LO_UINT16( msg->timestamp );
        MOV     A,?V0 + 0
        ADD     A,#0xb
        MOV     DPL,A
        MOV     A,?V0 + 1
        ADDC    A,#0x0
        MOV     DPH,A
        MOVX    A,@DPTR
        MOV     DPL,R6
        MOV     DPH,R7
        MOVX    @DPTR,A
//  535 
//  536 #ifdef SPI_MGR_DEFAULT_PORT
//  537     MT_BuildSPIMsg( SPI_CMD_DEBUG_MSG, &msg_ptr[1], dataLen, buf );
        ; Setup parameters for call to function MT_BuildSPIMsg
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     ?V0 + 4,DPL
        MOV     ?V0 + 5,DPH
        MOV     R0,#?V0 + 4
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 29)
        MOV     R1,?V0 + 2
        MOV     DPL,?V0 + 6
        MOV     DPH,?V0 + 7
        INC     DPTR
        MOV     R4,DPL
        MOV     R5,DPH
        MOV     R2,#0x3
        MOV     R3,#0x40
        LCALL   ??MT_BuildSPIMsg?relay
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 27)
//  538     HalUARTWrite ( SPI_MGR_DEFAULT_PORT, &msg_ptr[1], SPI_0DATA_MSG_LEN + dataLen );
        ; Setup parameters for call to function HalUARTWrite
        MOV     ?V0 + 4,?V0 + 2
        MOV     ?V0 + 5,#0x0
        MOV     A,#0x5
        ADD     A,?V0 + 4
        MOV     R4,A
        MOV     A,#0x0
        ADDC    A,?V0 + 5
        MOV     R5,A
        MOV     DPL,?V0 + 6
        MOV     DPH,?V0 + 7
        INC     DPTR
        MOV     R2,DPL
        MOV     R3,DPH
        MOV     R1,#0x0
        LCALL   ??HalUARTWrite?relay
//  539 #endif
//  540     osal_msg_deallocate( msg_ptr );
        ; Setup parameters for call to function osal_msg_deallocate
        MOV     R2,?V0 + 6
        MOV     R3,?V0 + 7
        LCALL   ??osal_msg_deallocate?relay
//  541   }
//  542 }
??MT_ProcessDebugMsg_1:
        MOV     A,#0xb
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 16)
        MOV     R7,#0x8
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock7
//  543 #endif // ZTOOL
//  544 
//  545 #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
//  546 /*********************************************************************
//  547  * @fn      MT_ProcessDebugStr
//  548  *
//  549  * @brief
//  550  *
//  551  *   Build and send a debug string.
//  552  *
//  553  * @param   byte *dstr - pointer to the data portion of the debug message
//  554  *
//  555  * @return  void
//  556  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  557 void MT_ProcessDebugStr( mtDebugStr_t *dstr )
MT_ProcessDebugStr:
        CFI Block cfiBlock8 Using cfiCommon0
        CFI Function MT_ProcessDebugStr
//  558 {
        FUNCALL MT_ProcessDebugStr, osal_mem_alloc
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 12, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 12, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessDebugStr, MT_BuildSPIMsg
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessDebugStr, HalUARTWrite
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 12, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 12, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessDebugStr, osal_mem_free
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 12, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 12, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xc
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 12)
        ; Saved register size: 12
        ; Auto size: 0
        MOV     ?V0 + 0,R2
        MOV     ?V0 + 1,R3
//  559   byte *msg_ptr;
//  560 
//  561   // Get a message buffer to build the debug message
//  562   msg_ptr = osal_mem_alloc( (byte)(SPI_0DATA_MSG_LEN + dstr->sln) );
        ; Setup parameters for call to function osal_mem_alloc
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        ADD     A,#0x5
        MOV     ?V0 + 2,A
        MOV     R2,?V0 + 2
        MOV     R3,#0x0
        LCALL   ??osal_mem_alloc?relay
        MOV     ?V0 + 2,R2
        MOV     ?V0 + 3,R3
        MOV     R6,?V0 + 2
        MOV     R7,?V0 + 3
//  563   if ( msg_ptr )
        MOV     A,R6
        XRL     A,#0x0
        JNZ     ??MT_ProcessDebugStr_0
        MOV     A,R7
        XRL     A,#0x0
??MT_ProcessDebugStr_0:
        JZ      ??MT_ProcessDebugStr_1
//  564   {
//  565 #ifdef SPI_MGR_DEFAULT_PORT
//  566     MT_BuildSPIMsg( SPI_RESPONSE_BIT | SPI_SYS_STRING_MSG, msg_ptr, dstr->sln, dstr->pString );
        ; Setup parameters for call to function MT_BuildSPIMsg
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        INC     DPTR
        INC     DPTR
        LCALL   ?PUSH_XSTACK8_X_TWO
        CFI CFA_XSP16 add(XSP16, 14)
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     A,R6
        MOV     R4,A
        MOV     A,R7
        MOV     R5,A
        MOV     R2,#0x15
        MOV     R3,#0x10
        LCALL   ??MT_BuildSPIMsg?relay
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 12)
//  567     HalUARTWrite ( SPI_MGR_DEFAULT_PORT, msg_ptr, SPI_0DATA_MSG_LEN + dstr->sln );
        ; Setup parameters for call to function HalUARTWrite
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R0,A
        MOV     R1,#0x0
        MOV     A,#0x5
        ADD     A,R0
        MOV     R4,A
        MOV     A,#0x0
        ADDC    A,R1
        MOV     R5,A
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        MOV     R1,#0x0
        LCALL   ??HalUARTWrite?relay
//  568 #endif
//  569     osal_mem_free( msg_ptr );
        ; Setup parameters for call to function osal_mem_free
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??osal_mem_free?relay
//  570   }
//  571 }
??MT_ProcessDebugStr_1:
        MOV     R7,#0x4
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock8
//  572 #endif // ZTOOL
//  573 
//  574 #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
//  575 /*********************************************************************
//  576  * @fn      MT_ProcessSetNV
//  577  *
//  578  * @brief
//  579  *
//  580  *   The Set NV serial message.
//  581  *
//  582  * @param   byte *msg - pointer to the data
//  583  *
//  584  * @return  ZSuccess if successful
//  585  *
//  586  * @MT SPI_CMD_SYS_SET_NV
//  587  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  588 byte MT_ProcessSetNV( byte *pData )
MT_ProcessSetNV:
        CFI Block cfiBlock9 Using cfiCommon0
        CFI Function MT_ProcessSetNV
//  589 {
        FUNCALL MT_ProcessSetNV, osal_nv_item_len
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessSetNV, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 18, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xe
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-11)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-12)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-13)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-14)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 14)
        ; Saved register size: 14
        ; Auto size: 0
        MOV     ?V0 + 0,R2
        MOV     ?V0 + 1,R3
//  590   uint16  attrib;
//  591   uint16  attlen;
//  592 
//  593   attrib = (uint16) *pData;
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        MOVX    A,@DPTR
        MOV     R1,#0x0
        MOV     R6,A
        MOV     A,R1
        MOV     R7,A
//  594   pData += 2;   // skip additional byte containing len field
        MOV     A,?V0 + 0
        ADD     A,#0x2
        MOV     ?V0 + 0,A
        MOV     A,?V0 + 1
        ADDC    A,#0x0
        MOV     ?V0 + 1,A
//  595   attlen = osal_nv_item_len( attrib );
        ; Setup parameters for call to function osal_nv_item_len
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??osal_nv_item_len?relay
        MOV     ?V0 + 4,R2
        MOV     ?V0 + 5,R3
        MOV     ?V0 + 2,?V0 + 4
        MOV     ?V0 + 3,?V0 + 5
//  596 
//  597   return osal_nv_write( attrib, 0, attlen, pData );
        ; Setup parameters for call to function osal_nv_write
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 16)
        MOV     R0,#?V0 + 2
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 18)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??osal_nv_write?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 14)
        MOV     R7,#0x6
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock9
//  598 }
//  599 #endif
//  600 
//  601 #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
//  602 /*********************************************************************
//  603  * @fn      MT_ProcessGetNV
//  604  *
//  605  * @brief
//  606  *
//  607  *   The Get NV serial message.
//  608  *
//  609  * @param   byte *msg - pointer to the data
//  610  *
//  611  * @return  void
//  612  *
//  613  * @MT SPI_CMD_SYS_GET_NV
//  614  *
//  615  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  616 void MT_ProcessGetNV( byte *pData )
MT_ProcessGetNV:
        CFI Block cfiBlock10 Using cfiCommon0
        CFI Function MT_ProcessGetNV
//  617 {
        FUNCALL MT_ProcessGetNV, osal_nv_item_len
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 18, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessGetNV, osal_mem_alloc
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 18, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessGetNV, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 18, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessGetNV, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 22, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 22, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessGetNV, MT_BuildAndSendZToolResponse
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 20, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 20, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessGetNV, osal_mem_free
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 18, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x10
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-11)))
        CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-12)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-13)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-14)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-15)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-16)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 16)
        ; Saved register size: 16
        ; Auto size: 2
        MOV     A,#-0x2
        LCALL   ?ALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 18)
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     A,R2
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R3
        MOVX    @DPTR,A
//  618   uint16  attrib;
//  619   uint16 attlen;
//  620   uint16 buflen;
//  621   uint8 *buf;
//  622 
//  623   attrib = (uint16)*pData;
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        MOVX    A,@DPTR
        MOV     R0,A
        MOV     R1,#0x0
        MOV     ?V0 + 2,R0
        MOV     ?V0 + 3,R1
//  624   attlen = osal_nv_item_len( attrib );
        ; Setup parameters for call to function osal_nv_item_len
        MOV     R2,?V0 + 2
        MOV     R3,?V0 + 3
        LCALL   ??osal_nv_item_len?relay
        MOV     ?V0 + 4,R2
        MOV     ?V0 + 5,R3
        MOV     ?V0 + 0,?V0 + 4
        MOV     ?V0 + 1,?V0 + 5
//  625 
//  626   buflen = attlen + 3;
        MOV     A,#0x3
        ADD     A,?V0 + 0
        MOV     R0,A
        MOV     A,#0x0
        ADDC    A,?V0 + 1
        MOV     R1,A
        MOV     A,R0
        MOV     R6,A
        MOV     A,R1
        MOV     R7,A
//  627   buf = osal_mem_alloc( buflen );
        ; Setup parameters for call to function osal_mem_alloc
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??osal_mem_alloc?relay
        MOV     ?V0 + 4,R2
        MOV     ?V0 + 5,R3
        MOV     ?V0 + 6,?V0 + 4
        MOV     ?V0 + 7,?V0 + 5
//  628   if ( buf != NULL )
        MOV     A,?V0 + 6
        XRL     A,#0x0
        JNZ     ??MT_ProcessGetNV_0
        MOV     A,?V0 + 7
        XRL     A,#0x0
??MT_ProcessGetNV_0:
        JZ      ??MT_ProcessGetNV_1
//  629   {
//  630     osal_memset( buf, 0, buflen );
        ; Setup parameters for call to function osal_memset
        MOV     A,R6
        MOV     R4,A
        MOV     A,R7
        MOV     R5,A
        MOV     R1,#0x0
        MOV     R2,?V0 + 6
        MOV     R3,?V0 + 7
        LCALL   ??osal_memset?relay
//  631 
//  632     buf[0] = osal_nv_read( attrib, 0, attlen, &buf[3] );
        ; Setup parameters for call to function osal_nv_read
        MOV     A,?V0 + 6
        ADD     A,#0x3
        MOV     ?V0 + 4,A
        MOV     A,?V0 + 7
        ADDC    A,#0x0
        MOV     ?V0 + 5,A
        MOV     R0,#?V0 + 4
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 20)
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 22)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     R2,?V0 + 2
        MOV     R3,?V0 + 3
        LCALL   ??osal_nv_read?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 18)
        MOV     A,R1
        MOV     DPL,?V0 + 6
        MOV     DPH,?V0 + 7
        MOVX    @DPTR,A
//  633     buf[1] = (uint8)attrib;
        MOV     DPL,?V0 + 6
        MOV     DPH,?V0 + 7
        INC     DPTR
        MOV     A,?V0 + 2
        MOVX    @DPTR,A
//  634     buf[2] = attlen;
        MOV     DPL,?V0 + 6
        MOV     DPH,?V0 + 7
        INC     DPTR
        INC     DPTR
        MOV     A,?V0 + 0
        MOVX    @DPTR,A
//  635 
//  636     MT_BuildAndSendZToolResponse( (SPI_0DATA_MSG_LEN + buflen),
//  637                                   (SPI_RESPONSE_BIT | SPI_CMD_SYS_GET_NV),
//  638                                   buflen, buf );
        ; Setup parameters for call to function MT_BuildAndSendZToolResponse
        MOV     R0,#?V0 + 6
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 20)
        MOV     A,R6
        MOV     R4,A
        MOV     R2,#0x13
        MOV     R3,#0x10
        MOV     A,R6
        ADD     A,#0x5
        MOV     R1,A
        LCALL   ??MT_BuildAndSendZToolResponse?relay
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 18)
//  639     osal_mem_free( buf );
        ; Setup parameters for call to function osal_mem_free
        MOV     R2,?V0 + 6
        MOV     R3,?V0 + 7
        LCALL   ??osal_mem_free?relay
//  640   }
//  641 }
??MT_ProcessGetNV_1:
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 16)
        MOV     R7,#0x8
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock10
//  642 #endif
//  643 
//  644 #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
//  645 #if !defined ( NONWK )
//  646 /***************************************************************************************************
//  647  * @fn      MT_ProcessGetNvInfo
//  648  *
//  649  * @brief
//  650  *
//  651  *   The Get NV Info serial message.
//  652  *
//  653  * @param   byte *msg - pointer to the data
//  654  *
//  655  * @return  void
//  656  *
//  657  * @MT SPI_CMD_SYS_GET_NV_INFO
//  658  *
//  659  ***************************************************************************************************/

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  660 void MT_ProcessGetNvInfo( void )
MT_ProcessGetNvInfo:
        CFI Block cfiBlock11 Using cfiCommon0
        CFI Function MT_ProcessGetNvInfo
//  661 {
        FUNCALL MT_ProcessGetNvInfo, osal_mem_alloc
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 24, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 24, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessGetNvInfo, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 24, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 24, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessGetNvInfo, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 28, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 28, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessGetNvInfo, MT_ReverseBytes
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 24, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 24, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessGetNvInfo, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 28, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 28, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessGetNvInfo, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 28, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 28, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessGetNvInfo, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 28, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 28, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessGetNvInfo, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 28, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 28, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessGetNvInfo, MT_BuildAndSendZToolResponse
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 26, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 26, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessGetNvInfo, osal_mem_free
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 24, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 24, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x10
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-11)))
        CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-12)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-13)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-14)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-15)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-16)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 16)
        ; Saved register size: 16
        ; Auto size: 8
        MOV     A,#-0x8
        LCALL   ?ALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 24)
//  662   uint8 len;
//  663   uint8 stat;
//  664   uint8 *buf;
//  665   uint8 *pBuf;
//  666   uint16 tmp16;
//  667   uint32 tmp32;
//  668 
//  669   // Get required length of buffer
//  670   // Status + ExtAddr + ChanList + PanID  + SecLevel + PreCfgKey
//  671   len = 1 + Z_EXTADDR_LEN + 4 + 2 + 1 + SEC_KEY_LEN;
        MOV     R7,#0x20
//  672 
//  673   buf = osal_mem_alloc( len );
        ; Setup parameters for call to function osal_mem_alloc
        MOV     A,R7
        MOV     ?V0 + 2,A
        MOV     R2,?V0 + 2
        MOV     R3,#0x0
        LCALL   ??osal_mem_alloc?relay
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     A,R2
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R3
        MOVX    @DPTR,A
//  674   if ( buf )
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        XRL     A,#0x0
        JNZ     ??MT_ProcessGetNvInfo_0
        INC     DPTR
        MOVX    A,@DPTR
        XRL     A,#0x0
??MT_ProcessGetNvInfo_0:
        JNZ     $+5
        LJMP    ??MT_ProcessGetNvInfo_1 & 0xFFFF
//  675   {
//  676     // Assume NV not available
//  677     osal_memset( buf, 0xFF, len );
        ; Setup parameters for call to function osal_memset
        MOV     A,R7
        MOV     ?V0 + 2,A
        MOV     R4,?V0 + 2
        MOV     R5,#0x0
        MOV     R1,#-0x1
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R2,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R3,A
        LCALL   ??osal_memset?relay
//  678 
//  679     // Skip over status
//  680     pBuf = buf + 1;
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        ADD     A,#0x1
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        ADDC    A,#0x0
        MOV     R1,A
        MOV     ?V0 + 0,R0
        MOV     ?V0 + 1,R1
//  681 
//  682     // Start with 64-bit extended address
//  683     stat = osal_nv_read( ZCD_NV_EXTADDR, 0, Z_EXTADDR_LEN, pBuf );
        ; Setup parameters for call to function osal_nv_read
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 26)
        MOV     ?V0 + 2,#0x8
        MOV     ?V0 + 3,#0x0
        MOV     R0,#?V0 + 2
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 28)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     R2,#0x1
        MOV     R3,#0x0
        LCALL   ??osal_nv_read?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 24)
        MOV     A,R1
        MOV     R6,A
//  684     if ( stat ) stat = 0x01;
        MOV     A,R6
        JZ      ??MT_ProcessGetNvInfo_2
        MOV     R6,#0x1
//  685     MT_ReverseBytes( pBuf, Z_EXTADDR_LEN );
??MT_ProcessGetNvInfo_2:
        ; Setup parameters for call to function MT_ReverseBytes
        MOV     R1,#0x8
        MOV     R2,?V0 + 0
        MOV     R3,?V0 + 1
        LCALL   ??MT_ReverseBytes?relay
//  686     pBuf += Z_EXTADDR_LEN;
        MOV     A,?V0 + 0
        ADD     A,#0x8
        MOV     ?V0 + 0,A
        MOV     A,?V0 + 1
        ADDC    A,#0x0
        MOV     ?V0 + 1,A
//  687 
//  688     // Scan channel list (bit mask)
//  689     if (  osal_nv_read( ZCD_NV_CHANLIST, 0, sizeof( tmp32 ), &tmp32 ) )
        ; Setup parameters for call to function osal_nv_read
        MOV     A,#0x4
        LCALL   ?XSTACK_DISP0_8
        MOV     ?V0 + 2,DPL
        MOV     ?V0 + 3,DPH
        MOV     R0,#?V0 + 2
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 26)
        MOV     ?V0 + 2,#0x4
        MOV     ?V0 + 3,#0x0
        MOV     R0,#?V0 + 2
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 28)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     R2,#-0x7c
        MOV     R3,#0x0
        LCALL   ??osal_nv_read?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 24)
        MOV     A,R1
        JZ      ??MT_ProcessGetNvInfo_3
//  690       stat |= 0x02;
        SETB    C
        MOV     A,R6
        MOV     0xE0 /* A   */.1,C
        MOV     R6,A
        SJMP    ??MT_ProcessGetNvInfo_4
//  691     else
//  692     {
//  693       pBuf[0] = BREAK_UINT32( tmp32, 3 );
??MT_ProcessGetNvInfo_3:
        MOV     A,#0x4
        LCALL   ?XSTACK_DISP0_8
        MOV     R0,#?V0 + 4
        LCALL   ?L_MOV_X
        MOV     A,#0x18
        MOV     R0,#?V0 + 4
        LCALL   ?UL_SHR
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        MOV     A,?V0 + 4
        MOVX    @DPTR,A
//  694       pBuf[1] = BREAK_UINT32( tmp32, 2 );
        MOV     A,#0x4
        LCALL   ?XSTACK_DISP0_8
        MOV     R0,#?V0 + 4
        LCALL   ?L_MOV_X
        MOV     A,#0x10
        MOV     R0,#?V0 + 4
        LCALL   ?UL_SHR
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        MOV     A,?V0 + 4
        MOVX    @DPTR,A
//  695       pBuf[2] = BREAK_UINT32( tmp32, 1 );
        MOV     A,#0x4
        LCALL   ?XSTACK_DISP0_8
        MOV     R0,#?V0 + 4
        LCALL   ?L_MOV_X
        MOV     A,?V0 + 5
        MOV     ?V0 + 4,A
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        INC     DPTR
        MOV     A,?V0 + 4
        MOVX    @DPTR,A
//  696       pBuf[3] = BREAK_UINT32( tmp32, 0 );
        MOV     A,#0x4
        LCALL   ?XSTACK_DISP0_8
        MOV     R0,#?V0 + 4
        LCALL   ?L_MOV_X
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOV     A,?V0 + 4
        MOVX    @DPTR,A
//  697     }
//  698     pBuf += sizeof( tmp32 );
??MT_ProcessGetNvInfo_4:
        MOV     A,?V0 + 0
        ADD     A,#0x4
        MOV     ?V0 + 0,A
        MOV     A,?V0 + 1
        ADDC    A,#0x0
        MOV     ?V0 + 1,A
//  699 
//  700     // ZigBee PanID
//  701     if ( osal_nv_read( ZCD_NV_PANID, 0, sizeof( tmp16 ), &tmp16 ) )
        ; Setup parameters for call to function osal_nv_read
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     ?V0 + 2,DPL
        MOV     ?V0 + 3,DPH
        MOV     R0,#?V0 + 2
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 26)
        MOV     ?V0 + 2,#0x2
        MOV     ?V0 + 3,#0x0
        MOV     R0,#?V0 + 2
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 28)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     R2,#-0x7d
        MOV     R3,#0x0
        LCALL   ??osal_nv_read?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 24)
        MOV     A,R1
        JZ      ??MT_ProcessGetNvInfo_5
//  702       stat |= 0x04;
        SETB    C
        MOV     A,R6
        MOV     0xE0 /* A   */.2,C
        MOV     R6,A
        SJMP    ??MT_ProcessGetNvInfo_6
//  703     else
//  704     {
//  705       pBuf[0] = HI_UINT16( tmp16 );
??MT_ProcessGetNvInfo_5:
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     A,R1
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        MOVX    @DPTR,A
//  706       pBuf[1] = LO_UINT16( tmp16 );
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        MOVX    @DPTR,A
//  707     }
//  708     pBuf += sizeof( tmp16 );
??MT_ProcessGetNvInfo_6:
        MOV     A,?V0 + 0
        ADD     A,#0x2
        MOV     ?V0 + 0,A
        MOV     A,?V0 + 1
        ADDC    A,#0x0
        MOV     ?V0 + 1,A
//  709 
//  710     // Security level
//  711     if ( osal_nv_read( ZCD_NV_SECURITY_LEVEL, 0, sizeof( uint8 ), pBuf++ ) )
        MOV     ?V0 + 2,?V0 + 0
        MOV     ?V0 + 3,?V0 + 1
        MOV     DPL,?V0 + 2
        MOV     DPH,?V0 + 3
        INC     DPTR
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
        ; Setup parameters for call to function osal_nv_read
        MOV     R0,#?V0 + 2
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 26)
        MOV     ?V0 + 2,#0x1
        MOV     ?V0 + 3,#0x0
        MOV     R0,#?V0 + 2
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 28)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     R2,#0x61
        MOV     R3,#0x0
        LCALL   ??osal_nv_read?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 24)
        MOV     A,R1
        JZ      ??MT_ProcessGetNvInfo_7
//  712       stat |= 0x08;
        SETB    C
        MOV     A,R6
        MOV     0xE0 /* A   */.3,C
        MOV     R6,A
//  713 
//  714     // Pre-configured security key
//  715     if ( osal_nv_read( ZCD_NV_PRECFGKEY, 0, SEC_KEY_LEN, pBuf ) )
??MT_ProcessGetNvInfo_7:
        ; Setup parameters for call to function osal_nv_read
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 26)
        MOV     ?V0 + 2,#0x10
        MOV     ?V0 + 3,#0x0
        MOV     R0,#?V0 + 2
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 28)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     R2,#0x62
        MOV     R3,#0x0
        LCALL   ??osal_nv_read?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 24)
        MOV     A,R1
        JZ      ??MT_ProcessGetNvInfo_8
//  716       stat |= 0x10;
        SETB    C
        MOV     A,R6
        MOV     0xE0 /* A   */.4,C
        MOV     R6,A
//  717 
//  718     // Status bit mask - bit=1 indicates failure
//  719     *buf = stat;
??MT_ProcessGetNvInfo_8:
        MOV     A,R6
        PUSH    A
        CFI CFA_SP SP+-1
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        POP     A
        CFI CFA_SP SP+0
        MOVX    @DPTR,A
//  720 
//  721     MT_BuildAndSendZToolResponse( (SPI_0DATA_MSG_LEN + len),
//  722                                   (SPI_RESPONSE_BIT | SPI_CMD_SYS_GET_NV_INFO),
//  723                                   len, buf );
        ; Setup parameters for call to function MT_BuildAndSendZToolResponse
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        LCALL   ?PUSH_XSTACK8_X_TWO
        CFI CFA_XSP16 add(XSP16, 26)
        MOV     A,R7
        MOV     R4,A
        MOV     R2,#0x1f
        MOV     R3,#0x10
        MOV     A,#0x5
        ADD     A,R7
        MOV     R1,A
        LCALL   ??MT_BuildAndSendZToolResponse?relay
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 24)
//  724 
//  725     osal_mem_free( buf );
        ; Setup parameters for call to function osal_mem_free
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R2,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R3,A
        LCALL   ??osal_mem_free?relay
//  726   }
//  727 }
??MT_ProcessGetNvInfo_1:
        MOV     A,#0x8
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 16)
        MOV     R7,#0x8
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock11
//  728 #endif  // NONWK
//  729 #endif  // ZTOOL
//  730 
//  731 #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
//  732 #define DEVICE_INFO_RESPONSE_LEN 46
//  733 #define TYPE_COORDINATOR         1
//  734 #define TYPE_ROUTER              2
//  735 #define TYPE_ENDDEVICE           4
//  736 /***************************************************************************************************
//  737  * @fn      MT_ProcessGetDeviceInfo
//  738  *
//  739  * @brief
//  740  *
//  741  *   The Get Device Info serial message.
//  742  *
//  743  * @param   byte *msg - pointer to the data
//  744  *
//  745  * @return  void
//  746  ***************************************************************************************************/

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  747 void MT_ProcessGetDeviceInfo( void )
MT_ProcessGetDeviceInfo:
        CFI Block cfiBlock12 Using cfiCommon0
        CFI Function MT_ProcessGetDeviceInfo
//  748 {
        FUNCALL MT_ProcessGetDeviceInfo, osal_mem_alloc
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 21, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 21, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessGetDeviceInfo, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 25, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 25, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessGetDeviceInfo, MT_ReverseBytes
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 21, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 21, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessGetDeviceInfo, NLME_GetShortAddr
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 21, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 21, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessGetDeviceInfo, osal_memset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 21, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 21, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessGetDeviceInfo, osal_mem_free
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 21, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 21, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessGetDeviceInfo, MT_BuildAndSendZToolResponse
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 23, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 23, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessGetDeviceInfo, osal_mem_free
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 21, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 21, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x10
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-11)))
        CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-12)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-13)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-14)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-15)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-16)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 16)
        ; Saved register size: 16
        ; Auto size: 5
        MOV     A,#-0x5
        LCALL   ?ALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 21)
//  749   byte *buf;
//  750   byte *pBuf;
//  751   uint8 deviceType = 0;
        MOV     A,#0x0
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    @DPTR,A
//  752   uint16 shortAddr;
//  753   uint16 *assocList;
//  754   byte assocCnt;
//  755   uint16 *puint16;
//  756   byte x;
//  757 
//  758   buf = osal_mem_alloc( DEVICE_INFO_RESPONSE_LEN );
        ; Setup parameters for call to function osal_mem_alloc
        MOV     R2,#0x2e
        MOV     R3,#0x0
        LCALL   ??osal_mem_alloc?relay
        MOV     A,#0x1
        LCALL   ?XSTACK_DISP0_8
        MOV     A,R2
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R3
        MOVX    @DPTR,A
//  759   if ( buf )
        MOV     A,#0x1
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        XRL     A,#0x0
        JNZ     ??MT_ProcessGetDeviceInfo_0
        INC     DPTR
        MOVX    A,@DPTR
        XRL     A,#0x0
??MT_ProcessGetDeviceInfo_0:
        JNZ     $+5
        LJMP    ??MT_ProcessGetDeviceInfo_1 & 0xFFFF
//  760   {
//  761     pBuf = buf;
        MOV     A,#0x1
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     ?V0 + 0,R0
        MOV     ?V0 + 1,R1
//  762 
//  763     *pBuf++ = ZSUCCESS;
        MOV     A,#0x0
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        MOVX    @DPTR,A
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
//  764 
//  765     osal_nv_read( ZCD_NV_EXTADDR, 0, Z_EXTADDR_LEN, pBuf );
        ; Setup parameters for call to function osal_nv_read
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 23)
        MOV     ?V0 + 4,#0x8
        MOV     ?V0 + 5,#0x0
        MOV     R0,#?V0 + 4
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 25)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     R2,#0x1
        MOV     R3,#0x0
        LCALL   ??osal_nv_read?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 21)
//  766     // Outgoing extended address needs to be reversed
//  767     MT_ReverseBytes( pBuf, Z_EXTADDR_LEN );
        ; Setup parameters for call to function MT_ReverseBytes
        MOV     R1,#0x8
        MOV     R2,?V0 + 0
        MOV     R3,?V0 + 1
        LCALL   ??MT_ReverseBytes?relay
//  768     pBuf += Z_EXTADDR_LEN;
        MOV     A,?V0 + 0
        ADD     A,#0x8
        MOV     ?V0 + 0,A
        MOV     A,?V0 + 1
        ADDC    A,#0x0
        MOV     ?V0 + 1,A
//  769 
//  770 #if !defined( NONWK )
//  771     shortAddr = NLME_GetShortAddr();
        ; Setup parameters for call to function NLME_GetShortAddr
        LCALL   ??NLME_GetShortAddr?relay
        MOV     ?V0 + 4,R2
        MOV     ?V0 + 5,R3
        MOV     R6,?V0 + 4
//  772 #else
//  773     shortAddr = 0;
//  774 #endif
//  775 
//  776     *pBuf++ = HI_UINT16( shortAddr );
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        MOV     A,?V0 + 5
        MOVX    @DPTR,A
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
//  777     *pBuf++ = LO_UINT16( shortAddr );
        MOV     A,R6
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        MOVX    @DPTR,A
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
//  778 
//  779     // Return device type
//  780 #if !defined( NONWK )
//  781 #if defined (ZDO_COORDINATOR)
//  782     deviceType |= (uint8) TYPE_COORDINATOR;
//  783   #if defined (SOFT_START)
//  784     deviceType |= (uint8) TYPE_ROUTER;
//  785   #endif
//  786 #endif
//  787 #if defined (RTR_NWK) && !defined (ZDO_COORDINATOR)
//  788     deviceType |= (uint8) TYPE_ROUTER;
//  789 #elif !defined (RTR_NWK)
//  790     deviceType |= (uint8) TYPE_ENDDEVICE;
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        SETB    0xE0 /* A   */.2
        MOVX    @DPTR,A
//  791 #endif
//  792 #endif
//  793     *pBuf++ = (byte) deviceType;
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        MOVX    @DPTR,A
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
//  794 
//  795     //Return device state
//  796 #if !defined( NONWK )
//  797     *pBuf++ = (byte)devState;
        MOV     DPTR,#devState
        MOVX    A,@DPTR
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        MOVX    @DPTR,A
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
//  798 #else
//  799     *pBuf++ = (byte)0;
//  800 #endif
//  801 
//  802 #if defined(RTR_NWK) && !defined( NONWK )
//  803     assocList = AssocMakeList( &assocCnt );
//  804 #else
//  805     assocCnt = 0;
        MOV     ?V0 + 3,#0x0
//  806     assocList = NULL;
        MOV     A,#0x3
        LCALL   ?XSTACK_DISP0_8
        MOV     A,#0x0
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,#0x0
        MOVX    @DPTR,A
//  807 #endif
//  808 
//  809     *pBuf++ = assocCnt;
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        MOV     A,?V0 + 3
        MOVX    @DPTR,A
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
//  810 
//  811     // upto 16 devices
//  812     osal_memset( pBuf, 0, (16 * sizeof(uint16)) );
        ; Setup parameters for call to function osal_memset
        MOV     R4,#0x20
        MOV     R5,#0x0
        MOV     R1,#0x0
        MOV     R2,?V0 + 0
        MOV     R3,?V0 + 1
        LCALL   ??osal_memset?relay
//  813     puint16 = assocList;
        MOV     A,#0x3
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     ?V0 + 6,R0
        MOV     ?V0 + 7,R1
//  814     for ( x = 0; x < assocCnt; x++ )
        MOV     ?V0 + 2,#0x0
??MT_ProcessGetDeviceInfo_2:
        MOV     A,?V0 + 2
        CLR     C
        SUBB    A,?V0 + 3
        JNC     ??MT_ProcessGetDeviceInfo_3
//  815     {
//  816       *pBuf++ = HI_UINT16( *puint16 );
        MOV     DPL,?V0 + 6
        MOV     DPH,?V0 + 7
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     A,R1
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        MOVX    @DPTR,A
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
//  817       *pBuf++ = LO_UINT16( *puint16 );
        MOV     DPL,?V0 + 6
        MOV     DPH,?V0 + 7
        MOVX    A,@DPTR
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        MOVX    @DPTR,A
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
//  818       puint16++;
        MOV     A,?V0 + 6
        ADD     A,#0x2
        MOV     ?V0 + 6,A
        MOV     A,?V0 + 7
        ADDC    A,#0x0
        MOV     ?V0 + 7,A
//  819     }
        INC     ?V0 + 2
        SJMP    ??MT_ProcessGetDeviceInfo_2
//  820 
//  821     if ( assocList )
??MT_ProcessGetDeviceInfo_3:
        MOV     A,#0x3
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        XRL     A,#0x0
        JNZ     ??MT_ProcessGetDeviceInfo_4
        INC     DPTR
        MOVX    A,@DPTR
        XRL     A,#0x0
??MT_ProcessGetDeviceInfo_4:
        JZ      ??MT_ProcessGetDeviceInfo_5
//  822       osal_mem_free( assocList );
        ; Setup parameters for call to function osal_mem_free
        MOV     A,#0x3
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        MOV     R2,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R3,A
        LCALL   ??osal_mem_free?relay
//  823 
//  824     MT_BuildAndSendZToolResponse( (SPI_0DATA_MSG_LEN + DEVICE_INFO_RESPONSE_LEN),
//  825                                   (SPI_RESPONSE_BIT | SPI_CMD_SYS_GET_DEVICE_INFO),
//  826                                   DEVICE_INFO_RESPONSE_LEN, buf );
??MT_ProcessGetDeviceInfo_5:
        ; Setup parameters for call to function MT_BuildAndSendZToolResponse
        MOV     A,#0x1
        LCALL   ?XSTACK_DISP0_8
        LCALL   ?PUSH_XSTACK8_X_TWO
        CFI CFA_XSP16 add(XSP16, 23)
        MOV     R4,#0x2e
        MOV     R2,#0x14
        MOV     R3,#0x10
        MOV     R1,#0x33
        LCALL   ??MT_BuildAndSendZToolResponse?relay
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 21)
//  827 
//  828     osal_mem_free( buf );
        ; Setup parameters for call to function osal_mem_free
        MOV     A,#0x1
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        MOV     R2,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R3,A
        LCALL   ??osal_mem_free?relay
//  829   }
//  830 }
??MT_ProcessGetDeviceInfo_1:
        MOV     A,#0x5
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 16)
        MOV     R7,#0x8
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock12
//  831 #endif
//  832 
//  833 #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
//  834 /***************************************************************************************************
//  835  * @fn      MT_ProcessSerialCommand
//  836  *
//  837  * @brief
//  838  *
//  839  *   Process Serial Message.
//  840  *
//  841  * @param   byte *msg - pointer to event message
//  842  *
//  843  * @return  void
//  844  ***************************************************************************************************/

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  845 void MT_ProcessSerialCommand( byte *msg )
MT_ProcessSerialCommand:
        CFI Block cfiBlock13 Using cfiCommon0
        CFI Function MT_ProcessSerialCommand
//  846 {
        FUNCALL MT_ProcessSerialCommand, MT_RAMRead
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 43, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessSerialCommand, MT_RAMWrite
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 43, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessSerialCommand, MT_SetDebugThreshold
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 43, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessSerialCommand, MT_Reset
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 43, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessSerialCommand, NLME_GetProtocolVersion
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 43, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessSerialCommand, osal_strlen
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 43, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessSerialCommand, MT_ReverseBytes
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 43, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessSerialCommand, ZMacSetReq
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 43, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessSerialCommand, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 47, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 47, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessSerialCommand, ZMacGetReq
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 43, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessSerialCommand, MT_ReverseBytes
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 43, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessSerialCommand, osal_nv_item_len
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 43, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessSerialCommand, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 47, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 47, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessSerialCommand, osal_nv_item_len
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 43, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessSerialCommand, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 47, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 47, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessSerialCommand, osal_nv_item_len
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 43, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessSerialCommand, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 47, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 47, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessSerialCommand, osal_nv_item_len
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 43, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessSerialCommand, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 47, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 47, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessSerialCommand, MT_ProcessGetNvInfo
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 43, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessSerialCommand, MT_ProcessGetDeviceInfo
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 43, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessSerialCommand, MT_ProcessSetNV
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 43, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessSerialCommand, MT_ProcessGetNV
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 43, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessSerialCommand, osal_GetSystemClock
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 43, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessSerialCommand, OnBoard_SendKeys
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 43, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessSerialCommand, MTProcessAppMsg
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 43, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessSerialCommand, MTProcessLedControl
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 43, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 43, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_ProcessSerialCommand, MT_BuildAndSendZToolResponse
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 45, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 45, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x10
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-11)))
        CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-12)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-13)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-14)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-15)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-16)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 16)
        ; Saved register size: 16
        ; Auto size: 27
        MOV     A,#-0x1b
        LCALL   ?ALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 43)
        MOV     A,#0x7
        LCALL   ?XSTACK_DISP0_8
        MOV     A,R2
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R3
        MOVX    @DPTR,A
//  847   UINT16 cmd;
//  848   UINT16 callbackID;
//  849   byte len;
//  850   byte ret;
//  851   byte *pData;
//  852   uint16 tmp16;
//  853   uint32 tmp32;
//  854   byte extAddr[Z_EXTADDR_LEN];
//  855   byte *retValue;
//  856   byte x = 0;
        MOV     R7,#0x0
//  857 #if !defined ( NONWK )
//  858   uint16 attLen;
//  859 #endif // NONWK
//  860 
//  861   // dig out header info
//  862   cmd = BUILD_UINT16( msg[1], msg[0] );
        MOV     A,#0x7
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R2,A
        MOV     R3,#0x0
        MOV     A,#0x7
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        MOVX    A,@DPTR
        MOV     R0,A
        CLR     A
        XCH     A,R0
        MOV     R1,A
        MOV     A,R0
        ADD     A,R2
        MOV     R0,A
        MOV     A,R1
        ADDC    A,R3
        MOV     R1,A
        MOV     A,#0xb
        LCALL   ?XSTACK_DISP0_8
        MOV     A,R0
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R1
        MOVX    @DPTR,A
//  863   save_cmd = cmd;
        MOV     A,#0xb
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     DPTR,#save_cmd
        MOV     A,R0
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R1
        MOVX    @DPTR,A
//  864   len = msg[2];
//  865   pData = &msg[3];
        MOV     A,#0x7
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        ADD     A,#0x3
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        ADDC    A,#0x0
        MOV     R1,A
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     A,R0
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R1
        MOVX    @DPTR,A
//  866 
//  867     // Setup for return;
//  868     len = 0;
        MOV     R6,#0x0
//  869     retValue = &ret;
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     R0,DPL
        MOV     R1,DPH
        MOV     A,#0x5
        LCALL   ?XSTACK_DISP0_8
        MOV     A,R0
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R1
        MOVX    @DPTR,A
//  870 
//  871     //Process the contents of the message
//  872     switch ( cmd )
        MOV     A,#0xb
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        MOV     ?V0 + 0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     ?V0 + 1,A
        MOV     R0,#?V0 + 0
        LCALL   ?US_SWITCH_DENSE
`?<Jumptable for MT_ProcessSerialCommand>_0`:
        DATA
        DW        1
        DB        30
        DW        ??MT_ProcessSerialCommand_0
        DW        ??MT_ProcessSerialCommand_1
        DW        ??MT_ProcessSerialCommand_2
        DW        ??MT_ProcessSerialCommand_3
        DW        ??MT_ProcessSerialCommand_0
        DW        ??MT_ProcessSerialCommand_4
        DW        ??MT_ProcessSerialCommand_5
        DW        ??MT_ProcessSerialCommand_6
        DW        ??MT_ProcessSerialCommand_7
        DW        ??MT_ProcessSerialCommand_0
        DW        ??MT_ProcessSerialCommand_0
        DW        ??MT_ProcessSerialCommand_0
        DW        ??MT_ProcessSerialCommand_0
        DW        ??MT_ProcessSerialCommand_0
        DW        ??MT_ProcessSerialCommand_0
        DW        ??MT_ProcessSerialCommand_0
        DW        ??MT_ProcessSerialCommand_8
        DW        ??MT_ProcessSerialCommand_9
        DW        ??MT_ProcessSerialCommand_10
        DW        ??MT_ProcessSerialCommand_11
        DW        ??MT_ProcessSerialCommand_12
        DW        ??MT_ProcessSerialCommand_0
        DW        ??MT_ProcessSerialCommand_13
        DW        ??MT_ProcessSerialCommand_14
        DW        ??MT_ProcessSerialCommand_15
        DW        ??MT_ProcessSerialCommand_16
        DW        ??MT_ProcessSerialCommand_17
        DW        ??MT_ProcessSerialCommand_18
        DW        ??MT_ProcessSerialCommand_19
        DW        ??MT_ProcessSerialCommand_20
        DW        ??MT_ProcessSerialCommand_21
        DW        ??MT_ProcessSerialCommand_22
        CODE
//  873     {
//  874 #ifdef MACSIM
//  875       case SPI_CMD_ZIGNET_DATA:
//  876         MACSIM_TranslateMsg( pData, len );
//  877         break;
//  878 #endif
//  879 
//  880       case SPI_CMD_SYS_RAM_READ:
//  881         extAddr[0] = MT_RAMRead( (UINT16)BUILD_UINT16( pData[1], pData[0] ), &extAddr[1] );
??MT_ProcessSerialCommand_1:
        ; Setup parameters for call to function MT_RAMRead
        MOV     A,#0x12
        LCALL   ?XSTACK_DISP0_8
        MOV     R4,DPL
        MOV     R5,DPH
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R2,A
        MOV     R3,#0x0
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        MOVX    A,@DPTR
        MOV     R0,A
        CLR     A
        XCH     A,R0
        MOV     R1,A
        MOV     A,R0
        ADD     A,R2
        MOV     R2,A
        MOV     A,R1
        ADDC    A,R3
        MOV     R3,A
        LCALL   ??MT_RAMRead?relay
        MOV     A,R1
        PUSH    A
        CFI CFA_SP SP+-1
        MOV     A,#0x11
        LCALL   ?XSTACK_DISP0_8
        POP     A
        CFI CFA_SP SP+0
        MOVX    @DPTR,A
//  882         len = MT_RAM_READ_RESP_LEN;
        MOV     R6,#0x2
//  883         retValue = extAddr;
        MOV     A,#0x11
        LCALL   ?XSTACK_DISP0_8
        MOV     R0,DPL
        MOV     R1,DPH
        MOV     A,#0x5
        LCALL   ?XSTACK_DISP0_8
        MOV     A,R0
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R1
        MOVX    @DPTR,A
        LJMP    ??MT_ProcessSerialCommand_0 & 0xFFFF
//  884         break;
//  885 
//  886       case SPI_CMD_SYS_RAM_WRITE:
//  887         ret = MT_RAMWrite( (UINT16)BUILD_UINT16( pData[1], pData[0] ), pData[2] );
??MT_ProcessSerialCommand_2:
        ; Setup parameters for call to function MT_RAMWrite
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R4,A
        MOV     R5,#0x0
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        MOVX    A,@DPTR
        MOV     R2,A
        CLR     A
        XCH     A,R2
        MOV     R3,A
        MOV     A,R2
        ADD     A,R4
        MOV     R2,A
        MOV     A,R3
        ADDC    A,R5
        MOV     R3,A
        LCALL   ??MT_RAMWrite?relay
        MOV     A,R1
        PUSH    A
        CFI CFA_SP SP+-1
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        POP     A
        CFI CFA_SP SP+0
        MOVX    @DPTR,A
//  888         len = MT_RAM_WRITE_RESP_LEN;
        MOV     R6,#0x1
        LJMP    ??MT_ProcessSerialCommand_0 & 0xFFFF
//  889         break;
//  890 
//  891       case SPI_CMD_SYS_SET_DEBUG_THRESHOLD:
//  892         ret = MT_SetDebugThreshold( pData[0], pData[1] );
??MT_ProcessSerialCommand_3:
        ; Setup parameters for call to function MT_SetDebugThreshold
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R2,A
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        MOVX    A,@DPTR
        MOV     R1,A
        LCALL   ??MT_SetDebugThreshold?relay
        MOV     A,R1
        PUSH    A
        CFI CFA_SP SP+-1
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        POP     A
        CFI CFA_SP SP+0
        MOVX    @DPTR,A
//  893         len = 1;
        MOV     R6,#0x1
        LJMP    ??MT_ProcessSerialCommand_0 & 0xFFFF
//  894         break;
//  895 
//  896       case SPI_CMD_TRACE_SUB:
//  897         break;
//  898 
//  899       case SPI_CMD_SYS_RESET:
//  900         MT_Reset( pData[0] );
??MT_ProcessSerialCommand_4:
        ; Setup parameters for call to function MT_Reset
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        MOVX    A,@DPTR
        MOV     R1,A
        LCALL   ??MT_Reset?relay
        LJMP    ??MT_ProcessSerialCommand_0 & 0xFFFF
//  901         break;
//  902 
//  903       case SPI_CMD_SYS_CALLBACK_SUB_CMD:
//  904         // a callback value of 0xFFFF turns on all available callbacks
//  905         callbackID = BUILD_UINT16( pData[1] , pData[0] );
??MT_ProcessSerialCommand_5:
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R2,A
        MOV     R3,#0x0
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        MOVX    A,@DPTR
        MOV     R0,A
        CLR     A
        XCH     A,R0
        MOV     R1,A
        MOV     A,R0
        ADD     A,R2
        MOV     R0,A
        MOV     A,R1
        ADDC    A,R3
        MOV     R1,A
        MOV     A,#0x19
        LCALL   ?XSTACK_DISP0_8
        MOV     A,R0
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R1
        MOVX    @DPTR,A
//  906         if ( callbackID == 0xFFFF )
//  907         {
//  908           // What is the action
//  909           if ( pData[2] )
//  910           {
//  911             // Turn on
//  912 #if defined( MT_MAC_CB_FUNC )
//  913             _macCallbackSub = 0xFFFF;
//  914 #endif
//  915 #if defined( MT_NWK_CB_FUNC )
//  916             _nwkCallbackSub = 0xFFFF;
//  917 #endif
//  918 
//  919 #if defined( MT_ZDO_FUNC )
//  920             _zdoCallbackSub = 0xFFFFFFFF;
//  921 #endif
//  922 #if defined( MT_AF_CB_FUNC )
//  923             _afCallbackSub = 0xFFFF;
//  924 #endif
//  925 #if defined( MT_SAPI_CB_FUNC )
//  926             _sapiCallbackSub = 0xFFFF;
//  927 #endif
//  928           }
//  929           else
//  930           {
//  931             // Turn off
//  932 #if defined( MT_MAC_CB_FUNC )
//  933             _macCallbackSub = 0x0000;
//  934 #endif
//  935 #if defined( MT_NWK_CB_FUNC )
//  936             _nwkCallbackSub = 0x0000;
//  937 #endif
//  938 
//  939 #if defined( MT_ZDO_FUNC )
//  940             _zdoCallbackSub = 0x00000000;
//  941 #endif
//  942 #if defined( MT_AF_CB_FUNC )
//  943             _afCallbackSub = 0x0000;
//  944 #endif
//  945 #if defined( MT_SAPI_CB_FUNC )
//  946             _sapiCallbackSub = 0x0000;
//  947 #endif
//  948           }
//  949         }
//  950         else
//  951         {
//  952           //First check which layer callbacks are desired and then set the preference
//  953 
//  954 #if defined( MT_MAC_CB_FUNC )
//  955           //If it is a MAC callback, set the corresponding callback subscription bit
//  956           if (( callbackID & 0xFFF0 ) == SPI_MAC_CB_TYPE )
//  957           {
//  958             //Based on the action field, either enable or disable subscription
//  959             if ( pData[2] )
//  960               _macCallbackSub |=  ( 1 << ( pData[1] & 0x0F ) );
//  961             else
//  962               _macCallbackSub &= ~( 1 << ( pData[1] & 0x0F ) );
//  963           }
//  964 #endif
//  965 
//  966 #if defined( MT_NWK_CB_FUNC )
//  967           //If it is a NWK callback, set the corresponding callback subscription bit
//  968           if (( callbackID & 0xFFF0 ) == SPI_NWK_CB_TYPE )
//  969           {
//  970 
//  971             //Based on the action field, either enable or disable subscription
//  972             if ( pData[2] )
//  973               _nwkCallbackSub |=  ( 1 << ( pData[1] & 0x0F ) ) ;
//  974             else
//  975               _nwkCallbackSub &= ~( 1 << ( pData[1] & 0x0F ) );
//  976           }
//  977 #endif
//  978 
//  979 #if defined( MT_ZDO_FUNC )
//  980           //If it is a APS callback, set the corresponding callback subscription bit
//  981           if ( ((callbackID & 0xFFF0) == SPI_ZDO_CB_TYPE) ||
//  982                ((callbackID & 0xFFF0) == SPI_ZDO_CB2_TYPE) )
//  983           {
//  984             //Based on the action field, either enable or disable subscription
//  985             if ( pData[2] )
//  986               _zdoCallbackSub |=  ( 1L << ( pData[1] & 0x1F ) );
//  987             else
//  988               _zdoCallbackSub &= ~( 1L << ( pData[1] & 0x1F ) );
//  989           }
//  990 #endif
//  991 
//  992 #if defined( MT_AF_CB_FUNC )
//  993           // Set the corresponding callback subscription bit for an AF callback.
//  994           if (( callbackID & 0xFFF0 ) == SPI_AF_CB_TYPE )
//  995           {
//  996             // Based on the action field, either enable or disable subscription.
//  997             if ( pData[2] )
//  998               _afCallbackSub |=  ( 1 << ( pData[1] & 0x0F ) );
//  999             else
// 1000               _afCallbackSub &= ~( 1 << ( pData[1] & 0x0F ) );
// 1001           }
// 1002 #endif
// 1003 #if defined( MT_SAPI_CB_FUNC )
// 1004           // Set the corresponding callback subscription bit for an SAPI callback.
// 1005           if (( callbackID & 0xFFF0 ) == SPI_SAPI_CB_TYPE )
// 1006           {
// 1007             // Based on the action field, either enable or disable subscription.
// 1008             if ( pData[2] )
// 1009               _sapiCallbackSub |=  ( 1 << ( pData[1] & 0x0F ) );
// 1010             else
// 1011               _sapiCallbackSub &= ~( 1 << ( pData[1] & 0x0F ) );
// 1012           }
// 1013 #endif
// 1014         }
// 1015         len = 1;
        MOV     R6,#0x1
// 1016         ret = ZSUCCESS;
        MOV     A,#0x0
        PUSH    A
        CFI CFA_SP SP+-1
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        POP     A
        CFI CFA_SP SP+0
        MOVX    @DPTR,A
        LJMP    ??MT_ProcessSerialCommand_0 & 0xFFFF
// 1017         break;
// 1018 
// 1019       case SPI_CMD_SYS_PING:
// 1020         // Get a message buffer to build response message
// 1021         // The Ping response now has capabilities included
// 1022 
// 1023         // Build Capabilities
// 1024         tmp16 = MT_CAP_MAC | MT_CAP_NWK | MT_CAP_AF |
// 1025                 MT_CAP_ZDO | MT_CAP_USER_TEST | MT_CAP_SAPI_FUNC;
??MT_ProcessSerialCommand_6:
        MOV     A,#0x9
        LCALL   ?XSTACK_DISP0_8
        MOV     A,#0x0
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,#0x0
        MOVX    @DPTR,A
// 1026 
// 1027         // Convert to high byte first into temp buffer
// 1028         extAddr[0] = HI_UINT16( tmp16 );
        MOV     A,#0x9
        LCALL   ?XSTACK_DISP0_8
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     A,R1
        PUSH    A
        CFI CFA_SP SP+-1
        MOV     A,#0x11
        LCALL   ?XSTACK_DISP0_8
        POP     A
        CFI CFA_SP SP+0
        MOVX    @DPTR,A
// 1029         extAddr[1] = LO_UINT16( tmp16 );
        MOV     A,#0x9
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        PUSH    A
        CFI CFA_SP SP+-1
        MOV     A,#0x12
        LCALL   ?XSTACK_DISP0_8
        POP     A
        CFI CFA_SP SP+0
        MOVX    @DPTR,A
// 1030         len = sizeof ( tmp16 );
        MOV     R6,#0x2
// 1031         retValue = extAddr;
        MOV     A,#0x11
        LCALL   ?XSTACK_DISP0_8
        MOV     R0,DPL
        MOV     R1,DPH
        MOV     A,#0x5
        LCALL   ?XSTACK_DISP0_8
        MOV     A,R0
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R1
        MOVX    @DPTR,A
        LJMP    ??MT_ProcessSerialCommand_0 & 0xFFFF
// 1032         break;
// 1033 
// 1034       case SPI_CMD_SYS_VERSION:
// 1035         {
// 1036 #if !defined ( NONWK )
// 1037           uint8 i = NLME_GetProtocolVersion() - 1;
??MT_ProcessSerialCommand_7:
        ; Setup parameters for call to function NLME_GetProtocolVersion
        LCALL   ??NLME_GetProtocolVersion?relay
        MOV     A,R1
        ADD     A,#-0x1
        MOV     ?V0 + 0,A
// 1038 #else
// 1039           uint8 i = 1;   // just say '1.1' -- irrelevant if stack isn't there anyway
// 1040 #endif
// 1041 
// 1042           // Get a message buffer to build response message
// 1043           len      = (byte)(osal_strlen( (char *)MTVersionString[i] ));
        ; Setup parameters for call to function osal_strlen
        MOV     R0,?V0 + 0
        MOV     R1,#0x0
        MOV     A,R0
        MOV     B,#0x2
        MUL     AB
        XCH     A,R0
        MOV     R2,B
        MOV     B,#0x0
        MUL     AB
        ADD     A,R2
        MOV     R2,A
        MOV     B,#0x2
        MOV     A,R1
        MUL     AB
        ADD     A,R2
        MOV     R1,A
        MOV     A,R0
        ADD     A,#(MTVersionString & 0xff)
        MOV     DPL,A
        MOV     A,R1
        ADDC    A,#((MTVersionString >> 8) & 0xff)
        MOV     DPH,A
        MOVX    A,@DPTR
        MOV     R2,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R3,A
        LCALL   ??osal_strlen?relay
        MOV     A,R2
        MOV     R6,A
// 1044           retValue = (byte *)MTVersionString[i];
        MOV     R0,?V0 + 0
        MOV     R1,#0x0
        MOV     A,R0
        MOV     B,#0x2
        MUL     AB
        XCH     A,R0
        MOV     R2,B
        MOV     B,#0x0
        MUL     AB
        ADD     A,R2
        MOV     R2,A
        MOV     B,#0x2
        MOV     A,R1
        MUL     AB
        ADD     A,R2
        MOV     R1,A
        MOV     A,R0
        ADD     A,#(MTVersionString & 0xff)
        MOV     DPL,A
        MOV     A,R1
        ADDC    A,#((MTVersionString >> 8) & 0xff)
        MOV     DPH,A
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     A,#0x5
        LCALL   ?XSTACK_DISP0_8
        MOV     A,R0
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R1
        MOVX    @DPTR,A
        LJMP    ??MT_ProcessSerialCommand_0 & 0xFFFF
// 1045         }
// 1046           break;
// 1047 
// 1048       case SPI_CMD_SYS_SET_EXTADDR:
// 1049         // Incoming extended address is reversed
// 1050         MT_ReverseBytes( pData, Z_EXTADDR_LEN );
??MT_ProcessSerialCommand_8:
        ; Setup parameters for call to function MT_ReverseBytes
        MOV     R1,#0x8
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R2,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R3,A
        LCALL   ??MT_ReverseBytes?relay
// 1051 
// 1052         if ( ZMacSetReq( ZMacExtAddr, pData ) == ZMacSuccess )
        ; Setup parameters for call to function ZMacSetReq
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R2,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R3,A
        MOV     R1,#-0x1e
        LCALL   ZMacSetReq & 0xFFFF
        MOV     A,R1
        JNZ     ??MT_ProcessSerialCommand_23
// 1053           ret = osal_nv_write( ZCD_NV_EXTADDR, 0, Z_EXTADDR_LEN, pData );
        ; Setup parameters for call to function osal_nv_write
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        LCALL   ?PUSH_XSTACK8_X_TWO
        CFI CFA_XSP16 add(XSP16, 45)
        MOV     ?V0 + 0,#0x8
        MOV     ?V0 + 1,#0x0
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 47)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     R2,#0x1
        MOV     R3,#0x0
        LCALL   ??osal_nv_write?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 43)
        MOV     A,R1
        PUSH    A
        CFI CFA_SP SP+-1
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        POP     A
        CFI CFA_SP SP+0
        MOVX    @DPTR,A
        SJMP    ??MT_ProcessSerialCommand_24
// 1054         else
// 1055           ret = 1;
??MT_ProcessSerialCommand_23:
        MOV     A,#0x1
        PUSH    A
        CFI CFA_SP SP+-1
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        POP     A
        CFI CFA_SP SP+0
        MOVX    @DPTR,A
// 1056         len = 1;
??MT_ProcessSerialCommand_24:
        MOV     R6,#0x1
        LJMP    ??MT_ProcessSerialCommand_0 & 0xFFFF
// 1057         break;
// 1058 
// 1059       case SPI_CMD_SYS_GET_EXTADDR:
// 1060         ZMacGetReq( ZMacExtAddr, extAddr );
??MT_ProcessSerialCommand_9:
        ; Setup parameters for call to function ZMacGetReq
        MOV     A,#0x11
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        MOV     R1,#-0x1e
        LCALL   ZMacGetReq & 0xFFFF
// 1061 
// 1062         // Outgoing extended address needs to be reversed
// 1063         MT_ReverseBytes( extAddr, Z_EXTADDR_LEN );
        ; Setup parameters for call to function MT_ReverseBytes
        MOV     R1,#0x8
        MOV     A,#0x11
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??MT_ReverseBytes?relay
// 1064 
// 1065         len = Z_EXTADDR_LEN;
        MOV     R6,#0x8
// 1066         retValue = extAddr;
        MOV     A,#0x11
        LCALL   ?XSTACK_DISP0_8
        MOV     R0,DPL
        MOV     R1,DPH
        MOV     A,#0x5
        LCALL   ?XSTACK_DISP0_8
        MOV     A,R0
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R1
        MOVX    @DPTR,A
        LJMP    ??MT_ProcessSerialCommand_0 & 0xFFFF
// 1067         break;
// 1068 
// 1069 #if !defined ( NONWK )
// 1070       case SPI_CMD_SYS_SET_PANID:
// 1071         tmp16 = BUILD_UINT16( pData[1], pData[0] );
??MT_ProcessSerialCommand_18:
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R2,A
        MOV     R3,#0x0
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        MOVX    A,@DPTR
        MOV     R0,A
        CLR     A
        XCH     A,R0
        MOV     R1,A
        MOV     A,R0
        ADD     A,R2
        MOV     R0,A
        MOV     A,R1
        ADDC    A,R3
        MOV     R1,A
        MOV     A,#0x9
        LCALL   ?XSTACK_DISP0_8
        MOV     A,R0
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R1
        MOVX    @DPTR,A
// 1072         attLen = osal_nv_item_len( ZCD_NV_PANID );
        ; Setup parameters for call to function osal_nv_item_len
        MOV     R2,#-0x7d
        MOV     R3,#0x0
        LCALL   ??osal_nv_item_len?relay
        MOV     A,#0x3
        LCALL   ?XSTACK_DISP0_8
        MOV     A,R2
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R3
        MOVX    @DPTR,A
// 1073         ret = osal_nv_write( ZCD_NV_PANID, 0, attLen, &tmp16 );
        ; Setup parameters for call to function osal_nv_write
        MOV     A,#0x9
        LCALL   ?XSTACK_DISP0_8
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 45)
        MOV     A,#0x5
        LCALL   ?XSTACK_DISP0_8
        LCALL   ?PUSH_XSTACK8_X_TWO
        CFI CFA_XSP16 add(XSP16, 47)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     R2,#-0x7d
        MOV     R3,#0x0
        LCALL   ??osal_nv_write?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 43)
        MOV     A,R1
        PUSH    A
        CFI CFA_SP SP+-1
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        POP     A
        CFI CFA_SP SP+0
        MOVX    @DPTR,A
// 1074         len = 1;
        MOV     R6,#0x1
        LJMP    ??MT_ProcessSerialCommand_0 & 0xFFFF
// 1075         break;
// 1076 
// 1077       case SPI_CMD_SYS_SET_CHANNELS:
// 1078         tmp32 = BUILD_UINT32( pData[3], pData[2], pData[1], pData[0] );
??MT_ProcessSerialCommand_19:
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     ?V0 + 0,A
        CLR     A
        MOV     ?V0 + 1,A
        MOV     ?V0 + 2,A
        MOV     ?V0 + 3,A
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     ?V0 + 4,A
        CLR     A
        MOV     ?V0 + 5,A
        MOV     ?V0 + 6,A
        MOV     ?V0 + 7,A
        MOV     A,#0x8
        MOV     R0,#?V0 + 4
        LCALL   ?L_SHL
        MOV     R0,#?V0 + 0
        MOV     R1,#?V0 + 4
        LCALL   ?L_ADD
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        INC     DPTR
        MOVX    A,@DPTR
        MOV     ?V0 + 4,A
        CLR     A
        MOV     ?V0 + 5,A
        MOV     ?V0 + 6,A
        MOV     ?V0 + 7,A
        MOV     A,#0x10
        MOV     R0,#?V0 + 4
        LCALL   ?L_SHL
        MOV     R0,#?V0 + 0
        MOV     R1,#?V0 + 4
        LCALL   ?L_ADD
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        MOVX    A,@DPTR
        MOV     ?V0 + 4,A
        CLR     A
        MOV     ?V0 + 5,A
        MOV     ?V0 + 6,A
        MOV     ?V0 + 7,A
        MOV     A,#0x18
        MOV     R0,#?V0 + 4
        LCALL   ?L_SHL
        MOV     R0,#?V0 + 0
        MOV     R1,#?V0 + 4
        LCALL   ?L_ADD
        MOV     A,#0xd
        LCALL   ?XSTACK_DISP0_8
        MOV     A,?V0 + 0
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,?V0 + 1
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,?V0 + 2
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,?V0 + 3
        MOVX    @DPTR,A
// 1079         attLen = osal_nv_item_len( ZCD_NV_CHANLIST );
        ; Setup parameters for call to function osal_nv_item_len
        MOV     R2,#-0x7c
        MOV     R3,#0x0
        LCALL   ??osal_nv_item_len?relay
        MOV     A,#0x3
        LCALL   ?XSTACK_DISP0_8
        MOV     A,R2
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R3
        MOVX    @DPTR,A
// 1080         ret = osal_nv_write( ZCD_NV_CHANLIST, 0, attLen, &tmp32 );
        ; Setup parameters for call to function osal_nv_write
        MOV     A,#0xd
        LCALL   ?XSTACK_DISP0_8
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 45)
        MOV     A,#0x5
        LCALL   ?XSTACK_DISP0_8
        LCALL   ?PUSH_XSTACK8_X_TWO
        CFI CFA_XSP16 add(XSP16, 47)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     R2,#-0x7c
        MOV     R3,#0x0
        LCALL   ??osal_nv_write?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 43)
        MOV     A,R1
        PUSH    A
        CFI CFA_SP SP+-1
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        POP     A
        CFI CFA_SP SP+0
        MOVX    @DPTR,A
// 1081         len = 1;
        MOV     R6,#0x1
        LJMP    ??MT_ProcessSerialCommand_0 & 0xFFFF
// 1082         break;
// 1083 
// 1084       case SPI_CMD_SYS_SET_SECLEVEL:
// 1085         attLen = osal_nv_item_len( ZCD_NV_SECURITY_LEVEL );
??MT_ProcessSerialCommand_20:
        ; Setup parameters for call to function osal_nv_item_len
        MOV     R2,#0x61
        MOV     R3,#0x0
        LCALL   ??osal_nv_item_len?relay
        MOV     A,#0x3
        LCALL   ?XSTACK_DISP0_8
        MOV     A,R2
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R3
        MOVX    @DPTR,A
// 1086         ret = osal_nv_write( ZCD_NV_SECURITY_LEVEL, 0, attLen, pData );
        ; Setup parameters for call to function osal_nv_write
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        LCALL   ?PUSH_XSTACK8_X_TWO
        CFI CFA_XSP16 add(XSP16, 45)
        MOV     A,#0x5
        LCALL   ?XSTACK_DISP0_8
        LCALL   ?PUSH_XSTACK8_X_TWO
        CFI CFA_XSP16 add(XSP16, 47)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     R2,#0x61
        MOV     R3,#0x0
        LCALL   ??osal_nv_write?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 43)
        MOV     A,R1
        PUSH    A
        CFI CFA_SP SP+-1
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        POP     A
        CFI CFA_SP SP+0
        MOVX    @DPTR,A
// 1087         len = 1;
        MOV     R6,#0x1
        LJMP    ??MT_ProcessSerialCommand_0 & 0xFFFF
// 1088         break;
// 1089 
// 1090       case SPI_CMD_SYS_SET_PRECFGKEY:
// 1091         attLen = osal_nv_item_len( ZCD_NV_PRECFGKEY );
??MT_ProcessSerialCommand_21:
        ; Setup parameters for call to function osal_nv_item_len
        MOV     R2,#0x62
        MOV     R3,#0x0
        LCALL   ??osal_nv_item_len?relay
        MOV     A,#0x3
        LCALL   ?XSTACK_DISP0_8
        MOV     A,R2
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R3
        MOVX    @DPTR,A
// 1092         ret = osal_nv_write( ZCD_NV_PRECFGKEY, 0, attLen, pData );
        ; Setup parameters for call to function osal_nv_write
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        LCALL   ?PUSH_XSTACK8_X_TWO
        CFI CFA_XSP16 add(XSP16, 45)
        MOV     A,#0x5
        LCALL   ?XSTACK_DISP0_8
        LCALL   ?PUSH_XSTACK8_X_TWO
        CFI CFA_XSP16 add(XSP16, 47)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     R2,#0x62
        MOV     R3,#0x0
        LCALL   ??osal_nv_write?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 43)
        MOV     A,R1
        PUSH    A
        CFI CFA_SP SP+-1
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        POP     A
        CFI CFA_SP SP+0
        MOVX    @DPTR,A
// 1093         len = 1;
        MOV     R6,#0x1
        LJMP    ??MT_ProcessSerialCommand_0 & 0xFFFF
// 1094         break;
// 1095 
// 1096       case SPI_CMD_SYS_GET_NV_INFO:
// 1097         MT_ProcessGetNvInfo();
??MT_ProcessSerialCommand_22:
        ; Setup parameters for call to function MT_ProcessGetNvInfo
        LCALL   ??MT_ProcessGetNvInfo?relay
        LJMP    ??MT_ProcessSerialCommand_0 & 0xFFFF
// 1098         break;
// 1099 #endif // NONWK
// 1100 
// 1101       case SPI_CMD_SYS_GET_DEVICE_INFO:
// 1102         MT_ProcessGetDeviceInfo();
??MT_ProcessSerialCommand_12:
        ; Setup parameters for call to function MT_ProcessGetDeviceInfo
        LCALL   ??MT_ProcessGetDeviceInfo?relay
        LJMP    ??MT_ProcessSerialCommand_0 & 0xFFFF
// 1103         break;
// 1104 
// 1105       case SPI_CMD_SYS_SET_NV:
// 1106         ret = MT_ProcessSetNV( pData );
??MT_ProcessSerialCommand_10:
        ; Setup parameters for call to function MT_ProcessSetNV
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R2,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R3,A
        LCALL   ??MT_ProcessSetNV?relay
        MOV     A,R1
        PUSH    A
        CFI CFA_SP SP+-1
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        POP     A
        CFI CFA_SP SP+0
        MOVX    @DPTR,A
// 1107         len = 1;
        MOV     R6,#0x1
        LJMP    ??MT_ProcessSerialCommand_0 & 0xFFFF
// 1108         break;
// 1109 
// 1110       case SPI_CMD_SYS_GET_NV:
// 1111         MT_ProcessGetNV( pData );
??MT_ProcessSerialCommand_11:
        ; Setup parameters for call to function MT_ProcessGetNV
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R2,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R3,A
        LCALL   ??MT_ProcessGetNV?relay
        LJMP    ??MT_ProcessSerialCommand_0 & 0xFFFF
// 1112         break;
// 1113 
// 1114       case SPI_CMD_SYS_TIME_ALIVE:
// 1115         // Time since last reset (seconds)
// 1116         tmp32 = osal_GetSystemClock() / 1000;
??MT_ProcessSerialCommand_17:
        ; Setup parameters for call to function osal_GetSystemClock
        LCALL   ??osal_GetSystemClock?relay
        MOV     ?V0 + 4,R2
        MOV     ?V0 + 5,R3
        MOV     ?V0 + 6,R4
        MOV     ?V0 + 7,R5
        MOV     DPTR,#__Constant_3e8
        MOV     R0,#?V0 + 0
        LCALL   ?L_MOV_X
        MOV     R0,#?V0 + 4
        MOV     R1,#?V0 + 0
        LCALL   ?UL_DIV_MOD
        MOV     A,#0xd
        LCALL   ?XSTACK_DISP0_8
        MOV     A,?V0 + 4
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,?V0 + 5
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,?V0 + 6
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,?V0 + 7
        MOVX    @DPTR,A
// 1117         // Convert to high byte first into temp buffer
// 1118         extAddr[0] = BREAK_UINT32( tmp32, 3 );
        MOV     A,#0xd
        LCALL   ?XSTACK_DISP0_8
        MOV     R0,#?V0 + 0
        LCALL   ?L_MOV_X
        MOV     A,#0x18
        MOV     R0,#?V0 + 0
        LCALL   ?UL_SHR
        MOV     A,#0x11
        LCALL   ?XSTACK_DISP0_8
        MOV     A,?V0 + 0
        MOVX    @DPTR,A
// 1119         extAddr[1] = BREAK_UINT32( tmp32, 2 );
        MOV     A,#0xd
        LCALL   ?XSTACK_DISP0_8
        MOV     R0,#?V0 + 0
        LCALL   ?L_MOV_X
        MOV     A,#0x10
        MOV     R0,#?V0 + 0
        LCALL   ?UL_SHR
        MOV     A,#0x12
        LCALL   ?XSTACK_DISP0_8
        MOV     A,?V0 + 0
        MOVX    @DPTR,A
// 1120         extAddr[2] = BREAK_UINT32( tmp32, 1 );
        MOV     A,#0xd
        LCALL   ?XSTACK_DISP0_8
        MOV     R0,#?V0 + 0
        LCALL   ?L_MOV_X
        MOV     A,?V0 + 1
        MOV     ?V0 + 0,A
        MOV     A,#0x13
        LCALL   ?XSTACK_DISP0_8
        MOV     A,?V0 + 0
        MOVX    @DPTR,A
// 1121         extAddr[3] = BREAK_UINT32( tmp32, 0 );
        MOV     A,#0xd
        LCALL   ?XSTACK_DISP0_8
        MOV     R0,#?V0 + 0
        LCALL   ?L_MOV_X
        MOV     A,#0x14
        LCALL   ?XSTACK_DISP0_8
        MOV     A,?V0 + 0
        MOVX    @DPTR,A
// 1122         len = sizeof ( tmp32 );
        MOV     R6,#0x4
// 1123         retValue = extAddr;
        MOV     A,#0x11
        LCALL   ?XSTACK_DISP0_8
        MOV     R0,DPL
        MOV     R1,DPH
        MOV     A,#0x5
        LCALL   ?XSTACK_DISP0_8
        MOV     A,R0
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R1
        MOVX    @DPTR,A
        LJMP    ??MT_ProcessSerialCommand_0 & 0xFFFF
// 1124         break;
// 1125 
// 1126       case SPI_CMD_SYS_KEY_EVENT:
// 1127         // Translate between SPI values to device values
// 1128         if ( pData[1] & 0x01 )
??MT_ProcessSerialCommand_13:
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        INC     DPTR
        MOVX    A,@DPTR
        MOV     C,0xE0 /* A   */.0
        JNC     ??MT_ProcessSerialCommand_25
// 1129           x |= HAL_KEY_SW_1;
        SETB    C
        MOV     A,R7
        MOV     0xE0 /* A   */.0,C
        MOV     R7,A
// 1130         if ( pData[1] & 0x02 )
??MT_ProcessSerialCommand_25:
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        INC     DPTR
        MOVX    A,@DPTR
        MOV     C,0xE0 /* A   */.1
        JNC     ??MT_ProcessSerialCommand_26
// 1131           x |= HAL_KEY_SW_2;
        SETB    C
        MOV     A,R7
        MOV     0xE0 /* A   */.1,C
        MOV     R7,A
// 1132         if ( pData[1] & 0x04 )
??MT_ProcessSerialCommand_26:
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        INC     DPTR
        MOVX    A,@DPTR
        MOV     C,0xE0 /* A   */.2
        JNC     ??MT_ProcessSerialCommand_27
// 1133           x |= HAL_KEY_SW_3;
        SETB    C
        MOV     A,R7
        MOV     0xE0 /* A   */.4,C
        MOV     R7,A
// 1134         if ( pData[1] & 0x08 )
??MT_ProcessSerialCommand_27:
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        INC     DPTR
        MOVX    A,@DPTR
        MOV     C,0xE0 /* A   */.3
        JNC     ??MT_ProcessSerialCommand_28
// 1135           x |= HAL_KEY_SW_4;
        SETB    C
        MOV     A,R7
        MOV     0xE0 /* A   */.3,C
        MOV     R7,A
// 1136 #if defined ( HAL_KEY_SW_5 )
// 1137         if ( pData[1] & 0x10 )
??MT_ProcessSerialCommand_28:
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        INC     DPTR
        MOVX    A,@DPTR
        MOV     C,0xE0 /* A   */.4
        JNC     ??MT_ProcessSerialCommand_29
// 1138           x |= HAL_KEY_SW_5;
        SETB    C
        MOV     A,R7
        MOV     0xE0 /* A   */.2,C
        MOV     R7,A
// 1139 #endif
// 1140 #if defined ( HAL_KEY_SW_6 )
// 1141         if ( pData[1] & 0x20 )
??MT_ProcessSerialCommand_29:
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        INC     DPTR
        MOVX    A,@DPTR
        MOV     C,0xE0 /* A   */.5
        JNC     ??MT_ProcessSerialCommand_30
// 1142           x |= HAL_KEY_SW_6;
        SETB    C
        MOV     A,R7
        MOV     0xE0 /* A   */.5,C
        MOV     R7,A
// 1143 #endif
// 1144 #if defined ( HAL_KEY_SW_7 )
// 1145         if ( pData[1] & 0x40 )
??MT_ProcessSerialCommand_30:
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        INC     DPTR
        MOVX    A,@DPTR
        MOV     C,0xE0 /* A   */.6
        JNC     ??MT_ProcessSerialCommand_31
// 1146           x |= HAL_KEY_SW_7;
        SETB    C
        MOV     A,R7
        MOV     0xE0 /* A   */.6,C
        MOV     R7,A
// 1147 #endif
// 1148 #if defined ( HAL_KEY_SW_8 )
// 1149         if ( pData[1] & 0x80 )
// 1150           x |= HAL_KEY_SW_8;
// 1151 #endif
// 1152         ret = OnBoard_SendKeys( x, pData[0]  );
??MT_ProcessSerialCommand_31:
        ; Setup parameters for call to function OnBoard_SendKeys
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        MOVX    A,@DPTR
        MOV     R2,A
        MOV     A,R7
        MOV     R1,A
        LCALL   ??OnBoard_SendKeys?relay
        MOV     A,R1
        PUSH    A
        CFI CFA_SP SP+-1
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        POP     A
        CFI CFA_SP SP+0
        MOVX    @DPTR,A
// 1153         len = 1;
        MOV     R6,#0x1
        SJMP    ??MT_ProcessSerialCommand_0
// 1154         break;
// 1155 
// 1156       case SPI_CMD_SYS_HEARTBEAT:
// 1157         ret = ZSUCCESS;
??MT_ProcessSerialCommand_14:
        MOV     A,#0x0
        PUSH    A
        CFI CFA_SP SP+-1
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        POP     A
        CFI CFA_SP SP+0
        MOVX    @DPTR,A
// 1158         len = 1;
        MOV     R6,#0x1
        SJMP    ??MT_ProcessSerialCommand_0
// 1159         break;
// 1160 
// 1161 #if !defined ( NONWK )
// 1162       case SPI_CMD_SYS_APP_MSG:
// 1163         ret = MTProcessAppMsg( pData, msg[2] );
??MT_ProcessSerialCommand_15:
        ; Setup parameters for call to function MTProcessAppMsg
        MOV     A,#0x7
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R2,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R3,A
        LCALL   ??MTProcessAppMsg?relay
        MOV     A,R1
        PUSH    A
        CFI CFA_SP SP+-1
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        POP     A
        CFI CFA_SP SP+0
        MOVX    @DPTR,A
// 1164         len = 0;
        MOV     R6,#0x0
        SJMP    ??MT_ProcessSerialCommand_0
// 1165         break;
// 1166 #endif // NONWK
// 1167 
// 1168       case SPI_CMD_SYS_LED_CONTROL:
// 1169 #if (defined HAL_LED) && (HAL_LED == TRUE)
// 1170         ret = MTProcessLedControl( pData );
??MT_ProcessSerialCommand_16:
        ; Setup parameters for call to function MTProcessLedControl
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R2,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R3,A
        LCALL   ??MTProcessLedControl?relay
        MOV     A,R1
        PUSH    A
        CFI CFA_SP SP+-1
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        POP     A
        CFI CFA_SP SP+0
        MOVX    @DPTR,A
// 1171         len = 1;
        MOV     R6,#0x1
// 1172 #endif
// 1173         break;
// 1174 
// 1175 #ifdef MT_MAC_FUNC
// 1176       case SPI_CMD_MAC_INIT:
// 1177       case SPI_CMD_MAC_ASSOCIATE_REQ:
// 1178       case SPI_CMD_MAC_ASSOCIATE_RSP:
// 1179       case SPI_CMD_MAC_DISASSOCIATE_REQ:
// 1180       case SPI_CMD_MAC_DATA_REQ:
// 1181       case SPI_CMD_MAC_GET_REQ:
// 1182       case SPI_CMD_MAC_SET_REQ:
// 1183       case SPI_CMD_MAC_START_REQ:
// 1184       case SPI_CMD_MAC_SCAN_REQ:
// 1185       case SPI_CMD_MAC_RESET_REQ:
// 1186       case SPI_CMD_MAC_GTS_REQ:
// 1187       case SPI_CMD_MAC_ORPHAN_RSP:
// 1188       case SPI_CMD_MAC_RX_ENABLE_REQ:
// 1189       case SPI_CMD_MAC_SYNC_REQ:
// 1190       case SPI_CMD_MAC_POLL_REQ:
// 1191       case SPI_CMD_MAC_PURGE_REQ:
// 1192         MT_MacCommandProcessing( cmd , len , pData );
// 1193         break;
// 1194 #endif
// 1195 
// 1196 #ifdef MT_NWK_FUNC
// 1197       case SPI_CMD_NWK_INIT:
// 1198       case SPI_CMD_NLDE_DATA_REQ:
// 1199       case SPI_CMD_NLME_INIT_COORD_REQ:
// 1200       case SPI_CMD_NLME_PERMIT_JOINING_REQ:
// 1201       case SPI_CMD_NLME_JOIN_REQ:
// 1202       case SPI_CMD_NLME_LEAVE_REQ:
// 1203       case SPI_CMD_NLME_RESET_REQ:
// 1204       case SPI_CMD_NLME_RX_STATE_REQ:
// 1205       case SPI_CMD_NLME_GET_REQ:
// 1206       case SPI_CMD_NLME_SET_REQ:
// 1207       case SPI_CMD_NLME_NWK_DISC_REQ:
// 1208       case SPI_CMD_NLME_ROUTE_DISC_REQ:
// 1209       case SPI_CMD_NLME_DIRECT_JOIN_REQ:
// 1210       case SPI_CMD_NLME_ORPHAN_JOIN_REQ:
// 1211       case SPI_CMD_NLME_START_ROUTER_REQ:
// 1212         MT_NwkCommandProcessing( cmd , len , pData );
// 1213         break;
// 1214 #endif
// 1215 
// 1216 #ifdef MT_ZDO_FUNC
// 1217       case SPI_CMD_ZDO_AUTO_ENDDEVICEBIND_REQ:
// 1218       case SPI_CMD_ZDO_AUTO_FIND_DESTINATION_REQ:
// 1219       case SPI_CMD_ZDO_NWK_ADDR_REQ:
// 1220       case SPI_CMD_ZDO_IEEE_ADDR_REQ:
// 1221       case SPI_CMD_ZDO_NODE_DESC_REQ:
// 1222       case SPI_CMD_ZDO_POWER_DESC_REQ:
// 1223       case SPI_CMD_ZDO_SIMPLE_DESC_REQ:
// 1224       case SPI_CMD_ZDO_ACTIVE_EPINT_REQ:
// 1225       case SPI_CMD_ZDO_MATCH_DESC_REQ:
// 1226       case SPI_CMD_ZDO_COMPLEX_DESC_REQ:
// 1227       case SPI_CMD_ZDO_USER_DESC_REQ:
// 1228       case SPI_CMD_ZDO_END_DEV_BIND_REQ:
// 1229       case SPI_CMD_ZDO_BIND_REQ:
// 1230       case SPI_CMD_ZDO_UNBIND_REQ:
// 1231       case SPI_CMD_ZDO_MGMT_NWKDISC_REQ:
// 1232       case SPI_CMD_ZDO_MGMT_LQI_REQ:
// 1233       case SPI_CMD_ZDO_MGMT_RTG_REQ:
// 1234       case SPI_CMD_ZDO_MGMT_BIND_REQ:
// 1235       case SPI_CMD_ZDO_MGMT_DIRECT_JOIN_REQ:
// 1236       case SPI_CMD_ZDO_USER_DESC_SET:
// 1237       case SPI_CMD_ZDO_END_DEV_ANNCE:
// 1238       case SPI_CMD_ZDO_MGMT_LEAVE_REQ:
// 1239       case SPI_CMD_ZDO_MGMT_PERMIT_JOIN_REQ:
// 1240       case SPI_CMD_ZDO_SERVERDISC_REQ:
// 1241       case SPI_CMD_ZDO_NETWORK_START_REQ:
// 1242         MT_ZdoCommandProcessing( cmd , len , pData );
// 1243         break;
// 1244 #endif
// 1245 
// 1246 #if defined ( MT_AF_FUNC )
// 1247       case SPI_CMD_AF_INIT:
// 1248       case SPI_CMD_AF_REGISTER:
// 1249       case SPI_CMD_AF_SENDMSG:
// 1250         MT_afCommandProcessing( cmd , len , pData );
// 1251         break;
// 1252 #endif
// 1253 
// 1254 #if defined ( MT_SAPI_FUNC )
// 1255       case SPI_CMD_SAPI_SYS_RESET:
// 1256       case SPI_CMD_SAPI_START_REQ:
// 1257       case SPI_CMD_SAPI_BIND_DEVICE:
// 1258       case SPI_CMD_SAPI_ALLOW_BIND:
// 1259       case SPI_CMD_SAPI_SEND_DATA:
// 1260       case SPI_CMD_SAPI_READ_CFG:
// 1261       case SPI_CMD_SAPI_WRITE_CFG:
// 1262       case SPI_CMD_SAPI_GET_DEV_INFO:
// 1263       case SPI_CMD_SAPI_FIND_DEV:
// 1264       case SPI_CMD_SAPI_PMT_JOIN:
// 1265         ret = MT_sapiCommandProcessing( cmd , len , pData );
// 1266         if ( ret == 0xff )
// 1267           len = 0;
// 1268         else
// 1269           len = 1;
// 1270         break;
// 1271 #endif
// 1272 
// 1273 #if defined ( MT_USER_TEST_FUNC )
// 1274       case SPI_CMD_USER_TEST:
// 1275         MT_ProcessAppUserCmd( pData );
// 1276         break;
// 1277 #endif
// 1278 
// 1279       default:
// 1280         break;
// 1281     }
// 1282 
// 1283     if ( len )
??MT_ProcessSerialCommand_0:
        MOV     A,R6
        JZ      ??MT_ProcessSerialCommand_32
// 1284     {
// 1285       MT_BuildAndSendZToolResponse( (SPI_0DATA_MSG_LEN + len),
// 1286                                     (SPI_RESPONSE_BIT | cmd),
// 1287                                     len, retValue );
        ; Setup parameters for call to function MT_BuildAndSendZToolResponse
        MOV     A,#0x5
        LCALL   ?XSTACK_DISP0_8
        LCALL   ?PUSH_XSTACK8_X_TWO
        CFI CFA_XSP16 add(XSP16, 45)
        MOV     A,R6
        MOV     R4,A
        MOV     A,#0xd
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        ORL     A,#0x0
        MOV     R2,A
        INC     DPTR
        MOVX    A,@DPTR
        ORL     A,#0x10
        MOV     R3,A
        MOV     A,#0x5
        ADD     A,R6
        MOV     R1,A
        LCALL   ??MT_BuildAndSendZToolResponse?relay
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 43)
// 1288     }
// 1289   }
??MT_ProcessSerialCommand_32:
        MOV     A,#0x1b
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 16)
        MOV     R7,#0x8
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock13
// 1290 #endif // ZTOOL
// 1291 
// 1292 #if (defined HAL_LED) && (HAL_LED == TRUE)
// 1293 /***************************************************************************************************
// 1294  * @fn      MTProcessLedControl
// 1295  *
// 1296  * @brief
// 1297  *
// 1298  *   Process the LED Control Message
// 1299  *
// 1300  * @param   data - input serial buffer
// 1301  *
// 1302  * @return  status
// 1303  ***************************************************************************************************/

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1304 byte MTProcessLedControl( byte *pData )
MTProcessLedControl:
        CFI Block cfiBlock14 Using cfiCommon0
        CFI Function MTProcessLedControl
// 1305 {
        FUNCALL MTProcessLedControl, HalLedSet
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 12, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 12, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xc
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 12)
        ; Saved register size: 12
        ; Auto size: 0
        MOV     A,R2
        MOV     R6,A
        MOV     A,R3
        MOV     R7,A
// 1306   byte iLed;
// 1307   byte Led;
// 1308   byte iMode;
// 1309   byte Mode;
// 1310 
// 1311   iLed = *pData++;
        MOV     DPL,R6
        MOV     DPH,R7
        MOVX    A,@DPTR
        MOV     ?V0 + 0,A
        MOV     DPL,R6
        MOV     DPH,R7
        INC     DPTR
        MOV     R6,DPL
        MOV     R7,DPH
// 1312   iMode = *pData;
        MOV     DPL,R6
        MOV     DPH,R7
        MOVX    A,@DPTR
        MOV     ?V0 + 2,A
// 1313 
// 1314   if ( iLed == 1 )
        MOV     A,#0x1
        XRL     A,?V0 + 0
        JNZ     ??MTProcessLedControl_0
// 1315     Led = HAL_LED_1;
        MOV     ?V0 + 1,#0x1
        SJMP    ??MTProcessLedControl_1
// 1316   else if ( iLed == 2 )
??MTProcessLedControl_0:
        MOV     A,#0x2
        XRL     A,?V0 + 0
        JNZ     ??MTProcessLedControl_2
// 1317     Led = HAL_LED_2;
        MOV     ?V0 + 1,#0x2
        SJMP    ??MTProcessLedControl_1
// 1318   else if ( iLed == 3 )
??MTProcessLedControl_2:
        MOV     A,#0x3
        XRL     A,?V0 + 0
        JNZ     ??MTProcessLedControl_3
// 1319     Led = HAL_LED_3;
        MOV     ?V0 + 1,#0x4
        SJMP    ??MTProcessLedControl_1
// 1320   else if ( iLed == 4 )
??MTProcessLedControl_3:
        MOV     A,#0x4
        XRL     A,?V0 + 0
        JNZ     ??MTProcessLedControl_4
// 1321     Led = HAL_LED_4;
        MOV     ?V0 + 1,#0x8
        SJMP    ??MTProcessLedControl_1
// 1322   else if ( iLed == 0xFF )
??MTProcessLedControl_4:
        MOV     A,#-0x1
        XRL     A,?V0 + 0
        JNZ     ??MTProcessLedControl_5
// 1323     Led = HAL_LED_ALL;
        MOV     ?V0 + 1,#0xf
        SJMP    ??MTProcessLedControl_1
// 1324   else
// 1325     Led = 0;
??MTProcessLedControl_5:
        MOV     ?V0 + 1,#0x0
// 1326 
// 1327   if ( iMode == 0 )
??MTProcessLedControl_1:
        MOV     A,?V0 + 2
        JNZ     ??MTProcessLedControl_6
// 1328     Mode = HAL_LED_MODE_OFF;
        MOV     ?V0 + 3,#0x0
        SJMP    ??MTProcessLedControl_7
// 1329   else if ( iMode == 1 )
??MTProcessLedControl_6:
        MOV     A,#0x1
        XRL     A,?V0 + 2
        JNZ     ??MTProcessLedControl_8
// 1330     Mode = HAL_LED_MODE_ON;
        MOV     ?V0 + 3,#0x1
        SJMP    ??MTProcessLedControl_7
// 1331   else if ( iMode == 2 )
??MTProcessLedControl_8:
        MOV     A,#0x2
        XRL     A,?V0 + 2
        JNZ     ??MTProcessLedControl_9
// 1332     Mode = HAL_LED_MODE_BLINK;
        MOV     ?V0 + 3,#0x2
        SJMP    ??MTProcessLedControl_7
// 1333   else if ( iMode == 3 )
??MTProcessLedControl_9:
        MOV     A,#0x3
        XRL     A,?V0 + 2
        JNZ     ??MTProcessLedControl_10
// 1334     Mode = HAL_LED_MODE_FLASH;
        MOV     ?V0 + 3,#0x4
        SJMP    ??MTProcessLedControl_7
// 1335   else if ( iMode == 4 )
??MTProcessLedControl_10:
        MOV     A,#0x4
        XRL     A,?V0 + 2
        JNZ     ??MTProcessLedControl_11
// 1336     Mode = HAL_LED_MODE_TOGGLE;
        MOV     ?V0 + 3,#0x8
        SJMP    ??MTProcessLedControl_7
// 1337   else
// 1338     Led = 0;
??MTProcessLedControl_11:
        MOV     ?V0 + 1,#0x0
// 1339 
// 1340   if ( Led != 0 )
??MTProcessLedControl_7:
        MOV     A,?V0 + 1
        JZ      ??MTProcessLedControl_12
// 1341   {
// 1342     HalLedSet (Led, Mode );
        ; Setup parameters for call to function HalLedSet
        MOV     R2,?V0 + 3
        MOV     R1,?V0 + 1
        LCALL   ??HalLedSet?relay
// 1343     return ( ZSuccess );
        MOV     R1,#0x0
        SJMP    ??MTProcessLedControl_13
// 1344   }
// 1345   else
// 1346     return ( ZFailure );
??MTProcessLedControl_12:
        MOV     R1,#0x1
??MTProcessLedControl_13:
        MOV     R7,#0x4
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock14
// 1347 }
// 1348 #endif // HAL_LED
// 1349 
// 1350 #if !defined ( NONWK )
// 1351 /*********************************************************************
// 1352  * @fn      MTProcessAppMsg
// 1353  *
// 1354  * @brief
// 1355  *
// 1356  *   Process the User App Message
// 1357  *
// 1358  * @param   data - input serial buffer
// 1359  * @param   len - data length
// 1360  *
// 1361  * @return  status
// 1362  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1363 byte MTProcessAppMsg( byte *pData, byte len )
MTProcessAppMsg:
        CFI Block cfiBlock15 Using cfiCommon0
        CFI Function MTProcessAppMsg
// 1364 {
        FUNCALL MTProcessAppMsg, afFindEndPointDesc
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 18, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MTProcessAppMsg, osal_msg_allocate
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 18, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MTProcessAppMsg, osal_memcpy
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 21, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 21, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MTProcessAppMsg, osal_msg_send
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 18, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x10
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-11)))
        CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-12)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-13)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-14)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-15)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-16)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 16)
        ; Saved register size: 16
        ; Auto size: 2
        MOV     A,#-0x2
        LCALL   ?ALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 18)
        MOV     ?V0 + 6,R2
        MOV     ?V0 + 7,R3
        MOV     A,R1
        MOV     R6,A
// 1365   byte ret = ZFailure;
        MOV     R7,#0x1
// 1366   byte endpoint;
// 1367   endPointDesc_t *epDesc;
// 1368   mtSysAppMsg_t *msg;
// 1369 
// 1370   // Get the endpoint and skip past it.
// 1371   endpoint = *pData++;
        MOV     DPL,?V0 + 6
        MOV     DPH,?V0 + 7
        MOVX    A,@DPTR
        MOV     ?V0 + 3,A
        MOV     DPL,?V0 + 6
        MOV     DPH,?V0 + 7
        INC     DPTR
        MOV     ?V0 + 6,DPL
        MOV     ?V0 + 7,DPH
// 1372   len--;
        DEC     R6
// 1373 
// 1374   // Look up the endpoint
// 1375   epDesc = afFindEndPointDesc( endpoint );
        ; Setup parameters for call to function afFindEndPointDesc
        MOV     R1,?V0 + 3
        LCALL   ??afFindEndPointDesc?relay
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     A,R2
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R3
        MOVX    @DPTR,A
// 1376 
// 1377   if ( epDesc )
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        XRL     A,#0x0
        JNZ     ??MTProcessAppMsg_0
        INC     DPTR
        MOVX    A,@DPTR
        XRL     A,#0x0
??MTProcessAppMsg_0:
        JNZ     $+5
        LJMP    ??MTProcessAppMsg_1 & 0xFFFF
// 1378   {
// 1379     // Build and send the message to the APP
// 1380     msg = (mtSysAppMsg_t *)osal_msg_allocate( sizeof( mtSysAppMsg_t ) + len );
        ; Setup parameters for call to function osal_msg_allocate
        MOV     ?V0 + 0,R6
        MOV     ?V0 + 1,#0x0
        MOV     A,#0x6
        ADD     A,?V0 + 0
        MOV     R2,A
        MOV     A,#0x0
        ADDC    A,?V0 + 1
        MOV     R3,A
        LCALL   ??osal_msg_allocate?relay
        MOV     ?V0 + 0,R2
        MOV     ?V0 + 1,R3
        MOV     ?V0 + 4,?V0 + 0
        MOV     ?V0 + 5,?V0 + 1
// 1381     if ( msg )
        MOV     A,?V0 + 4
        XRL     A,#0x0
        JNZ     ??MTProcessAppMsg_2
        MOV     A,?V0 + 5
        XRL     A,#0x0
??MTProcessAppMsg_2:
        JNZ     $+5
        LJMP    ??MTProcessAppMsg_1 & 0xFFFF
// 1382     {
// 1383       msg->hdr.event = MT_SYS_APP_MSG;
        MOV     A,#0x23
        MOV     DPL,?V0 + 4
        MOV     DPH,?V0 + 5
        MOVX    @DPTR,A
// 1384       msg->endpoint = endpoint;
        MOV     DPL,?V0 + 4
        MOV     DPH,?V0 + 5
        INC     DPTR
        INC     DPTR
        MOV     A,?V0 + 3
        MOVX    @DPTR,A
// 1385       msg->appDataLen = len;
        MOV     A,R6
        MOV     DPL,?V0 + 4
        MOV     DPH,?V0 + 5
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    @DPTR,A
// 1386       msg->appData = (uint8*)(msg+1);
        MOV     A,?V0 + 4
        ADD     A,#0x6
        MOV     R0,A
        MOV     A,?V0 + 5
        ADDC    A,#0x0
        MOV     R1,A
        MOV     DPL,?V0 + 4
        MOV     DPH,?V0 + 5
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOV     A,R0
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R1
        MOVX    @DPTR,A
// 1387 
// 1388       osal_memcpy( msg->appData, pData, len );
        ; Setup parameters for call to function osal_memcpy
        MOV     ?V0 + 0,?V0 + 6
        MOV     ?V0 + 1,?V0 + 7
        MOV     ?V0 + 2,#0x0
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_THREE
        CFI CFA_XSP16 add(XSP16, 21)
        MOV     A,R6
        MOV     ?V0 + 0,A
        MOV     R4,?V0 + 0
        MOV     R5,#0x0
        MOV     DPL,?V0 + 4
        MOV     DPH,?V0 + 5
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R2,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R3,A
        LCALL   ??osal_memcpy?relay
        MOV     A,#0x3
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 18)
// 1389 
// 1390       osal_msg_send( *(epDesc->task_id), (uint8 *)msg );
        ; Setup parameters for call to function osal_msg_send
        MOV     R2,?V0 + 4
        MOV     R3,?V0 + 5
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        MOVX    A,@DPTR
        MOV     R1,A
        LCALL   ??osal_msg_send?relay
// 1391 
// 1392       ret = ZSuccess;
        MOV     R7,#0x0
// 1393     }
// 1394   }
// 1395 
// 1396   return ret;
??MTProcessAppMsg_1:
        MOV     A,R7
        MOV     R1,A
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 16)
        MOV     R7,#0x8
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock15
// 1397 }
// 1398 #endif // NONWK
// 1399 
// 1400 #if defined ( ZTOOL_PORT )
// 1401 /*********************************************************************
// 1402  * @fn      MTProcessAppRspMsg
// 1403  *
// 1404  * @brief
// 1405  *
// 1406  *   Process the User App Response Message
// 1407  *
// 1408  * @param   data - output serial buffer.  The first byte must be the
// 1409  *          endpoint that send this message.
// 1410  * @param   len - data length
// 1411  *
// 1412  * @return  none
// 1413  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1414 void MTProcessAppRspMsg( byte *pData, byte len )
MTProcessAppRspMsg:
        CFI Block cfiBlock16 Using cfiCommon0
        CFI Function MTProcessAppRspMsg
// 1415 {
        FUNCALL MTProcessAppRspMsg, MT_BuildAndSendZToolResponse
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 12, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 12, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xa
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 0
        MOV     ?V0 + 0,R2
        MOV     ?V0 + 1,R3
        MOV     A,R1
        MOV     R6,A
// 1416   // Send out Reset Response message
// 1417   MT_BuildAndSendZToolResponse( (SPI_0DATA_MSG_LEN + len),
// 1418                                 (SPI_RESPONSE_BIT | SPI_CMD_SYS_APP_MSG),
// 1419                                 len, pData );
        ; Setup parameters for call to function MT_BuildAndSendZToolResponse
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 12)
        MOV     A,R6
        MOV     R4,A
        MOV     R2,#0x18
        MOV     R3,#0x10
        MOV     A,#0x5
        ADD     A,R6
        MOV     R1,A
        LCALL   ??MT_BuildAndSendZToolResponse?relay
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 10)
// 1420 }
        MOV     R7,#0x2
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock16
// 1421 #endif // ZTOOL_PORT
// 1422 
// 1423 
// 1424 #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
// 1425 #if defined ( MT_USER_TEST_FUNC )
// 1426 /*********************************************************************
// 1427  * @fn      MT_ProcessAppUserCmd
// 1428  *
// 1429  * @brief
// 1430  *
// 1431  *   Temp function for testing
// 1432  *
// 1433  * @param   data - received message
// 1434  *
// 1435  * @return  void
// 1436  */
// 1437 void MT_ProcessAppUserCmd( byte *pData) 						
// 1438 {
// 1439   uint16 app_cmd;
// 1440   byte srcEp;
// 1441   uint16 param1;
// 1442   uint16 param2;
// 1443   byte len;
// 1444   uint16 ret;
// 1445 
// 1446   ret = INVALID_TASK;     //should be changed later
// 1447 
// 1448   srcEp = *pData++;
// 1449 
// 1450   app_cmd = BUILD_UINT16( pData[1] , pData[0] );
// 1451   pData = pData + sizeof( uint16 );
// 1452 
// 1453   param1 = BUILD_UINT16( pData[1] , pData[0] );
// 1454   pData = pData + sizeof( uint16 );
// 1455 
// 1456   param2 = BUILD_UINT16( pData[1] , pData[0] );
// 1457 
// 1458   len = SPI_RESP_MSG_LEN_DEFAULT;
// 1459 
// 1460 
// 1461   switch ( app_cmd )
// 1462   {
// 1463 
// 1464 #if defined (APP_TGEN)
// 1465     case TGEN_START:
// 1466       TrafficGenApp_SendCmdMSG( param1, param2, TRAFFICGENAPP_CMD_START );
// 1467       ret = ZSUCCESS;
// 1468       break;
// 1469 
// 1470     case TGEN_STOP:
// 1471       TrafficGenApp_SendCmdMSG( param1, param2, TRAFFICGENAPP_CMD_STOP );
// 1472       ret = ZSUCCESS;
// 1473       break;
// 1474 
// 1475     case TGEN_COUNT:
// 1476       ret = TrafficGenApp_CountPkt( param1, param2 );
// 1477       return;		// so that spi_resp is not sent...
// 1478       //ret = ZSUCCESS;
// 1479       break;				
// 1480 #endif
// 1481 
// 1482 #if defined (NWK_TEST)
// 1483     case HW_TEST:
// 1484       HwApp_Start( HI_UINT16(param1), LO_UINT16(param1), HI_UINT16(param2),
// 1485                     1000, LO_UINT16(param2), 3, 0 );
// 1486       break;
// 1487 
// 1488     case HW_DISPLAY_RESULT:
// 1489       HwApp_TestInfo();
// 1490       break;
// 1491 
// 1492     case HW_SEND_STATUS:
// 1493       HwApp_SendStats();
// 1494       break;
// 1495 #endif
// 1496 
// 1497 #if defined( APP_TP ) || defined ( APP_TP2 )
// 1498   #if defined( APP_TP )
// 1499     case TP_SEND_NODATA:
// 1500       ret = TestProfileApp_SendNoData( srcEp, (byte)param1 );
// 1501       break;
// 1502   #endif // APP_TP
// 1503 			
// 1504     case TP_SEND_BUFFERTEST:
// 1505       ret = TestProfileApp_SendBufferReq( srcEp, (byte)param1 );
// 1506       break;
// 1507 			
// 1508   #if defined( APP_TP )
// 1509     case TP_SEND_UINT8:
// 1510       ret = TestProfileApp_SendUint8( srcEp, (byte)param1 );
// 1511       break;
// 1512 
// 1513     case TP_SEND_INT8:
// 1514       ret = TestProfileApp_SendInt8( srcEp, (byte)param1 );
// 1515       break;
// 1516 
// 1517     case TP_SEND_UINT16:
// 1518       ret = TestProfileApp_SendUint16( srcEp, (byte)param1 );
// 1519       break;
// 1520 
// 1521     case TP_SEND_INT16:
// 1522       ret = TestProfileApp_SendInt16( srcEp, (byte)param1 );
// 1523       break;
// 1524 
// 1525     case TP_SEND_SEMIPREC:
// 1526       ret = TestProfileApp_SendSemiPrec( srcEp, (byte)param1 );
// 1527       break;
// 1528 
// 1529     case TP_SEND_FREEFORM:
// 1530       ret = TestProfileApp_SendFreeFormReq( srcEp, (byte)param1 );
// 1531       break;
// 1532 			
// 1533   #else // APP_TP
// 1534     case TP_SEND_FREEFORM:
// 1535       ret = TestProfileApp_SendFreeFormReq(srcEp, (byte)param1, (byte)param2);
// 1536       break;
// 1537   #endif
// 1538 			
// 1539   #if defined( APP_TP )
// 1540     case TP_SEND_ABS_TIME:
// 1541       ret = TestProfileApp_SendAbsTime( srcEp, (byte)param1 );
// 1542       break;
// 1543 
// 1544     case TP_SEND_REL_TIME:
// 1545       ret = TestProfileApp_SendRelativeTime( srcEp, (byte)param1 );
// 1546       break;
// 1547 
// 1548     case TP_SEND_CHAR_STRING:
// 1549       ret = TestProfileApp_SendCharString( srcEp, (byte)param1 );
// 1550       break;
// 1551 
// 1552     case TP_SEND_OCTET_STRING:
// 1553       ret = TestProfileApp_SendOctetString( srcEp, (byte)param1 );
// 1554       break;		
// 1555   #endif // APP_TP
// 1556 				
// 1557     case TP_SET_DSTADDRESS:			
// 1558       ret = TestProfileApp_SetDestAddress(HI_UINT16(param1), LO_UINT16(param1), param2);
// 1559       break;	
// 1560 
// 1561   #if defined( APP_TP2 )
// 1562     case TP_SEND_BUFFER_GROUP:
// 1563       ret = TestProfileApp_SendBufferGroup( srcEp, (byte)param1 );
// 1564       break;
// 1565   #endif // APP_TP
// 1566 
// 1567     case TP_SEND_BUFFER:
// 1568       ret = TestProfileApp_SendBuffer( srcEp, (byte)param1 );
// 1569       break;
// 1570 				
// 1571   #if defined( APP_TP )
// 1572     case TP_SEND_MULT_KVP_8BIT:
// 1573       TestProfileApp_SendMultiKVP_8bit( srcEp, (byte)param1 );
// 1574       ret = ZSuccess;
// 1575       break;
// 1576 
// 1577     case TP_SEND_MULT_KVP_16BIT:
// 1578       TestProfileApp_SendMultiKVP_16bit( srcEp, (byte)param1 );
// 1579       ret = ZSuccess;
// 1580       break;
// 1581 
// 1582     case TP_SEND_MULT_KVP_TIME:
// 1583       TestProfileApp_SendMultiKVP_Time( srcEp, (byte)param1 );
// 1584       ret = ZSuccess;
// 1585       break;
// 1586 
// 1587     case TP_SEND_MULT_KVP_STRING:
// 1588       TestProfileApp_SendMultiKVP_String( srcEp, (byte)param1 );
// 1589       ret = ZSuccess;
// 1590       break;
// 1591 
// 1592     case TP_SEND_MULTI_KVP_STR_TIME:
// 1593       ret = ZSuccess;
// 1594       TestProfileApp_SendMultiKVP_String_Time( srcEp, (byte)param1 );
// 1595       break;
// 1596   #endif // APP_TP
// 1597 				
// 1598     case TP_SEND_COUNTED_PKTS:
// 1599       TestProfileApp_SendCountedPktsReq(HI_UINT16(param1), LO_UINT16(param1), param2);
// 1600       ret = ZSuccess;
// 1601       break;
// 1602 
// 1603     case TP_SEND_RESET_COUNTER:
// 1604       TestProfileApp_CountedPakts_ResetCounterReq( (byte)param1 );
// 1605       ret = ZSuccess;
// 1606       break;
// 1607 
// 1608     case TP_SEND_GET_COUNTER:
// 1609       TestProfileApp_CountedPakts_GetCounterReq( srcEp, (byte)param1 );
// 1610       ret = ZSuccess;
// 1611       break;
// 1612 				
// 1613     case TP_SET_PERMIT_JOIN:
// 1614   #if defined ( RTR_NWK )
// 1615       NLME_PermitJoiningRequest( (byte)param1 );
// 1616       ret = ZSuccess;
// 1617   #else
// 1618       ret = ZFailure;
// 1619   #endif
// 1620       break;
// 1621 
// 1622   #if defined ( APP_TP2 )
// 1623     case TP_ADD_GROUP:
// 1624       ret = TestProfileApp_SetGroup( srcEp, param1 );
// 1625       break;
// 1626 
// 1627     case TP_REMOVE_GROUP:
// 1628       ret = TestProfileApp_RemoveGroup( srcEp, param1 );
// 1629       break;
// 1630 
// 1631     case TP_SEND_UPDATE_KEY:
// 1632       ret = TestProfileApp_UpdateKey( srcEp, (uint8)param1, param2 );
// 1633       break;
// 1634 
// 1635     case TP_SEND_SWITCH_KEY:
// 1636       ret = TestProfileApp_SwitchKey(  srcEp, (uint8)param1, param2 );
// 1637       break;
// 1638 			
// 1639     case TP_SEND_BUFFERTEST_GROUP:
// 1640       ret = TestProfileApp_SendBufferGroupReq( srcEp, (byte)param1 );
// 1641       break;
// 1642 
// 1643     case TP_SEND_ROUTE_DISC_REQ:
// 1644       ret = TestProfileApp_SendRouteDiscReq( srcEp, param1,
// 1645                                   HI_UINT16( param2 ), LO_UINT16( param2 ) );
// 1646       break;
// 1647 
// 1648     case TP_SEND_ROUTE_DISCOVERY:
// 1649 #if defined ( RTR_NWK )
// 1650       ret = TestProfileApp_SendRouteDiscovery( param1,
// 1651                                   HI_UINT16( param2 ), LO_UINT16( param2 ) );
// 1652 #endif
// 1653       break;
// 1654 
// 1655   #endif // APP_TP2
// 1656 
// 1657 #endif  // APP_TP || APP_TP2
// 1658 
// 1659 #if defined ( OSAL_TOTAL_MEM )
// 1660     case OSAL_MEM_STACK_HIGH_WATER:
// 1661     case OSAL_MEM_HEAP_HIGH_WATER:
// 1662       if ( app_cmd == OSAL_MEM_STACK_HIGH_WATER)
// 1663         param1 = osal_stack_used();
// 1664       else
// 1665         param1 = osal_heap_high_water();
// 1666       pData[0] = HI_UINT16( param1 );
// 1667       pData[1] = LO_UINT16( param1 );
// 1668 
// 1669       // The pData for this response will only send one byte,
// 1670       // so we are going to call it twice.
// 1671       //        MT_BuildAndSendZToolResponse( (SPI_0DATA_MSG_LEN + sizeof( uint16 )),
// 1672       //                                    (SPI_CMD_USER_TEST | SPI_RESPONSE_BIT),
// 1673       //                                    sizeof( uint16 ), pData );
// 1674       MT_SendSPIRespMsg( pData[0], SPI_CMD_USER_TEST, SPI_RESP_MSG_LEN_DEFAULT, 1);
// 1675       MT_SendSPIRespMsg( pData[1], SPI_CMD_USER_TEST, SPI_RESP_MSG_LEN_DEFAULT, 1);
// 1676       return;
// 1677 #endif
// 1678 
// 1679 #if defined ( APP_DEBUG )
// 1680     case DEBUG_GET:
// 1681       DebugApp_SendQuery( param1 );
// 1682       ret = ZSUCCESS;
// 1683       break;
// 1684 #endif
// 1685 
// 1686 #if defined ( APP_TP2 )
// 1687     case TP_SEND_BCAST_RSP:
// 1688       ret = TestProfileApp_SendBcastRsp( srcEp, (byte)param1 );
// 1689       break;
// 1690 #endif
// 1691 			
// 1692     default:
// 1693       break;
// 1694   }
// 1695 
// 1696   MT_SendSPIRespMsg( ( byte )ret, SPI_CMD_USER_TEST, len, 1);
// 1697 
// 1698 }
// 1699 #endif // MT_USER_TEST_FUNC
// 1700 #endif // ZTOOL
// 1701 
// 1702 #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
// 1703 /***************************************************************************************************
// 1704  * @fn      MT_RAMRead
// 1705  *
// 1706  * @brief
// 1707  *
// 1708  *   Process Serial Message.
// 1709  *
// 1710  * @param   UINT16 addr - address to read from
// 1711  * @param   pData - pointer to buffer to put read data
// 1712  *
// 1713  * @return  ZSuccess or ZFailure
// 1714  *
// 1715  * @MT SPI_CMD_SYS_RAM_READ
// 1716  *
// 1717  ***************************************************************************************************/

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1718 byte MT_RAMRead( UINT16 addr, byte *pData  )
MT_RAMRead:
        CFI Block cfiBlock17 Using cfiCommon0
        CFI Function MT_RAMRead
// 1719 {
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
// 1720   byte *pAddr;
// 1721 
// 1722   if ( IS_MEM_VALID( addr ) )
        CLR     C
        MOV     A,R2
        SUBB    A,#0x0
        MOV     A,R3
        SUBB    A,#-0x20
        JC      ??MT_RAMRead_0
        MOV     R0,#0x1
        MOV     R1,#0x0
        SJMP    ??MT_RAMRead_1
??MT_RAMRead_0:
        MOV     R0,#0x0
        MOV     R1,#0x0
??MT_RAMRead_1:
        MOV     A,#0x0
        XRL     A,R0
        JNZ     ??MT_RAMRead_2
        MOV     A,#0x0
        XRL     A,R1
??MT_RAMRead_2:
        JZ      ??MT_RAMRead_3
// 1723   {
// 1724     pAddr = (byte *)addr;
        MOV     A,R2
        MOV     R6,A
        MOV     A,R3
        MOV     R7,A
// 1725     *pData = *pAddr;
        MOV     DPL,R6
        MOV     DPH,R7
        MOVX    A,@DPTR
        MOV     DPL,R4
        MOV     DPH,R5
        MOVX    @DPTR,A
// 1726     return ( (byte)ZSuccess );
        MOV     R1,#0x0
        SJMP    ??MT_RAMRead_4
// 1727   }
// 1728   else
// 1729   {
// 1730     *pData = 0;
??MT_RAMRead_3:
        MOV     A,#0x0
        MOV     DPL,R4
        MOV     DPH,R5
        MOVX    @DPTR,A
// 1731     return ( (byte)ZFailure );
        MOV     R1,#0x1
??MT_RAMRead_4:
        MOV     R7,#0x1
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock17
// 1732   }
// 1733 }
// 1734 #endif
// 1735 
// 1736 #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
// 1737 /***************************************************************************************************
// 1738  * @fn      MT_RAMWrite
// 1739  *
// 1740  * @brief
// 1741  *
// 1742  *   Process Serial Message.
// 1743  *
// 1744  * @param   UINT16 addr - address to write at
// 1745  * @param   byte val  - values to fill in the above address and the next
// 1746  *
// 1747  * @return  ZSuccess or ZFailure
// 1748  *
// 1749  * @MT SPI_CMD_SYS_RAM_WRITE
// 1750  *
// 1751  ***************************************************************************************************/

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1752 byte MT_RAMWrite( UINT16 addr, byte val )
MT_RAMWrite:
        CFI Block cfiBlock18 Using cfiCommon0
        CFI Function MT_RAMWrite
// 1753 {
        PUSH    DPL
        CFI DPL0 Frame(CFA_SP, 4)
        CFI CFA_SP SP+-4
        PUSH    DPH
        CFI DPH0 Frame(CFA_SP, 5)
        CFI CFA_SP SP+-5
        ; Saved register size: 2
        ; Auto size: 0
        MOV     A,R1
        MOV     R4,A
// 1754   if ( IS_MEM_VALID( addr ) )
        CLR     C
        MOV     A,R2
        SUBB    A,#0x0
        MOV     A,R3
        SUBB    A,#-0x20
        JC      ??MT_RAMWrite_0
        MOV     R0,#0x1
        MOV     R1,#0x0
        SJMP    ??MT_RAMWrite_1
??MT_RAMWrite_0:
        MOV     R0,#0x0
        MOV     R1,#0x0
??MT_RAMWrite_1:
        MOV     A,#0x0
        XRL     A,R0
        JNZ     ??MT_RAMWrite_2
        MOV     A,#0x0
        XRL     A,R1
??MT_RAMWrite_2:
        JZ      ??MT_RAMWrite_3
// 1755   {
// 1756     *((byte*)(addr)) = val;
        MOV     A,R4
        MOV     DPL,R2
        MOV     DPH,R3
        MOVX    @DPTR,A
// 1757     return ( (byte)ZSuccess );
        MOV     R1,#0x0
        SJMP    ??MT_RAMWrite_4
// 1758   }
// 1759   else
// 1760     return ( (byte)ZFailure );
??MT_RAMWrite_3:
        MOV     R1,#0x1
??MT_RAMWrite_4:
        POP     DPH
        CFI DPH0 SameValue
        CFI CFA_SP SP+-4
        POP     DPL
        CFI DPL0 SameValue
        CFI CFA_SP SP+-3
        LJMP    ?BRET
        CFI EndBlock cfiBlock18
// 1761 }
// 1762 #endif
// 1763 
// 1764 #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
// 1765 /***************************************************************************************************
// 1766  * @fn      MT_SetDebugThreshold
// 1767  *
// 1768  * @brief
// 1769  *
// 1770  *   Set Debug Threshold for software components.
// 1771  *
// 1772  * @param   comp_id   - software component ID.
// 1773  * @param   threshold - threshold value for reporting debug messages.
// 1774  *
// 1775  * @return  ZSuccess
// 1776  *
// 1777  * @MT SPI_CMD_SYS_SET_DEBUG_THRESHOLD
// 1778  *
// 1779  ***************************************************************************************************/

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1780 byte MT_SetDebugThreshold( byte compID, byte threshold )
MT_SetDebugThreshold:
        CFI Block cfiBlock19 Using cfiCommon0
        CFI Function MT_SetDebugThreshold
// 1781 {
        PUSH    DPL
        CFI DPL0 Frame(CFA_SP, 4)
        CFI CFA_SP SP+-4
        PUSH    DPH
        CFI DPH0 Frame(CFA_SP, 5)
        CFI CFA_SP SP+-5
        ; Saved register size: 2
        ; Auto size: 0
        MOV     A,R1
        MOV     R3,A
// 1782   // *** RKJ - for now if we get any threshold message, set it on
// 1783   debugThreshold = threshold;
        MOV     A,R2
        MOV     DPTR,#debugThreshold
        MOVX    @DPTR,A
// 1784   debugCompId = compID;
        MOV     A,R3
        MOV     DPTR,#debugCompId
        MOVX    @DPTR,A
// 1785 
// 1786   return ( (byte)ZSuccess );
        MOV     R1,#0x0
        POP     DPH
        CFI DPH0 SameValue
        CFI CFA_SP SP+-4
        POP     DPL
        CFI DPL0 SameValue
        CFI CFA_SP SP+-3
        LJMP    ?BRET
        CFI EndBlock cfiBlock19
// 1787 }
// 1788 #endif
// 1789 
// 1790 /***************************************************************************************************
// 1791  * @fn      MT_Reset
// 1792  *
// 1793  * @brief
// 1794  *
// 1795  *   Reset/reprogram the device.
// 1796  *
// 1797  * @param   typID: 0=reset, 1=serial bootloader
// 1798  *
// 1799  * @return  void
// 1800  *
// 1801  * @MT SPI_CMD_SYS_RESET
// 1802  ***************************************************************************************************/

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1803 void MT_Reset( byte typID )
MT_Reset:
        CFI Block cfiBlock20 Using cfiCommon0
        CFI Function MT_Reset
// 1804 {
        MOV     A,#-0xc
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 12)
        ; Saved register size: 12
        ; Auto size: 0
// 1805   if ( typID )
        MOV     A,R1
        JZ      ??MT_Reset_0
// 1806   {
// 1807     // Jump to bootloader
// 1808     BootLoader();
        CLR     0xa8.7
        MOV     DPTR,#__Constant_53544159
        MOV     R0,#?V0 + 0
        LCALL   ?L_MOV_X
        MOV     DPTR,#-0x2000
        MOV     R0,#?V0 + 0
        LCALL   ?L_MOV_TO_X
        MOV     0xc9,#-0x55
        MOV     0xc9,#0x5b
??MT_Reset_1:
        NOP
        SJMP    ??MT_Reset_1
// 1809   }
// 1810   else
// 1811   {
// 1812     // Restart this program
// 1813     SystemReset();
??MT_Reset_0:
        CLR     0xa8.7
        MOV     0xc9,#-0x55
        MOV     0xc9,#0x5b
??MT_Reset_2:
        NOP
        SJMP    ??MT_Reset_2
        CFI EndBlock cfiBlock20
        REQUIRE _A_IEN0
        REQUIRE WDCTL
        REQUIRE mboxMsg
// 1814   }
// 1815 }
// 1816 
// 1817 #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
// 1818 /***************************************************************************************************
// 1819  * @fn      MT_SendErrorNotification
// 1820  *
// 1821  * @brief
// 1822  *
// 1823  *   Send Error Notofication Message to Test Tool.
// 1824  *
// 1825  * @param   byte err
// 1826  *
// 1827  * @return  void
// 1828  ***************************************************************************************************/

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1829 void MT_SendErrorNotification( byte err )
MT_SendErrorNotification:
        CFI Block cfiBlock21 Using cfiCommon0
        CFI Function MT_SendErrorNotification
// 1830 {
        FUNCALL MT_SendErrorNotification, MT_BuildAndSendZToolResponse
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 13, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 13, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xa
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 1
        MOV     A,#-0x1
        LCALL   ?ALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 11)
        MOV     A,R1
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    @DPTR,A
// 1831   MT_BuildAndSendZToolResponse( (SPI_0DATA_MSG_LEN + 1),
// 1832                               (SPI_RESPONSE_BIT | SPI_CMD_SYS_RAM_WRITE),
// 1833                               1, &err );
        ; Setup parameters for call to function MT_BuildAndSendZToolResponse
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 13)
        MOV     R4,#0x1
        MOV     R2,#0x2
        MOV     R3,#0x10
        MOV     R1,#0x6
        LCALL   ??MT_BuildAndSendZToolResponse?relay
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 11)
// 1834 }
        MOV     A,#0x1
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 10)
        MOV     R7,#0x2
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock21
// 1835 #endif
// 1836 
// 1837 /***************************************************************************************************
// 1838  * @fn      MT_ReverseBytes
// 1839  *
// 1840  * @brief
// 1841  *
// 1842  *   Reverses bytes within an array
// 1843  *
// 1844  * @param   data - ptr to data buffer to reverse
// 1845  * @param    len - number of bytes in buffer
// 1846  *
// 1847  * @return  void
// 1848  ***************************************************************************************************/

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1849 void MT_ReverseBytes( byte *pData, byte len )
MT_ReverseBytes:
        CFI Block cfiBlock22 Using cfiCommon0
        CFI Function MT_ReverseBytes
// 1850 {
        MOV     A,#-0xa
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 0
// 1851   byte i,j;
// 1852   byte temp;
// 1853 
// 1854   for ( i = 0, j = len-1; len > 1; len-=2 ) {
        MOV     R5,#0x0
        MOV     A,#-0x1
        ADD     A,R1
        MOV     R4,A
??MT_ReverseBytes_0:
        MOV     A,R1
        CLR     C
        SUBB    A,#0x2
        JC      ??MT_ReverseBytes_1
// 1855     temp = pData[i];
        MOV     ?V0 + 0,R5
        MOV     ?V0 + 1,#0x0
        MOV     A,R2
        ADD     A,?V0 + 0
        MOV     DPL,A
        MOV     A,R3
        ADDC    A,?V0 + 1
        MOV     DPH,A
        MOVX    A,@DPTR
        MOV     R6,A
// 1856     pData[i++] = pData[j];
        MOV     ?V0 + 0,R4
        MOV     ?V0 + 1,#0x0
        MOV     A,R2
        ADD     A,?V0 + 0
        MOV     DPL,A
        MOV     A,R3
        ADDC    A,?V0 + 1
        MOV     DPH,A
        MOVX    A,@DPTR
        PUSH    A
        CFI CFA_SP SP+-1
        MOV     ?V0 + 0,R5
        MOV     ?V0 + 1,#0x0
        MOV     A,R2
        ADD     A,?V0 + 0
        MOV     DPL,A
        MOV     A,R3
        ADDC    A,?V0 + 1
        MOV     DPH,A
        POP     A
        CFI CFA_SP SP+0
        MOVX    @DPTR,A
        INC     R5
// 1857     pData[j--] = temp;
        MOV     A,R6
        PUSH    A
        CFI CFA_SP SP+-1
        MOV     ?V0 + 0,R4
        MOV     ?V0 + 1,#0x0
        MOV     A,R2
        ADD     A,?V0 + 0
        MOV     DPL,A
        MOV     A,R3
        ADDC    A,?V0 + 1
        MOV     DPH,A
        POP     A
        CFI CFA_SP SP+0
        MOVX    @DPTR,A
        DEC     R4
// 1858   }
        DEC     R1
        DEC     R1
        SJMP    ??MT_ReverseBytes_0
// 1859 }
??MT_ReverseBytes_1:
        MOV     R7,#0x2
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock22
// 1860 
// 1861 /***************************************************************************************************
// 1862  * @fn      MT_SendSPIRespMsg
// 1863  *
// 1864  * @brief
// 1865  *
// 1866  *   This function is used to process messages in the queue
// 1867  *
// 1868  * @param   none
// 1869  *
// 1870  * @return  void
// 1871  ***************************************************************************************************/

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1872 void MT_SendSPIRespMsg( byte ret, uint16 cmd_id, byte msgLen, byte respLen)
MT_SendSPIRespMsg:
        CFI Block cfiBlock23 Using cfiCommon0
        CFI Function MT_SendSPIRespMsg
// 1873 {
        FUNCALL MT_SendSPIRespMsg, osal_mem_alloc
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 15, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 15, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_SendSPIRespMsg, MT_BuildSPIMsg
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 17, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 17, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_SendSPIRespMsg, HalUARTWrite
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 15, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 15, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL MT_SendSPIRespMsg, osal_mem_free
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 15, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 15, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xe
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-11)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-12)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-13)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-14)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 14)
        ; Saved register size: 14
        ; Auto size: 1
        MOV     A,#-0x1
        LCALL   ?ALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 15)
        MOV     A,R1
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    @DPTR,A
        MOV     ?V0 + 4,R2
        MOV     ?V0 + 5,R3
        MOV     ?V0 + 1,R4
        MOV     ?V0 + 0,R5
// 1874   byte *msgPtr;
// 1875 
// 1876   msgPtr = osal_mem_alloc( msgLen );
        ; Setup parameters for call to function osal_mem_alloc
        MOV     A,?V0 + 1
        MOV     ?V0 + 2,A
        MOV     R2,?V0 + 2
        MOV     R3,#0x0
        LCALL   ??osal_mem_alloc?relay
        MOV     ?V0 + 2,R2
        MOV     ?V0 + 3,R3
        MOV     R6,?V0 + 2
        MOV     R7,?V0 + 3
// 1877   if ( msgPtr )
        MOV     A,R6
        XRL     A,#0x0
        JNZ     ??MT_SendSPIRespMsg_0
        MOV     A,R7
        XRL     A,#0x0
??MT_SendSPIRespMsg_0:
        JZ      ??MT_SendSPIRespMsg_1
// 1878   {
// 1879 #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
// 1880     MT_BuildSPIMsg( (SPI_RESPONSE_BIT | cmd_id), msgPtr, respLen, &ret );
        ; Setup parameters for call to function MT_BuildSPIMsg
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     ?V0 + 2,DPL
        MOV     ?V0 + 3,DPH
        MOV     R0,#?V0 + 2
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 17)
        MOV     R1,?V0 + 0
        MOV     A,R6
        MOV     R4,A
        MOV     A,R7
        MOV     R5,A
        MOV     A,#0x0
        ORL     A,?V0 + 4
        MOV     R2,A
        MOV     A,#0x10
        ORL     A,?V0 + 5
        MOV     R3,A
        LCALL   ??MT_BuildSPIMsg?relay
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 15)
// 1881     HalUARTWrite ( SPI_MGR_DEFAULT_PORT, msgPtr, msgLen );
        ; Setup parameters for call to function HalUARTWrite
        MOV     A,?V0 + 1
        MOV     ?V0 + 2,A
        MOV     R4,?V0 + 2
        MOV     R5,#0x0
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        MOV     R1,#0x0
        LCALL   ??HalUARTWrite?relay
// 1882 #endif
// 1883 
// 1884     osal_mem_free( msgPtr );
        ; Setup parameters for call to function osal_mem_free
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??osal_mem_free?relay
// 1885   }
// 1886 }
??MT_SendSPIRespMsg_1:
        MOV     A,#0x1
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 14)
        MOV     R7,#0x6
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock23

        RSEG XDATA_ID:CODE:NOROOT(0)
        DATA
`?<Initializer for <Constant "1.00 (F8W1.4.3)">`:
        DB "1.00 (F8W1.4.3)"

        RSEG XDATA_ID:CODE:NOROOT(0)
        DATA
`?<Initializer for <Constant "1.10 (F8W1.4.3)">`:
        DB "1.10 (F8W1.4.3)"

        RSEG XDATA_ID:CODE:NOROOT(0)
        DATA
`?<Initializer for MTVersionString>`:
        DW `?<Constant "1.00 (F8W1.4.3)">`, `?<Constant "1.10 (F8W1.4.3)">`

        RSEG XDATA_ID:CODE:NOROOT(0)
        DATA
`?<Initializer for __Constant_3e8>`:
        DD 1000

        RSEG XDATA_ID:CODE:NOROOT(0)
        DATA
`?<Initializer for __Constant_53544159>`:
        DD 1398030681

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??MT_TaskInit?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    MT_TaskInit

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??MT_IndReset?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    MT_IndReset

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??MT_ProcessEvent?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    MT_ProcessEvent

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??MT_BuildSPIMsg?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    MT_BuildSPIMsg

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??MT_BuildAndSendZToolResponse?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    MT_BuildAndSendZToolResponse

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??MT_BuildAndSendZToolCB?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    MT_BuildAndSendZToolCB

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??MT_ProcessCommand?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    MT_ProcessCommand

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??MT_ProcessDebugMsg?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    MT_ProcessDebugMsg

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??MT_ProcessDebugStr?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    MT_ProcessDebugStr

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??MT_ProcessSetNV?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    MT_ProcessSetNV

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??MT_ProcessGetNV?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    MT_ProcessGetNV

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??MT_ProcessGetNvInfo?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    MT_ProcessGetNvInfo

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??MT_ProcessGetDeviceInfo?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    MT_ProcessGetDeviceInfo

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??MT_ProcessSerialCommand?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    MT_ProcessSerialCommand

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??MTProcessLedControl?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    MTProcessLedControl

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??MTProcessAppMsg?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    MTProcessAppMsg

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??MTProcessAppRspMsg?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    MTProcessAppRspMsg

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??MT_RAMRead?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    MT_RAMRead

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??MT_RAMWrite?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    MT_RAMWrite

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??MT_SetDebugThreshold?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    MT_SetDebugThreshold

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??MT_Reset?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    MT_Reset

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??MT_SendErrorNotification?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    MT_SendErrorNotification

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??MT_ReverseBytes?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    MT_ReverseBytes

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??MT_SendSPIRespMsg?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    MT_SendSPIRespMsg

        END
// 1887 
// 1888 #endif  // MT_TASK
// 1889 
// 1890 /***************************************************************************************************
// 1891 ***************************************************************************************************/
// 
// 5 886 bytes in segment BANKED_CODE
//   144 bytes in segment BANK_RELAYS
//     2 bytes in segment SFR_AN
//     8 bytes in segment XDATA_AN
//    44 bytes in segment XDATA_I
//    44 bytes in segment XDATA_ID
//    13 bytes in segment XDATA_Z
// 
// 6 066 bytes of CODE  memory (+  8 bytes shared)
//     0 bytes of DATA  memory (+  2 bytes shared)
//    49 bytes of XDATA memory (+ 16 bytes shared)
//
//Errors: none
//Warnings: none
