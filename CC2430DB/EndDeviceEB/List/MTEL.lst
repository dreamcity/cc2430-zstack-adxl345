###############################################################################
#                                                                             #
# IAR 8051 C/C++ Compiler V7.30B/W32                    10/Mar/2013  13:19:54 #
# Copyright 2004-2007 IAR Systems. All rights reserved.                       #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data                                               #
#    Dptr setup         =  1,16                                               #
#    Source file        =  C:\Texas Instruments\ZStack-1.4.3-1.2.1\Components #
#                          \mt\MTEL.c                                         #
#    Command line       =  -f "C:\Texas Instruments\ZStack-1.4.3-1.2.1\Projec #
#                          ts\zstack\Samples\cc2430-zstack-adxl345\CC2430DB\. #
#                          .\..\..\Tools\CC2430DB\f8wEndev.cfg" (-DCPU32MHZ   #
#                          -DFORCE_MAC_NEAR -DROOT=__near_func                #
#                          -DMAC_OPT_FFD=0 -DBLINK_LEDS "-DCONST=const        #
#                          __code" -DGENERIC=__generic) -f "C:\Texas          #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\Tools #
#                          \CC2430DB\f8wConfig.cfg" (-DSECURE=0               #
#                          -DDEFAULT_CHANLIST=0x00000800                      #
#                          -DZDAPP_CONFIG_PAN_ID=0xFFFF                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7             #
#                          -DMAX_RREQ_ENTRIES=10 -DAPSC_MAX_FRAME_RETRIES=3   #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=20           #
#                          -DNWK_MAX_BINDING_ENTRIES=10                       #
#                          -DMAX_BINDING_CLUSTER_IDS=5 "-DDEFAULT_KEY={0x01,  #
#                          0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00,    #
#                          0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"         #
#                          -DRFD_RCVC_ALWAYS_ON=FALSE -DPOLL_RATE=1000        #
#                          -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=100)   #
#                          -DREJOIN_POLL_RATE=440 "C:\Texas                   #
#                          Instruments\ZStack-1.4.3-1.2.1\Components\mt\MTEL. #
#                          c" -D CC2430EB -D AXD_END -D NWK_AUTO_POLL -D      #
#                          REFLECTOR -D ZTOOL_P1 -D MT_TASK -D xMT_ZDO_FUNC   #
#                          -D LCD_SUPPORTED=DEBUG -D xPOWER_SAVING -lC        #
#                          "C:\Texas Instruments\ZStack-1.4.3-1.2.1\Projects\ #
#                          zstack\Samples\cc2430-zstack-adxl345\CC2430DB\EndD #
#                          eviceEB\List\" -lA "C:\Texas                       #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\EndDeviceEB\Li #
#                          st\" --diag_suppress Pe001,Pa010 --diag_remark     #
#                          pe550 -o "C:\Texas Instruments\ZStack-1.4.3-1.2.1\ #
#                          Projects\zstack\Samples\cc2430-zstack-adxl345\CC24 #
#                          30DB\EndDeviceEB\Obj\" -e --require_prototypes     #
#                          -z2 --no_cse --no_unroll --no_inline               #
#                          --no_code_motion --no_tbaa --debug --core=plain    #
#                          --dptr=16,1 --data_model=large                     #
#                          --code_model=banked --calling_convention=xdata_ree #
#                          ntrant --place_constants=data --nr_virtual_regs 8  #
#                          -I "C:\Texas Instruments\ZStack-1.4.3-1.2.1\Projec #
#                          ts\zstack\Samples\cc2430-zstack-adxl345\CC2430DB\" #
#                           -I "C:\Texas Instruments\ZStack-1.4.3-1.2.1\Proje #
#                          cts\zstack\Samples\cc2430-zstack-adxl345\CC2430DB\ #
#                          ..\SOURCE\" -I "C:\Texas                           #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\Drivers\"   #
#                          -I "C:\Texas Instruments\ZStack-1.4.3-1.2.1\Projec #
#                          ts\zstack\Samples\cc2430-zstack-adxl345\CC2430DB\. #
#                          .\..\..\ZMAIN\TI2430DB\" -I "C:\Texas              #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\.. #
#                          \COMPONENTS\MT\" -I "C:\Texas                      #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\.. #
#                          \COMPONENTS\HAL\INCLUDE\" -I "C:\Texas             #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\.. #
#                          \COMPONENTS\HAL\TARGET\CC2430EB\" -I "C:\Texas     #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\.. #
#                          \COMPONENTS\OSAL\MCU\CCSOC\" -I "C:\Texas          #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\.. #
#                          \COMPONENTS\OSAL\INCLUDE\" -I "C:\Texas            #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\.. #
#                          \COMPONENTS\STACK\AF\" -I "C:\Texas                #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\.. #
#                          \COMPONENTS\STACK\NWK\" -I "C:\Texas               #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\.. #
#                          \COMPONENTS\STACK\SEC\" -I "C:\Texas               #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\.. #
#                          \COMPONENTS\STACK\SYS\" -I "C:\Texas               #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\.. #
#                          \COMPONENTS\STACK\ZDO\" -I "C:\Texas               #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\.. #
#                          \COMPONENTS\ZMAC\F8W\" -I "C:\Texas                #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\.. #
#                          \COMPONENTS\ZMAC\" -I "C:\Texas                    #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\.. #
#                          \COMPONENTS\SERVICES\SADDR\" -I "C:\Texas          #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\.. #
#                          \COMPONENTS\SERVICES\SDATA\" -I "C:\Texas          #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\.. #
#                          \COMPONENTS\MAC\INCLUDE\" -I "C:\Texas             #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\.. #
#                          \COMPONENTS\MAC\HIGH_LEVEL\" -I "C:\Texas          #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\.. #
#                          \COMPONENTS\MAC\LOW_LEVEL\SRF03\" -I "C:\Texas     #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\.. #
#                          \COMPONENTS\MAC\LOW_LEVEL\SRF03\SINGLE_CHIP\" -I   #
#                          "C:\Program Files\IAR Systems\Embedded Workbench   #
#                          4.0 Evaluation version\8051\INC\" -I "C:\Program   #
#                          Files\IAR Systems\Embedded Workbench 4.0           #
#                          Evaluation version\8051\INC\CLIB\"                 #
#    List file          =  C:\Texas Instruments\ZStack-1.4.3-1.2.1\Projects\z #
#                          stack\Samples\cc2430-zstack-adxl345\CC2430DB\EndDe #
#                          viceEB\List\MTEL.lst                               #
#    Object file        =  C:\Texas Instruments\ZStack-1.4.3-1.2.1\Projects\z #
#                          stack\Samples\cc2430-zstack-adxl345\CC2430DB\EndDe #
#                          viceEB\Obj\MTEL.r51                                #
#                                                                             #
#                                                                             #
###############################################################################

C:\Texas Instruments\ZStack-1.4.3-1.2.1\Components\mt\MTEL.c
      1          /**************************************************************************************************
      2            Filename:       MTEL.c
      3            Revised:        $Date: 2007-12-07 14:27:57 -0800 (Fri, 07 Dec 2007) $
      4            Revision:       $Revision: 16045 $
      5          
      6            Description:    MonitorTest Event Loop functions. Everything in the MonitorTest Task.
      7          
      8          
      9            Copyright 2004-2007 Texas Instruments Incorporated. All rights reserved.
     10          
     11            IMPORTANT: Your use of this Software is limited to those specific rights
     12            granted under the terms of a software license agreement between the user
     13            who downloaded the software, his/her employer (which must be your employer)
     14            and Texas Instruments Incorporated (the "License").  You may not use this
     15            Software unless you agree to abide by the terms of the License. The License
     16            limits your use, and you acknowledge, that the Software may not be modified,
     17            copied or distributed unless embedded on a Texas Instruments microcontroller
     18            or used solely and exclusively in conjunction with a Texas Instruments radio
     19            frequency transceiver, which is integrated into your product.  Other than for
     20            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     21            works of, modify, distribute, perform, display or sell this Software and/or
     22            its documentation for any purpose.
     23          
     24            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     25            PROVIDED “AS IS” WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED, 
     26            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE, 
     27            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     28            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     29            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     30            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     31            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     32            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     33            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     34            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     35          
     36            Should you have any questions regarding your right to use this Software,
     37            contact Texas Instruments Incorporated at www.TI.com. 
     38          **************************************************************************************************/
     39          
     40          #if defined( MT_TASK )
     41          
     42          /*********************************************************************
     43           * INCLUDES
     44           */
     45          #include "ZComDef.h"
     46          #include "OnBoard.h"

   \                                 In  segment SFR_AN, at 0xa8
   \   union <unnamed> volatile __sfr _A_IEN0
   \                     _A_IEN0:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xc9
   \   unsigned char volatile __sfr WDCTL
   \                     WDCTL:
   \   000000                DS 1

   \                                 In  segment XDATA_AN, at 0xe000
   \   mboxMsg_t __xdata mboxMsg
   \                     mboxMsg:
   \   000000                DS 8
     47          #include "OSAL.h"
     48          #include "OSAL_Memory.h"
     49          #include "OSAL_Nv.h"
     50          #include "MTEL.h"
     51          #include "DebugTrace.h"
     52          #include "ZMAC.h"
     53          
     54          #if !defined ( NONWK )
     55            #include "NLMEDE.h"
     56            #include "nwk_bufs.h"
     57            #include "ZDObject.h"
     58            #include "ssp.h"
     59            #include "nwk_util.h"
     60          #endif
     61          
     62          #if defined( MT_MAC_FUNC ) || defined( MT_MAC_CB_FUNC )
     63            #include "MT_MAC.h"
     64          #endif
     65          #if defined( MT_NWK_FUNC ) || defined( MT_NWK_CB_FUNC )
     66            #include "MT_NWK.h"
     67            #include "nwk.h"
     68            #include "nwk_bufs.h"
     69          #endif
     70          #if defined( MT_AF_FUNC ) || defined( MT_AF_CB_FUNC )
     71            #include "MT_AF.h"
     72          #endif
     73          #if defined( MT_USER_TEST_FUNC )
     74            #include "AF.h"
     75          #endif
     76          #if defined( MT_ZDO_FUNC )
     77            #include "MT_ZDO.h"
     78          #endif
     79          #if defined (MT_SAPI_FUNC)
     80          	#include "MT_SAPI.h"
     81          #endif
     82          #if defined( APP_TP )
     83           #include "TestProfile.h"
     84          #endif
     85          #if defined( APP_TP2 )
     86           #include "TestProfile2.h"
     87          #endif
     88          
     89          #if defined(APP_TGEN)
     90            #include "TrafficGenApp.h"
     91          #endif
     92          #if defined(APP_DEBUG)
     93          	#include "DebugApp.h"
     94          #endif
     95          #if defined (NWK_TEST)
     96          	#include "HWTTApp.h"
     97          #endif
     98          
     99          /* HAL */
    100          #include "hal_uart.h"
    101          #include "hal_led.h"
    102          #include "hal_key.h"
    103          #include "hal_mailbox.h"
    104          #include "SPIMgr.h"
    105          
    106          /*********************************************************************
    107           * MACROS
    108           */
    109          #define MTEL_DEBUG_INFO( nParams, p1, p2, p3 ) DEBUG_INFO( COMPID_MTEL, nParams, p1, p2, p3 )
    110          
    111          #if defined( EXTERNAL_RAM )
    112            #define IS_MEM_VALID( Addr )  \
    113                  /* Check for valid internal RAM address. */\
    114              ( ( (((Addr) >= MCU_RAM_BEG) && ((Addr) <= MCU_RAM_END)) ||  \
    115                  /* Check for valid external RAM address. */\
    116                  (((Addr) >= EXT_RAM_BEG) && ((Addr) <= EXT_RAM_END)) ) ? TRUE : FALSE )
    117          #else
    118            #define IS_MEM_VALID( Addr )  \
    119                  /* Check for valid internal RAM address. */\
    120              ( ( ((Addr) >= MCU_RAM_BEG) && ((Addr) <= MCU_RAM_END) ) ? TRUE : FALSE )
    121          #endif
    122          
    123          /*********************************************************************
    124           * CONSTANTS
    125           */
    126          
    127          #ifdef ZPORT
    128          const char *MTVersionString[] = {"1.00 (F8W1.4.3-ZP)", "1.10 (F8W1.4.3-ZP)"};
    129          #else

   \                                 In  segment XDATA_I, align 1, keep-with-next
    130          const char *MTVersionString[] = {"1.00 (F8W1.4.3)", "1.10 (F8W1.4.3)"};
   \                     MTVersionString:
   \   000000                DS 4
   \   000004                REQUIRE `?<Initializer for MTVersionString>`
   \   000004                REQUIRE __INIT_XDATA_I
    131          #endif
    132          
    133          /*********************************************************************
    134           * TYPEDEFS
    135           */
    136          
    137          /*********************************************************************
    138           * GLOBAL VARIABLES
    139           */

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    140          byte MT_TaskID;
   \                     MT_TaskID:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    141          byte debugThreshold;
   \                     debugThreshold:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    142          byte debugCompId;
   \                     debugCompId:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    143          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    144          UINT16 save_cmd;
   \                     save_cmd:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z
    145          
    146          //DEBUG

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    147          uint32 longvar;
   \                     longvar:
   \   000000                DS 4
   \   000004                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    148          uint16 *temp_glob_ptr1;
   \                     temp_glob_ptr1:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    149          uint16 *temp_glob_ptr2;
   \                     temp_glob_ptr2:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z
    150          
    151          /*********************************************************************
    152           * EXTERNAL VARIABLES
    153           */
    154          
    155          /*********************************************************************
    156           * EXTERNAL FUNCTIONS
    157           */
    158          extern unsigned int mac_sim_eventLoop( void );
    159          
    160          #ifdef MACSIM
    161            // Used to pass Zignet message
    162            extern void MACSIM_TranslateMsg( byte *buf, byte bLen );
    163          #endif
    164          
    165          /*********************************************************************
    166           * LOCAL VARIABLES
    167           */
    168          
    169          /*********************************************************************
    170           * LOCAL FUNCTIONS
    171           */
    172          void MT_MsgQueueInit( void );
    173          void MT_ProcessCommand( mtOSALSerialData_t *msg );
    174          void MT_ProcessSerialCommand( byte *msg );
    175          byte MT_RAMRead( UINT16 addr, byte *pData );
    176          byte MT_RAMWrite( UINT16 addr , byte val );
    177          void MT_ProcessDebugMsg( mtDebugMsg_t *pData );
    178          void MT_ProcessDebugStr( mtDebugStr_t *pData );
    179          byte MT_SetDebugThreshold( byte comp_id, byte threshold );
    180          void MT_SendErrorNotification( byte err );
    181          void MT_ResetMsgQueue( void );
    182          byte MT_QueueMsg( byte *msg , byte len );
    183          void MT_ProcessQueue( void );
    184          void MT_SendSPIRespMsg( byte ret, uint16 cmd_id, byte msgLen, byte respLen);
    185          void MT_Reset(byte typID);
    186          byte MT_ProcessSetNV( byte *pData );
    187          void MT_ProcessGetNV( byte *pData );
    188          void MT_ProcessGetNvInfo( void );
    189          void MT_ProcessGetDeviceInfo( void );
    190          byte MTProcessAppMsg( byte *pData, byte len );
    191          void MTProcessAppRspMsg( byte *pData, byte len );
    192          
    193          #if (defined HAL_LED) && (HAL_LED == TRUE)
    194          byte MTProcessLedControl( byte *pData );
    195          #endif
    196          
    197          #if defined ( MT_USER_TEST_FUNC )
    198          void MT_ProcessAppUserCmd( byte *pData );
    199          #endif
    200          
    201          /*********************************************************************
    202           * @fn      MT_TaskInit
    203           *
    204           * @brief
    205           *
    206           *   MonitorTest Task Initialization.  This function is put into the
    207           *   task table.
    208           *
    209           * @param   byte task_id - task ID of the MT Task
    210           *
    211           * @return  void
    212           *
    213           *********************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    214          void MT_TaskInit( byte task_id )
   \                     MT_TaskInit:
    215          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
    216            MT_TaskID = task_id;
   \   000006   90....       MOV     DPTR,#MT_TaskID
   \   000009   F0           MOVX    @DPTR,A
    217          
    218            debugThreshold = 0;
   \   00000A   7400         MOV     A,#0x0
   \   00000C   90....       MOV     DPTR,#debugThreshold
   \   00000F   F0           MOVX    @DPTR,A
    219            debugCompId = 0;
   \   000010   7400         MOV     A,#0x0
   \   000012   90....       MOV     DPTR,#debugCompId
   \   000015   F0           MOVX    @DPTR,A
    220          
    221            // Initialize the Serial port
    222            SPIMgr_Init();
   \   000016                ; Setup parameters for call to function SPIMgr_Init
   \   000016   12....       LCALL   ??SPIMgr_Init?relay
    223          
    224          } /* MT_TaskInit() */
   \   000019   7F01         MOV     R7,#0x1
   \   00001B   02....       LJMP    ?BANKED_LEAVE_XDATA
    225          
    226          #ifdef ZTOOL_PORT
    227          /*********************************************************************
    228           * @fn      MT_IndReset()
    229           *
    230           * @brief   Sends a ZTOOL "reset response" message.
    231           *
    232           * @param   None
    233           *
    234           * @return  None
    235           *
    236           *********************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    237          void MT_IndReset( void )
   \                     MT_IndReset:
    238          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    239          
    240            byte rsp = 0;  // Reset type==0 indicates Z-Stack reset
   \   00000A   7400         MOV     A,#0x0
   \   00000C   85..82       MOV     DPL,?XSP + 0
   \   00000F   85..83       MOV     DPH,?XSP + 1
   \   000012   F0           MOVX    @DPTR,A
    241          
    242            // Send out Reset Response message
    243            MT_BuildAndSendZToolResponse( (SPI_0DATA_MSG_LEN + sizeof( rsp )),
    244                                          (SPI_RESPONSE_BIT | SPI_CMD_SYS_RESET),
    245                                          sizeof( rsp ), &rsp );
   \   000013                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000013   85..82       MOV     DPL,?XSP + 0
   \   000016   85..83       MOV     DPH,?XSP + 1
   \   000019   8582..       MOV     ?V0 + 0,DPL
   \   00001C   8583..       MOV     ?V0 + 1,DPH
   \   00001F   78..         MOV     R0,#?V0 + 0
   \   000021   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000024   7C01         MOV     R4,#0x1
   \   000026   7A05         MOV     R2,#0x5
   \   000028   7B10         MOV     R3,#0x10
   \   00002A   7906         MOV     R1,#0x6
   \   00002C   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
   \   00002F   7402         MOV     A,#0x2
   \   000031   12....       LCALL   ?DEALLOC_XSTACK8
    246          }
   \   000034   7401         MOV     A,#0x1
   \   000036   12....       LCALL   ?DEALLOC_XSTACK8
   \   000039   7F02         MOV     R7,#0x2
   \   00003B   02....       LJMP    ?BANKED_LEAVE_XDATA
    247          #endif
    248          
    249          /*********************************************************************
    250           * @fn      MT_ProcessEvent
    251           *
    252           * @brief
    253           *
    254           *   MonitorTest Task Event Processor.  This task is put into the
    255           *   task table.
    256           *
    257           * @param   byte task_id - task ID of the MT Task
    258           * @param   UINT16 events - event(s) for the MT Task
    259           *
    260           * @return  void
    261           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    262          UINT16 MT_ProcessEvent( byte task_id, UINT16 events )
   \                     MT_ProcessEvent:
    263          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
    264            uint8 *msg_ptr;
    265          
    266            // Could be multiple events, so switch won't work
    267          
    268            if ( events & SYS_EVENT_MSG )
   \   000009   7400         MOV     A,#0x0
   \   00000B   5E           ANL     A,R6
   \   00000C   F8           MOV     R0,A
   \   00000D   7480         MOV     A,#-0x80
   \   00000F   5F           ANL     A,R7
   \   000010   F9           MOV     R1,A
   \   000011   7400         MOV     A,#0x0
   \   000013   68           XRL     A,R0
   \   000014   7003         JNZ     ??MT_ProcessEvent_0
   \   000016   7400         MOV     A,#0x0
   \   000018   69           XRL     A,R1
   \                     ??MT_ProcessEvent_0:
   \   000019   6031         JZ      ??MT_ProcessEvent_1
    269            {
    270              while ( (msg_ptr = osal_msg_receive( MT_TaskID )) )
   \                     ??MT_ProcessEvent_2:
   \   00001B                ; Setup parameters for call to function osal_msg_receive
   \   00001B   90....       MOV     DPTR,#MT_TaskID
   \   00001E   E0           MOVX    A,@DPTR
   \   00001F   F9           MOV     R1,A
   \   000020   12....       LCALL   ??osal_msg_receive?relay
   \   000023   8A..         MOV     ?V0 + 4,R2
   \   000025   8B..         MOV     ?V0 + 5,R3
   \   000027   A8..         MOV     R0,?V0 + 4
   \   000029   A9..         MOV     R1,?V0 + 5
   \   00002B   88..         MOV     ?V0 + 0,R0
   \   00002D   89..         MOV     ?V0 + 1,R1
   \   00002F   E8           MOV     A,R0
   \   000030   6400         XRL     A,#0x0
   \   000032   7003         JNZ     ??MT_ProcessEvent_3
   \   000034   E9           MOV     A,R1
   \   000035   6400         XRL     A,#0x0
   \                     ??MT_ProcessEvent_3:
   \   000037   6009         JZ      ??MT_ProcessEvent_4
    271              {
    272                MT_ProcessCommand( (mtOSALSerialData_t *)msg_ptr );
   \   000039                ; Setup parameters for call to function MT_ProcessCommand
   \   000039   AA..         MOV     R2,?V0 + 0
   \   00003B   AB..         MOV     R3,?V0 + 1
   \   00003D   12....       LCALL   ??MT_ProcessCommand?relay
   \   000040   80D9         SJMP    ??MT_ProcessEvent_2
    273              }
    274          
    275              // Return unproccessed events
    276              return (events ^ SYS_EVENT_MSG);
   \                     ??MT_ProcessEvent_4:
   \   000042   7400         MOV     A,#0x0
   \   000044   6E           XRL     A,R6
   \   000045   FA           MOV     R2,A
   \   000046   7480         MOV     A,#-0x80
   \   000048   6F           XRL     A,R7
   \   000049   FB           MOV     R3,A
   \   00004A   8018         SJMP    ??MT_ProcessEvent_5
    277            }
    278          
    279          #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
    280            if ( events & MT_ZTOOL_SERIAL_RCV_BUFFER_FULL )
   \                     ??MT_ProcessEvent_1:
   \   00004C   EE           MOV     A,R6
   \   00004D   5404         ANL     A,#0x4
   \   00004F   600F         JZ      ??MT_ProcessEvent_6
    281            {
    282              // Do sometype of error processing
    283              MT_SendErrorNotification(RECEIVE_BUFFER_FULL);
   \   000051                ; Setup parameters for call to function MT_SendErrorNotification
   \   000051   7902         MOV     R1,#0x2
   \   000053   12....       LCALL   ??MT_SendErrorNotification?relay
    284          
    285              // Return unproccessed events
    286              return (events ^ MT_ZTOOL_SERIAL_RCV_BUFFER_FULL);
   \   000056   7404         MOV     A,#0x4
   \   000058   6E           XRL     A,R6
   \   000059   FA           MOV     R2,A
   \   00005A   7400         MOV     A,#0x0
   \   00005C   6F           XRL     A,R7
   \   00005D   FB           MOV     R3,A
   \   00005E   8004         SJMP    ??MT_ProcessEvent_5
    287            }
    288          #endif
    289          
    290            // Discard or make more handlers
    291            return 0;
   \                     ??MT_ProcessEvent_6:
   \   000060   7A00         MOV     R2,#0x0
   \   000062   7B00         MOV     R3,#0x0
   \                     ??MT_ProcessEvent_5:
   \   000064   7F06         MOV     R7,#0x6
   \   000066   02....       LJMP    ?BANKED_LEAVE_XDATA
    292          
    293          } /* MT_ProcessEvent() */
    294          
    295          #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
    296          /*********************************************************************
    297           * @fn      MT_BuildSPIMsg
    298           *
    299           * @brief
    300           *
    301           *   Format an SPI message.
    302           *
    303           * @param   UINT16 cmd - command id
    304           * @param   byte *msg - pointer to message buffer
    305           * @param   byte dataLen - length of data field
    306           * @param   byte *pData - pointer to data field
    307           *
    308           * @return  void
    309           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    310          void MT_BuildSPIMsg( UINT16 cmd, byte *msg, byte dataLen, byte *pData )
   \                     MT_BuildSPIMsg:
    311          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 2
   \   000005   74FE         MOV     A,#-0x2
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   8A..         MOV     ?V0 + 4,R2
   \   00000C   8B..         MOV     ?V0 + 5,R3
   \   00000E   EC           MOV     A,R4
   \   00000F   FE           MOV     R6,A
   \   000010   ED           MOV     A,R5
   \   000011   FF           MOV     R7,A
   \   000012   89..         MOV     ?V0 + 3,R1
   \   000014   7412         MOV     A,#0x12
   \   000016   12....       LCALL   ?XSTACK_DISP0_8
   \   000019   E0           MOVX    A,@DPTR
   \   00001A   F5..         MOV     ?V0 + 6,A
   \   00001C   A3           INC     DPTR
   \   00001D   E0           MOVX    A,@DPTR
   \   00001E   F5..         MOV     ?V0 + 7,A
    312            byte *msgPtr;
    313          
    314            *msg++ = SOP_VALUE;
   \   000020   7402         MOV     A,#0x2
   \   000022   8E82         MOV     DPL,R6
   \   000024   8F83         MOV     DPH,R7
   \   000026   F0           MOVX    @DPTR,A
   \   000027   8E82         MOV     DPL,R6
   \   000029   8F83         MOV     DPH,R7
   \   00002B   A3           INC     DPTR
   \   00002C   AE82         MOV     R6,DPL
   \   00002E   AF83         MOV     R7,DPH
    315          
    316            msgPtr = msg;
   \   000030   85..82       MOV     DPL,?XSP + 0
   \   000033   85..83       MOV     DPH,?XSP + 1
   \   000036   EE           MOV     A,R6
   \   000037   F0           MOVX    @DPTR,A
   \   000038   A3           INC     DPTR
   \   000039   EF           MOV     A,R7
   \   00003A   F0           MOVX    @DPTR,A
    317          
    318            *msg++ = (byte)(HI_UINT16( cmd ));
   \   00003B   8E82         MOV     DPL,R6
   \   00003D   8F83         MOV     DPH,R7
   \   00003F   E5..         MOV     A,?V0 + 5
   \   000041   F0           MOVX    @DPTR,A
   \   000042   8E82         MOV     DPL,R6
   \   000044   8F83         MOV     DPH,R7
   \   000046   A3           INC     DPTR
   \   000047   AE82         MOV     R6,DPL
   \   000049   AF83         MOV     R7,DPH
    319            *msg++ = (byte)(LO_UINT16( cmd ));
   \   00004B   8E82         MOV     DPL,R6
   \   00004D   8F83         MOV     DPH,R7
   \   00004F   E5..         MOV     A,?V0 + 4
   \   000051   F0           MOVX    @DPTR,A
   \   000052   8E82         MOV     DPL,R6
   \   000054   8F83         MOV     DPH,R7
   \   000056   A3           INC     DPTR
   \   000057   AE82         MOV     R6,DPL
   \   000059   AF83         MOV     R7,DPH
    320          
    321            if ( pData )
   \   00005B   E5..         MOV     A,?V0 + 6
   \   00005D   6400         XRL     A,#0x0
   \   00005F   7004         JNZ     ??MT_BuildSPIMsg_0
   \   000061   E5..         MOV     A,?V0 + 7
   \   000063   6400         XRL     A,#0x0
   \                     ??MT_BuildSPIMsg_0:
   \   000065   603C         JZ      ??MT_BuildSPIMsg_1
    322            {
    323              *msg++ = dataLen;
   \   000067   8E82         MOV     DPL,R6
   \   000069   8F83         MOV     DPH,R7
   \   00006B   E5..         MOV     A,?V0 + 3
   \   00006D   F0           MOVX    @DPTR,A
   \   00006E   8E82         MOV     DPL,R6
   \   000070   8F83         MOV     DPH,R7
   \   000072   A3           INC     DPTR
   \   000073   AE82         MOV     R6,DPL
   \   000075   AF83         MOV     R7,DPH
    324          
    325              msg = osal_memcpy( msg, pData, dataLen );
   \   000077                ; Setup parameters for call to function osal_memcpy
   \   000077   85....       MOV     ?V0 + 0,?V0 + 6
   \   00007A   85....       MOV     ?V0 + 1,?V0 + 7
   \   00007D   75..00       MOV     ?V0 + 2,#0x0
   \   000080   78..         MOV     R0,#?V0 + 0
   \   000082   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000085   E5..         MOV     A,?V0 + 3
   \   000087   F5..         MOV     ?V0 + 0,A
   \   000089   AC..         MOV     R4,?V0 + 0
   \   00008B   7D00         MOV     R5,#0x0
   \   00008D   EE           MOV     A,R6
   \   00008E   FA           MOV     R2,A
   \   00008F   EF           MOV     A,R7
   \   000090   FB           MOV     R3,A
   \   000091   12....       LCALL   ??osal_memcpy?relay
   \   000094   7403         MOV     A,#0x3
   \   000096   12....       LCALL   ?DEALLOC_XSTACK8
   \   000099   8A..         MOV     ?V0 + 0,R2
   \   00009B   8B..         MOV     ?V0 + 1,R3
   \   00009D   AE..         MOV     R6,?V0 + 0
   \   00009F   AF..         MOV     R7,?V0 + 1
   \   0000A1   8010         SJMP    ??MT_BuildSPIMsg_2
    326            }
    327            else
    328              *msg++ = 0;
   \                     ??MT_BuildSPIMsg_1:
   \   0000A3   7400         MOV     A,#0x0
   \   0000A5   8E82         MOV     DPL,R6
   \   0000A7   8F83         MOV     DPH,R7
   \   0000A9   F0           MOVX    @DPTR,A
   \   0000AA   8E82         MOV     DPL,R6
   \   0000AC   8F83         MOV     DPH,R7
   \   0000AE   A3           INC     DPTR
   \   0000AF   AE82         MOV     R6,DPL
   \   0000B1   AF83         MOV     R7,DPH
    329          
    330            *msg = SPIMgr_CalcFCS( msgPtr, (byte)(3 + dataLen) );
   \                     ??MT_BuildSPIMsg_2:
   \   0000B3                ; Setup parameters for call to function SPIMgr_CalcFCS
   \   0000B3   7403         MOV     A,#0x3
   \   0000B5   25..         ADD     A,?V0 + 3
   \   0000B7   F9           MOV     R1,A
   \   0000B8   85..82       MOV     DPL,?XSP + 0
   \   0000BB   85..83       MOV     DPH,?XSP + 1
   \   0000BE   E0           MOVX    A,@DPTR
   \   0000BF   FA           MOV     R2,A
   \   0000C0   A3           INC     DPTR
   \   0000C1   E0           MOVX    A,@DPTR
   \   0000C2   FB           MOV     R3,A
   \   0000C3   12....       LCALL   ??SPIMgr_CalcFCS?relay
   \   0000C6   E9           MOV     A,R1
   \   0000C7   8E82         MOV     DPL,R6
   \   0000C9   8F83         MOV     DPH,R7
   \   0000CB   F0           MOVX    @DPTR,A
    331          }
   \   0000CC   7402         MOV     A,#0x2
   \   0000CE   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000D1   7F08         MOV     R7,#0x8
   \   0000D3   02....       LJMP    ?BANKED_LEAVE_XDATA
    332          #endif
    333          
    334          #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
    335          /*********************************************************************
    336           * @fn      MT_BuildAndSendZToolResponse
    337           *
    338           * @brief
    339           *
    340           *   Build and send a ZTOOL msg
    341           *
    342           * @param   byte err
    343           *
    344           * @return  void
    345           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    346          void MT_BuildAndSendZToolResponse( byte msgLen, uint16 cmd,
   \                     MT_BuildAndSendZToolResponse:
    347                                             byte dataLen, byte *pData )
    348          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 1,R1
   \   000007   8A..         MOV     ?V0 + 4,R2
   \   000009   8B..         MOV     ?V0 + 5,R3
   \   00000B   8C..         MOV     ?V0 + 0,R4
   \   00000D   7410         MOV     A,#0x10
   \   00000F   12....       LCALL   ?XSTACK_DISP0_8
   \   000012   E0           MOVX    A,@DPTR
   \   000013   F5..         MOV     ?V0 + 6,A
   \   000015   A3           INC     DPTR
   \   000016   E0           MOVX    A,@DPTR
   \   000017   F5..         MOV     ?V0 + 7,A
    349            byte *msg_ptr;
    350          
    351            // Get a message buffer to build response message
    352            msg_ptr = osal_mem_alloc( msgLen );
   \   000019                ; Setup parameters for call to function osal_mem_alloc
   \   000019   E5..         MOV     A,?V0 + 1
   \   00001B   F5..         MOV     ?V0 + 2,A
   \   00001D   AA..         MOV     R2,?V0 + 2
   \   00001F   7B00         MOV     R3,#0x0
   \   000021   12....       LCALL   ??osal_mem_alloc?relay
   \   000024   8A..         MOV     ?V0 + 2,R2
   \   000026   8B..         MOV     ?V0 + 3,R3
   \   000028   AE..         MOV     R6,?V0 + 2
   \   00002A   AF..         MOV     R7,?V0 + 3
    353            if ( msg_ptr )
   \   00002C   EE           MOV     A,R6
   \   00002D   6400         XRL     A,#0x0
   \   00002F   7003         JNZ     ??MT_BuildAndSendZToolResponse_0
   \   000031   EF           MOV     A,R7
   \   000032   6400         XRL     A,#0x0
   \                     ??MT_BuildAndSendZToolResponse_0:
   \   000034   6035         JZ      ??MT_BuildAndSendZToolResponse_1
    354            {
    355          #ifdef SPI_MGR_DEFAULT_PORT
    356              MT_BuildSPIMsg( cmd, msg_ptr, dataLen, pData );
   \   000036                ; Setup parameters for call to function MT_BuildSPIMsg
   \   000036   85....       MOV     ?V0 + 2,?V0 + 6
   \   000039   85....       MOV     ?V0 + 3,?V0 + 7
   \   00003C   78..         MOV     R0,#?V0 + 2
   \   00003E   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000041   A9..         MOV     R1,?V0 + 0
   \   000043   EE           MOV     A,R6
   \   000044   FC           MOV     R4,A
   \   000045   EF           MOV     A,R7
   \   000046   FD           MOV     R5,A
   \   000047   AA..         MOV     R2,?V0 + 4
   \   000049   AB..         MOV     R3,?V0 + 5
   \   00004B   12....       LCALL   ??MT_BuildSPIMsg?relay
   \   00004E   7402         MOV     A,#0x2
   \   000050   12....       LCALL   ?DEALLOC_XSTACK8
    357              HalUARTWrite ( SPI_MGR_DEFAULT_PORT, msg_ptr, msgLen );
   \   000053                ; Setup parameters for call to function HalUARTWrite
   \   000053   E5..         MOV     A,?V0 + 1
   \   000055   F5..         MOV     ?V0 + 2,A
   \   000057   AC..         MOV     R4,?V0 + 2
   \   000059   7D00         MOV     R5,#0x0
   \   00005B   EE           MOV     A,R6
   \   00005C   FA           MOV     R2,A
   \   00005D   EF           MOV     A,R7
   \   00005E   FB           MOV     R3,A
   \   00005F   7900         MOV     R1,#0x0
   \   000061   12....       LCALL   ??HalUARTWrite?relay
    358          #endif
    359              osal_mem_free( msg_ptr );
   \   000064                ; Setup parameters for call to function osal_mem_free
   \   000064   EE           MOV     A,R6
   \   000065   FA           MOV     R2,A
   \   000066   EF           MOV     A,R7
   \   000067   FB           MOV     R3,A
   \   000068   12....       LCALL   ??osal_mem_free?relay
    360            }
    361          }
   \                     ??MT_BuildAndSendZToolResponse_1:
   \   00006B   7F08         MOV     R7,#0x8
   \   00006D   02....       LJMP    ?BANKED_LEAVE_XDATA
    362          #endif
    363          
    364          #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
    365          /*********************************************************************
    366           * @fn      MT_BuildAndSendZToolCB
    367           *
    368           * @brief
    369           *
    370           *   Build and send a ZTOOL Callback msg
    371           *
    372           * @param   len - length of data portion of the message
    373           *
    374           * @return  void
    375           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    376          void MT_BuildAndSendZToolCB( uint16 callbackID, byte len, byte *pData )
   \                     MT_BuildAndSendZToolCB:
    377          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 3
   \   000005   74FD         MOV     A,#-0x3
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   7401         MOV     A,#0x1
   \   00000C   12....       LCALL   ?XSTACK_DISP0_8
   \   00000F   EC           MOV     A,R4
   \   000010   F0           MOVX    @DPTR,A
   \   000011   A3           INC     DPTR
   \   000012   ED           MOV     A,R5
   \   000013   F0           MOVX    @DPTR,A
   \   000014   8A..         MOV     ?V0 + 4,R2
   \   000016   8B..         MOV     ?V0 + 5,R3
   \   000018   89..         MOV     ?V0 + 3,R1
    378            byte msgLen;
    379            mtOSALSerialData_t *msgPtr;
    380            byte *msg;
    381          
    382            msgLen = sizeof ( mtOSALSerialData_t ) + SPI_0DATA_MSG_LEN + len;
   \   00001A   7409         MOV     A,#0x9
   \   00001C   25..         ADD     A,?V0 + 3
   \   00001E   85..82       MOV     DPL,?XSP + 0
   \   000021   85..83       MOV     DPH,?XSP + 1
   \   000024   F0           MOVX    @DPTR,A
    383          
    384            msgPtr = (mtOSALSerialData_t *)osal_msg_allocate( msgLen );
   \   000025                ; Setup parameters for call to function osal_msg_allocate
   \   000025   85..82       MOV     DPL,?XSP + 0
   \   000028   85..83       MOV     DPH,?XSP + 1
   \   00002B   E0           MOVX    A,@DPTR
   \   00002C   F5..         MOV     ?V0 + 0,A
   \   00002E   AA..         MOV     R2,?V0 + 0
   \   000030   7B00         MOV     R3,#0x0
   \   000032   12....       LCALL   ??osal_msg_allocate?relay
   \   000035   8A..         MOV     ?V0 + 0,R2
   \   000037   8B..         MOV     ?V0 + 1,R3
   \   000039   85....       MOV     ?V0 + 6,?V0 + 0
   \   00003C   85....       MOV     ?V0 + 7,?V0 + 1
    385            if ( msgPtr )
   \   00003F   E5..         MOV     A,?V0 + 6
   \   000041   6400         XRL     A,#0x0
   \   000043   7004         JNZ     ??MT_BuildAndSendZToolCB_0
   \   000045   E5..         MOV     A,?V0 + 7
   \   000047   6400         XRL     A,#0x0
   \                     ??MT_BuildAndSendZToolCB_0:
   \   000049   7003         JNZ     $+5
   \   00004B   02....       LJMP    ??MT_BuildAndSendZToolCB_1 & 0xFFFF
    386            {
    387              msgPtr->hdr.event = CB_FUNC;
   \   00004E   7404         MOV     A,#0x4
   \   000050   85..82       MOV     DPL,?V0 + 6
   \   000053   85..83       MOV     DPH,?V0 + 7
   \   000056   F0           MOVX    @DPTR,A
    388              msgPtr->msg = (uint8 *)(msgPtr+1);
   \   000057   E5..         MOV     A,?V0 + 6
   \   000059   2404         ADD     A,#0x4
   \   00005B   F8           MOV     R0,A
   \   00005C   E5..         MOV     A,?V0 + 7
   \   00005E   3400         ADDC    A,#0x0
   \   000060   F9           MOV     R1,A
   \   000061   85..82       MOV     DPL,?V0 + 6
   \   000064   85..83       MOV     DPH,?V0 + 7
   \   000067   A3           INC     DPTR
   \   000068   A3           INC     DPTR
   \   000069   E8           MOV     A,R0
   \   00006A   F0           MOVX    @DPTR,A
   \   00006B   A3           INC     DPTR
   \   00006C   E9           MOV     A,R1
   \   00006D   F0           MOVX    @DPTR,A
    389              msg = msgPtr->msg;
   \   00006E   85..82       MOV     DPL,?V0 + 6
   \   000071   85..83       MOV     DPH,?V0 + 7
   \   000074   A3           INC     DPTR
   \   000075   A3           INC     DPTR
   \   000076   E0           MOVX    A,@DPTR
   \   000077   F8           MOV     R0,A
   \   000078   A3           INC     DPTR
   \   000079   E0           MOVX    A,@DPTR
   \   00007A   F9           MOV     R1,A
   \   00007B   E8           MOV     A,R0
   \   00007C   FE           MOV     R6,A
   \   00007D   E9           MOV     A,R1
   \   00007E   FF           MOV     R7,A
    390          
    391              //First byte is used as the event type for MT
    392              *msg++ = SOP_VALUE;
   \   00007F   7402         MOV     A,#0x2
   \   000081   8E82         MOV     DPL,R6
   \   000083   8F83         MOV     DPH,R7
   \   000085   F0           MOVX    @DPTR,A
   \   000086   8E82         MOV     DPL,R6
   \   000088   8F83         MOV     DPH,R7
   \   00008A   A3           INC     DPTR
   \   00008B   AE82         MOV     R6,DPL
   \   00008D   AF83         MOV     R7,DPH
    393              *msg++ = HI_UINT16( callbackID );
   \   00008F   8E82         MOV     DPL,R6
   \   000091   8F83         MOV     DPH,R7
   \   000093   E5..         MOV     A,?V0 + 5
   \   000095   F0           MOVX    @DPTR,A
   \   000096   8E82         MOV     DPL,R6
   \   000098   8F83         MOV     DPH,R7
   \   00009A   A3           INC     DPTR
   \   00009B   AE82         MOV     R6,DPL
   \   00009D   AF83         MOV     R7,DPH
    394              *msg++ = LO_UINT16( callbackID );
   \   00009F   8E82         MOV     DPL,R6
   \   0000A1   8F83         MOV     DPH,R7
   \   0000A3   E5..         MOV     A,?V0 + 4
   \   0000A5   F0           MOVX    @DPTR,A
   \   0000A6   8E82         MOV     DPL,R6
   \   0000A8   8F83         MOV     DPH,R7
   \   0000AA   A3           INC     DPTR
   \   0000AB   AE82         MOV     R6,DPL
   \   0000AD   AF83         MOV     R7,DPH
    395              *msg++ = len;
   \   0000AF   8E82         MOV     DPL,R6
   \   0000B1   8F83         MOV     DPH,R7
   \   0000B3   E5..         MOV     A,?V0 + 3
   \   0000B5   F0           MOVX    @DPTR,A
   \   0000B6   8E82         MOV     DPL,R6
   \   0000B8   8F83         MOV     DPH,R7
   \   0000BA   A3           INC     DPTR
   \   0000BB   AE82         MOV     R6,DPL
   \   0000BD   AF83         MOV     R7,DPH
    396          
    397              //Fill up the data bytes
    398              osal_memcpy( msg, pData, len );
   \   0000BF                ; Setup parameters for call to function osal_memcpy
   \   0000BF   7401         MOV     A,#0x1
   \   0000C1   12....       LCALL   ?XSTACK_DISP0_8
   \   0000C4   E0           MOVX    A,@DPTR
   \   0000C5   F5..         MOV     ?V0 + 0,A
   \   0000C7   A3           INC     DPTR
   \   0000C8   E0           MOVX    A,@DPTR
   \   0000C9   F5..         MOV     ?V0 + 1,A
   \   0000CB   75..00       MOV     ?V0 + 2,#0x0
   \   0000CE   78..         MOV     R0,#?V0 + 0
   \   0000D0   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   0000D3   E5..         MOV     A,?V0 + 3
   \   0000D5   F5..         MOV     ?V0 + 0,A
   \   0000D7   AC..         MOV     R4,?V0 + 0
   \   0000D9   7D00         MOV     R5,#0x0
   \   0000DB   EE           MOV     A,R6
   \   0000DC   FA           MOV     R2,A
   \   0000DD   EF           MOV     A,R7
   \   0000DE   FB           MOV     R3,A
   \   0000DF   12....       LCALL   ??osal_memcpy?relay
   \   0000E2   7403         MOV     A,#0x3
   \   0000E4   12....       LCALL   ?DEALLOC_XSTACK8
    399          
    400              osal_msg_send( MT_TaskID, (uint8 *)msgPtr );
   \   0000E7                ; Setup parameters for call to function osal_msg_send
   \   0000E7   AA..         MOV     R2,?V0 + 6
   \   0000E9   AB..         MOV     R3,?V0 + 7
   \   0000EB   90....       MOV     DPTR,#MT_TaskID
   \   0000EE   E0           MOVX    A,@DPTR
   \   0000EF   F9           MOV     R1,A
   \   0000F0   12....       LCALL   ??osal_msg_send?relay
    401            }
    402          }
   \                     ??MT_BuildAndSendZToolCB_1:
   \   0000F3   7403         MOV     A,#0x3
   \   0000F5   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000F8   7F08         MOV     R7,#0x8
   \   0000FA   02....       LJMP    ?BANKED_LEAVE_XDATA
    403          #endif
    404          
    405          /*********************************************************************
    406           * @fn      MT_ProcessCommand
    407           *
    408           * @brief
    409           *
    410           *   Process Event Messages.
    411           *
    412           * @param   byte *msg - pointer to event message
    413           *
    414           * @return
    415           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    416          void MT_ProcessCommand( mtOSALSerialData_t *msg )
   \                     MT_ProcessCommand:
    417          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   \   000005   8A..         MOV     ?V0 + 2,R2
   \   000007   8B..         MOV     ?V0 + 3,R3
    418            byte deallocate;
    419          #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
    420            byte *msg_ptr;
    421            byte len;
    422          
    423            // A little setup for AF, CB_FUNC and MT_SYS_APP_RSP_MSG
    424            msg_ptr = msg->msg;
   \   000009   85..82       MOV     DPL,?V0 + 2
   \   00000C   85..83       MOV     DPH,?V0 + 3
   \   00000F   A3           INC     DPTR
   \   000010   A3           INC     DPTR
   \   000011   E0           MOVX    A,@DPTR
   \   000012   F8           MOV     R0,A
   \   000013   A3           INC     DPTR
   \   000014   E0           MOVX    A,@DPTR
   \   000015   F9           MOV     R1,A
   \   000016   E8           MOV     A,R0
   \   000017   FE           MOV     R6,A
   \   000018   E9           MOV     A,R1
   \   000019   FF           MOV     R7,A
    425          #endif // ZTOOL
    426          
    427            deallocate = true;
   \   00001A   75..01       MOV     ?V0 + 1,#0x1
    428          
    429            // Use the first byte of the message as the command ID
    430            switch ( msg->hdr.event )
   \   00001D   85..82       MOV     DPL,?V0 + 2
   \   000020   85..83       MOV     DPH,?V0 + 3
   \   000023   E0           MOVX    A,@DPTR
   \   000024   12....       LCALL   ?UC_SWITCH_SPARSE
   \                     `?<Jumptable for MT_ProcessCommand>_0`:
   \   000027   00           DB        0
   \   000028   05           DB        5
   \   000029   01           DB        1
   \   00002A   ....         DW        ??MT_ProcessCommand_0
   \   00002C   02           DB        2
   \   00002D   ....         DW        ??MT_ProcessCommand_1
   \   00002F   04           DB        4
   \   000030   ....         DW        ??MT_ProcessCommand_2
   \   000032   06           DB        6
   \   000033   ....         DW        ??MT_ProcessCommand_3
   \   000035   24           DB        36
   \   000036   ....         DW        ??MT_ProcessCommand_4
   \   000038   ....         DW        ??MT_ProcessCommand_5
    431            {
    432          #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
    433              case CMD_SERIAL_MSG:
    434                MT_ProcessSerialCommand( msg->msg );
   \                     ??MT_ProcessCommand_0:
   \   00003A                ; Setup parameters for call to function MT_ProcessSerialCommand
   \   00003A   85..82       MOV     DPL,?V0 + 2
   \   00003D   85..83       MOV     DPH,?V0 + 3
   \   000040   A3           INC     DPTR
   \   000041   A3           INC     DPTR
   \   000042   E0           MOVX    A,@DPTR
   \   000043   FA           MOV     R2,A
   \   000044   A3           INC     DPTR
   \   000045   E0           MOVX    A,@DPTR
   \   000046   FB           MOV     R3,A
   \   000047   12....       LCALL   ??MT_ProcessSerialCommand?relay
   \   00004A   8075         SJMP    ??MT_ProcessCommand_5
    435                break;
    436          
    437              case CMD_DEBUG_MSG:
    438                MT_ProcessDebugMsg( (mtDebugMsg_t *)msg );
   \                     ??MT_ProcessCommand_1:
   \   00004C                ; Setup parameters for call to function MT_ProcessDebugMsg
   \   00004C   AA..         MOV     R2,?V0 + 2
   \   00004E   AB..         MOV     R3,?V0 + 3
   \   000050   12....       LCALL   ??MT_ProcessDebugMsg?relay
   \   000053   806C         SJMP    ??MT_ProcessCommand_5
    439                break;
    440          
    441              case CMD_DEBUG_STR:
    442                MT_ProcessDebugStr( (mtDebugStr_t *)msg );
   \                     ??MT_ProcessCommand_3:
   \   000055                ; Setup parameters for call to function MT_ProcessDebugStr
   \   000055   AA..         MOV     R2,?V0 + 2
   \   000057   AB..         MOV     R3,?V0 + 3
   \   000059   12....       LCALL   ??MT_ProcessDebugStr?relay
   \   00005C   8063         SJMP    ??MT_ProcessCommand_5
    443                break;
    444          
    445              case CB_FUNC:
    446                /*
    447                  Build SPI message here instead of redundantly calling MT_BuildSPIMsg
    448                  because we have copied data already in the allocated message
    449                */
    450          
    451                /* msg_ptr is the beginning of the intended SPI message */
    452                len = SPI_0DATA_MSG_LEN + msg_ptr[DATALEN_FIELD];
   \                     ??MT_ProcessCommand_2:
   \   00005E   8E82         MOV     DPL,R6
   \   000060   8F83         MOV     DPH,R7
   \   000062   A3           INC     DPTR
   \   000063   A3           INC     DPTR
   \   000064   A3           INC     DPTR
   \   000065   E0           MOVX    A,@DPTR
   \   000066   2405         ADD     A,#0x5
   \   000068   F5..         MOV     ?V0 + 0,A
    453          
    454                /*
    455                  FCS goes to the last byte in the message and is calculated over all
    456                  the bytes except FCS and SOP
    457                */
    458                msg_ptr[len-1] = SPIMgr_CalcFCS( msg_ptr + 1 , (byte)(len-2) );
   \   00006A                ; Setup parameters for call to function SPIMgr_CalcFCS
   \   00006A   74FE         MOV     A,#-0x2
   \   00006C   25..         ADD     A,?V0 + 0
   \   00006E   F9           MOV     R1,A
   \   00006F   8E82         MOV     DPL,R6
   \   000071   8F83         MOV     DPH,R7
   \   000073   A3           INC     DPTR
   \   000074   AA82         MOV     R2,DPL
   \   000076   AB83         MOV     R3,DPH
   \   000078   12....       LCALL   ??SPIMgr_CalcFCS?relay
   \   00007B   E9           MOV     A,R1
   \   00007C   C0E0         PUSH    A
   \   00007E   85....       MOV     ?V0 + 4,?V0 + 0
   \   000081   75..00       MOV     ?V0 + 5,#0x0
   \   000084   EE           MOV     A,R6
   \   000085   25..         ADD     A,?V0 + 4
   \   000087   F8           MOV     R0,A
   \   000088   EF           MOV     A,R7
   \   000089   35..         ADDC    A,?V0 + 5
   \   00008B   F9           MOV     R1,A
   \   00008C   74FF         MOV     A,#-0x1
   \   00008E   28           ADD     A,R0
   \   00008F   F582         MOV     DPL,A
   \   000091   74FF         MOV     A,#-0x1
   \   000093   39           ADDC    A,R1
   \   000094   F583         MOV     DPH,A
   \   000096   D0E0         POP     A
   \   000098   F0           MOVX    @DPTR,A
    459          
    460          #ifdef SPI_MGR_DEFAULT_PORT
    461                HalUARTWrite ( SPI_MGR_DEFAULT_PORT, msg_ptr, len );
   \   000099                ; Setup parameters for call to function HalUARTWrite
   \   000099   E5..         MOV     A,?V0 + 0
   \   00009B   F5..         MOV     ?V0 + 4,A
   \   00009D   AC..         MOV     R4,?V0 + 4
   \   00009F   7D00         MOV     R5,#0x0
   \   0000A1   EE           MOV     A,R6
   \   0000A2   FA           MOV     R2,A
   \   0000A3   EF           MOV     A,R7
   \   0000A4   FB           MOV     R3,A
   \   0000A5   7900         MOV     R1,#0x0
   \   0000A7   12....       LCALL   ??HalUARTWrite?relay
   \   0000AA   8015         SJMP    ??MT_ProcessCommand_5
    462          #endif
    463                break;
    464          
    465          #if !defined ( NONWK )
    466              case MT_SYS_APP_RSP_MSG:
    467                len = SPI_0DATA_MSG_LEN + msg_ptr[DATALEN_FIELD];
   \                     ??MT_ProcessCommand_4:
   \   0000AC   8E82         MOV     DPL,R6
   \   0000AE   8F83         MOV     DPH,R7
   \   0000B0   A3           INC     DPTR
   \   0000B1   A3           INC     DPTR
   \   0000B2   A3           INC     DPTR
   \   0000B3   E0           MOVX    A,@DPTR
   \   0000B4   2405         ADD     A,#0x5
   \   0000B6   F5..         MOV     ?V0 + 0,A
    468                MTProcessAppRspMsg( msg_ptr, len );
   \   0000B8                ; Setup parameters for call to function MTProcessAppRspMsg
   \   0000B8   A9..         MOV     R1,?V0 + 0
   \   0000BA   EE           MOV     A,R6
   \   0000BB   FA           MOV     R2,A
   \   0000BC   EF           MOV     A,R7
   \   0000BD   FB           MOV     R3,A
   \   0000BE   12....       LCALL   ??MTProcessAppRspMsg?relay
    469                break;
    470          #endif  // NONWK
    471          #endif  // ZTOOL
    472          
    473              default:
    474                break;
    475            }
    476          
    477            if ( deallocate )
   \                     ??MT_ProcessCommand_5:
   \   0000C1   E5..         MOV     A,?V0 + 1
   \   0000C3   6007         JZ      ??MT_ProcessCommand_6
    478            {
    479              osal_msg_deallocate( (uint8 *)msg );
   \   0000C5                ; Setup parameters for call to function osal_msg_deallocate
   \   0000C5   AA..         MOV     R2,?V0 + 2
   \   0000C7   AB..         MOV     R3,?V0 + 3
   \   0000C9   12....       LCALL   ??osal_msg_deallocate?relay
    480            }
    481          }
   \                     ??MT_ProcessCommand_6:
   \   0000CC   7F06         MOV     R7,#0x6
   \   0000CE   02....       LJMP    ?BANKED_LEAVE_XDATA
    482          
    483          #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
    484          /*********************************************************************
    485           * @fn      MT_ProcessDebugMsg
    486           *
    487           * @brief
    488           *
    489           *   Build and send a debug message.
    490           *
    491           * @param   byte *data - pointer to the data portion of the debug message
    492           *
    493           * @return  void
    494           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    495          void MT_ProcessDebugMsg( mtDebugMsg_t *msg )
   \                     MT_ProcessDebugMsg:
    496          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 11
   \   000005   74F5         MOV     A,#-0xb
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   8A..         MOV     ?V0 + 0,R2
   \   00000C   8B..         MOV     ?V0 + 1,R3
    497            byte *msg_ptr;
    498            byte dataLen;
    499            uint8 buf[11];
    500            uint8 *pBuf;
    501          
    502            // Calculate the data length based
    503            dataLen = 5 + (msg->numParams * sizeof ( uint16 ));
   \   00000E   75F002       MOV     B,#0x2
   \   000011   85..82       MOV     DPL,?V0 + 0
   \   000014   85..83       MOV     DPH,?V0 + 1
   \   000017   A3           INC     DPTR
   \   000018   A3           INC     DPTR
   \   000019   A3           INC     DPTR
   \   00001A   A3           INC     DPTR
   \   00001B   E0           MOVX    A,@DPTR
   \   00001C   A4           MUL     AB
   \   00001D   2405         ADD     A,#0x5
   \   00001F   F5..         MOV     ?V0 + 2,A
    504          
    505            // Get a message buffer to build the debug message
    506            msg_ptr = osal_msg_allocate( (byte)(SPI_0DATA_MSG_LEN + dataLen + 1) );
   \   000021                ; Setup parameters for call to function osal_msg_allocate
   \   000021   7406         MOV     A,#0x6
   \   000023   25..         ADD     A,?V0 + 2
   \   000025   F5..         MOV     ?V0 + 3,A
   \   000027   AA..         MOV     R2,?V0 + 3
   \   000029   7B00         MOV     R3,#0x0
   \   00002B   12....       LCALL   ??osal_msg_allocate?relay
   \   00002E   8A..         MOV     ?V0 + 4,R2
   \   000030   8B..         MOV     ?V0 + 5,R3
   \   000032   85....       MOV     ?V0 + 6,?V0 + 4
   \   000035   85....       MOV     ?V0 + 7,?V0 + 5
    507            if ( msg_ptr )
   \   000038   E5..         MOV     A,?V0 + 6
   \   00003A   6400         XRL     A,#0x0
   \   00003C   7004         JNZ     ??MT_ProcessDebugMsg_0
   \   00003E   E5..         MOV     A,?V0 + 7
   \   000040   6400         XRL     A,#0x0
   \                     ??MT_ProcessDebugMsg_0:
   \   000042   7003         JNZ     $+5
   \   000044   02....       LJMP    ??MT_ProcessDebugMsg_1 & 0xFFFF
    508            {
    509              // Build the message
    510              pBuf = buf;
   \   000047   85..82       MOV     DPL,?XSP + 0
   \   00004A   85..83       MOV     DPH,?XSP + 1
   \   00004D   AE82         MOV     R6,DPL
   \   00004F   AF83         MOV     R7,DPH
    511              *pBuf++ = msg->compID;
   \   000051   85..82       MOV     DPL,?V0 + 0
   \   000054   85..83       MOV     DPH,?V0 + 1
   \   000057   A3           INC     DPTR
   \   000058   A3           INC     DPTR
   \   000059   E0           MOVX    A,@DPTR
   \   00005A   8E82         MOV     DPL,R6
   \   00005C   8F83         MOV     DPH,R7
   \   00005E   F0           MOVX    @DPTR,A
   \   00005F   8E82         MOV     DPL,R6
   \   000061   8F83         MOV     DPH,R7
   \   000063   A3           INC     DPTR
   \   000064   AE82         MOV     R6,DPL
   \   000066   AF83         MOV     R7,DPH
    512              *pBuf++ = msg->severity;
   \   000068   85..82       MOV     DPL,?V0 + 0
   \   00006B   85..83       MOV     DPH,?V0 + 1
   \   00006E   A3           INC     DPTR
   \   00006F   A3           INC     DPTR
   \   000070   A3           INC     DPTR
   \   000071   E0           MOVX    A,@DPTR
   \   000072   8E82         MOV     DPL,R6
   \   000074   8F83         MOV     DPH,R7
   \   000076   F0           MOVX    @DPTR,A
   \   000077   8E82         MOV     DPL,R6
   \   000079   8F83         MOV     DPH,R7
   \   00007B   A3           INC     DPTR
   \   00007C   AE82         MOV     R6,DPL
   \   00007E   AF83         MOV     R7,DPH
    513              *pBuf++ = msg->numParams;
   \   000080   85..82       MOV     DPL,?V0 + 0
   \   000083   85..83       MOV     DPH,?V0 + 1
   \   000086   A3           INC     DPTR
   \   000087   A3           INC     DPTR
   \   000088   A3           INC     DPTR
   \   000089   A3           INC     DPTR
   \   00008A   E0           MOVX    A,@DPTR
   \   00008B   8E82         MOV     DPL,R6
   \   00008D   8F83         MOV     DPH,R7
   \   00008F   F0           MOVX    @DPTR,A
   \   000090   8E82         MOV     DPL,R6
   \   000092   8F83         MOV     DPH,R7
   \   000094   A3           INC     DPTR
   \   000095   AE82         MOV     R6,DPL
   \   000097   AF83         MOV     R7,DPH
    514          
    515              if ( msg->numParams >= 1 )
   \   000099   85..82       MOV     DPL,?V0 + 0
   \   00009C   85..83       MOV     DPH,?V0 + 1
   \   00009F   A3           INC     DPTR
   \   0000A0   A3           INC     DPTR
   \   0000A1   A3           INC     DPTR
   \   0000A2   A3           INC     DPTR
   \   0000A3   E0           MOVX    A,@DPTR
   \   0000A4   C3           CLR     C
   \   0000A5   9401         SUBB    A,#0x1
   \   0000A7   4037         JC      ??MT_ProcessDebugMsg_2
    516              {
    517                *pBuf++ = HI_UINT16( msg->param1 );
   \   0000A9   85..82       MOV     DPL,?V0 + 0
   \   0000AC   85..83       MOV     DPH,?V0 + 1
   \   0000AF   A3           INC     DPTR
   \   0000B0   A3           INC     DPTR
   \   0000B1   A3           INC     DPTR
   \   0000B2   A3           INC     DPTR
   \   0000B3   A3           INC     DPTR
   \   0000B4   A3           INC     DPTR
   \   0000B5   E0           MOVX    A,@DPTR
   \   0000B6   F9           MOV     R1,A
   \   0000B7   E9           MOV     A,R1
   \   0000B8   8E82         MOV     DPL,R6
   \   0000BA   8F83         MOV     DPH,R7
   \   0000BC   F0           MOVX    @DPTR,A
   \   0000BD   8E82         MOV     DPL,R6
   \   0000BF   8F83         MOV     DPH,R7
   \   0000C1   A3           INC     DPTR
   \   0000C2   AE82         MOV     R6,DPL
   \   0000C4   AF83         MOV     R7,DPH
    518                *pBuf++ = LO_UINT16( msg->param1 );
   \   0000C6   85..82       MOV     DPL,?V0 + 0
   \   0000C9   85..83       MOV     DPH,?V0 + 1
   \   0000CC   A3           INC     DPTR
   \   0000CD   A3           INC     DPTR
   \   0000CE   A3           INC     DPTR
   \   0000CF   A3           INC     DPTR
   \   0000D0   A3           INC     DPTR
   \   0000D1   E0           MOVX    A,@DPTR
   \   0000D2   8E82         MOV     DPL,R6
   \   0000D4   8F83         MOV     DPH,R7
   \   0000D6   F0           MOVX    @DPTR,A
   \   0000D7   8E82         MOV     DPL,R6
   \   0000D9   8F83         MOV     DPH,R7
   \   0000DB   A3           INC     DPTR
   \   0000DC   AE82         MOV     R6,DPL
   \   0000DE   AF83         MOV     R7,DPH
    519              }
    520          
    521              if ( msg->numParams >= 2 )
   \                     ??MT_ProcessDebugMsg_2:
   \   0000E0   85..82       MOV     DPL,?V0 + 0
   \   0000E3   85..83       MOV     DPH,?V0 + 1
   \   0000E6   A3           INC     DPTR
   \   0000E7   A3           INC     DPTR
   \   0000E8   A3           INC     DPTR
   \   0000E9   A3           INC     DPTR
   \   0000EA   E0           MOVX    A,@DPTR
   \   0000EB   C3           CLR     C
   \   0000EC   9402         SUBB    A,#0x2
   \   0000EE   403B         JC      ??MT_ProcessDebugMsg_3
    522              {
    523                *pBuf++ = HI_UINT16( msg->param2 );
   \   0000F0   85..82       MOV     DPL,?V0 + 0
   \   0000F3   85..83       MOV     DPH,?V0 + 1
   \   0000F6   A3           INC     DPTR
   \   0000F7   A3           INC     DPTR
   \   0000F8   A3           INC     DPTR
   \   0000F9   A3           INC     DPTR
   \   0000FA   A3           INC     DPTR
   \   0000FB   A3           INC     DPTR
   \   0000FC   A3           INC     DPTR
   \   0000FD   A3           INC     DPTR
   \   0000FE   E0           MOVX    A,@DPTR
   \   0000FF   F9           MOV     R1,A
   \   000100   E9           MOV     A,R1
   \   000101   8E82         MOV     DPL,R6
   \   000103   8F83         MOV     DPH,R7
   \   000105   F0           MOVX    @DPTR,A
   \   000106   8E82         MOV     DPL,R6
   \   000108   8F83         MOV     DPH,R7
   \   00010A   A3           INC     DPTR
   \   00010B   AE82         MOV     R6,DPL
   \   00010D   AF83         MOV     R7,DPH
    524                *pBuf++ = LO_UINT16( msg->param2 );
   \   00010F   85..82       MOV     DPL,?V0 + 0
   \   000112   85..83       MOV     DPH,?V0 + 1
   \   000115   A3           INC     DPTR
   \   000116   A3           INC     DPTR
   \   000117   A3           INC     DPTR
   \   000118   A3           INC     DPTR
   \   000119   A3           INC     DPTR
   \   00011A   A3           INC     DPTR
   \   00011B   A3           INC     DPTR
   \   00011C   E0           MOVX    A,@DPTR
   \   00011D   8E82         MOV     DPL,R6
   \   00011F   8F83         MOV     DPH,R7
   \   000121   F0           MOVX    @DPTR,A
   \   000122   8E82         MOV     DPL,R6
   \   000124   8F83         MOV     DPH,R7
   \   000126   A3           INC     DPTR
   \   000127   AE82         MOV     R6,DPL
   \   000129   AF83         MOV     R7,DPH
    525              }
    526          
    527              if ( msg->numParams == 3 )
   \                     ??MT_ProcessDebugMsg_3:
   \   00012B   85..82       MOV     DPL,?V0 + 0
   \   00012E   85..83       MOV     DPH,?V0 + 1
   \   000131   A3           INC     DPTR
   \   000132   A3           INC     DPTR
   \   000133   A3           INC     DPTR
   \   000134   A3           INC     DPTR
   \   000135   E0           MOVX    A,@DPTR
   \   000136   6403         XRL     A,#0x3
   \   000138   703F         JNZ     ??MT_ProcessDebugMsg_4
    528              {
    529                *pBuf++ = HI_UINT16( msg->param3 );
   \   00013A   85..82       MOV     DPL,?V0 + 0
   \   00013D   85..83       MOV     DPH,?V0 + 1
   \   000140   A3           INC     DPTR
   \   000141   A3           INC     DPTR
   \   000142   A3           INC     DPTR
   \   000143   A3           INC     DPTR
   \   000144   A3           INC     DPTR
   \   000145   A3           INC     DPTR
   \   000146   A3           INC     DPTR
   \   000147   A3           INC     DPTR
   \   000148   A3           INC     DPTR
   \   000149   A3           INC     DPTR
   \   00014A   E0           MOVX    A,@DPTR
   \   00014B   F9           MOV     R1,A
   \   00014C   E9           MOV     A,R1
   \   00014D   8E82         MOV     DPL,R6
   \   00014F   8F83         MOV     DPH,R7
   \   000151   F0           MOVX    @DPTR,A
   \   000152   8E82         MOV     DPL,R6
   \   000154   8F83         MOV     DPH,R7
   \   000156   A3           INC     DPTR
   \   000157   AE82         MOV     R6,DPL
   \   000159   AF83         MOV     R7,DPH
    530                *pBuf++ = LO_UINT16( msg->param3 );
   \   00015B   85..82       MOV     DPL,?V0 + 0
   \   00015E   85..83       MOV     DPH,?V0 + 1
   \   000161   A3           INC     DPTR
   \   000162   A3           INC     DPTR
   \   000163   A3           INC     DPTR
   \   000164   A3           INC     DPTR
   \   000165   A3           INC     DPTR
   \   000166   A3           INC     DPTR
   \   000167   A3           INC     DPTR
   \   000168   A3           INC     DPTR
   \   000169   A3           INC     DPTR
   \   00016A   E0           MOVX    A,@DPTR
   \   00016B   8E82         MOV     DPL,R6
   \   00016D   8F83         MOV     DPH,R7
   \   00016F   F0           MOVX    @DPTR,A
   \   000170   8E82         MOV     DPL,R6
   \   000172   8F83         MOV     DPH,R7
   \   000174   A3           INC     DPTR
   \   000175   AE82         MOV     R6,DPL
   \   000177   AF83         MOV     R7,DPH
    531              }
    532          
    533              *pBuf++ = HI_UINT16( msg->timestamp );
   \                     ??MT_ProcessDebugMsg_4:
   \   000179   E5..         MOV     A,?V0 + 0
   \   00017B   240B         ADD     A,#0xb
   \   00017D   F582         MOV     DPL,A
   \   00017F   E5..         MOV     A,?V0 + 1
   \   000181   3400         ADDC    A,#0x0
   \   000183   F583         MOV     DPH,A
   \   000185   A3           INC     DPTR
   \   000186   E0           MOVX    A,@DPTR
   \   000187   F9           MOV     R1,A
   \   000188   E9           MOV     A,R1
   \   000189   8E82         MOV     DPL,R6
   \   00018B   8F83         MOV     DPH,R7
   \   00018D   F0           MOVX    @DPTR,A
   \   00018E   8E82         MOV     DPL,R6
   \   000190   8F83         MOV     DPH,R7
   \   000192   A3           INC     DPTR
   \   000193   AE82         MOV     R6,DPL
   \   000195   AF83         MOV     R7,DPH
    534              *pBuf++ = LO_UINT16( msg->timestamp );
   \   000197   E5..         MOV     A,?V0 + 0
   \   000199   240B         ADD     A,#0xb
   \   00019B   F582         MOV     DPL,A
   \   00019D   E5..         MOV     A,?V0 + 1
   \   00019F   3400         ADDC    A,#0x0
   \   0001A1   F583         MOV     DPH,A
   \   0001A3   E0           MOVX    A,@DPTR
   \   0001A4   8E82         MOV     DPL,R6
   \   0001A6   8F83         MOV     DPH,R7
   \   0001A8   F0           MOVX    @DPTR,A
    535          
    536          #ifdef SPI_MGR_DEFAULT_PORT
    537              MT_BuildSPIMsg( SPI_CMD_DEBUG_MSG, &msg_ptr[1], dataLen, buf );
   \   0001A9                ; Setup parameters for call to function MT_BuildSPIMsg
   \   0001A9   85..82       MOV     DPL,?XSP + 0
   \   0001AC   85..83       MOV     DPH,?XSP + 1
   \   0001AF   8582..       MOV     ?V0 + 4,DPL
   \   0001B2   8583..       MOV     ?V0 + 5,DPH
   \   0001B5   78..         MOV     R0,#?V0 + 4
   \   0001B7   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0001BA   A9..         MOV     R1,?V0 + 2
   \   0001BC   85..82       MOV     DPL,?V0 + 6
   \   0001BF   85..83       MOV     DPH,?V0 + 7
   \   0001C2   A3           INC     DPTR
   \   0001C3   AC82         MOV     R4,DPL
   \   0001C5   AD83         MOV     R5,DPH
   \   0001C7   7A03         MOV     R2,#0x3
   \   0001C9   7B40         MOV     R3,#0x40
   \   0001CB   12....       LCALL   ??MT_BuildSPIMsg?relay
   \   0001CE   7402         MOV     A,#0x2
   \   0001D0   12....       LCALL   ?DEALLOC_XSTACK8
    538              HalUARTWrite ( SPI_MGR_DEFAULT_PORT, &msg_ptr[1], SPI_0DATA_MSG_LEN + dataLen );
   \   0001D3                ; Setup parameters for call to function HalUARTWrite
   \   0001D3   85....       MOV     ?V0 + 4,?V0 + 2
   \   0001D6   75..00       MOV     ?V0 + 5,#0x0
   \   0001D9   7405         MOV     A,#0x5
   \   0001DB   25..         ADD     A,?V0 + 4
   \   0001DD   FC           MOV     R4,A
   \   0001DE   7400         MOV     A,#0x0
   \   0001E0   35..         ADDC    A,?V0 + 5
   \   0001E2   FD           MOV     R5,A
   \   0001E3   85..82       MOV     DPL,?V0 + 6
   \   0001E6   85..83       MOV     DPH,?V0 + 7
   \   0001E9   A3           INC     DPTR
   \   0001EA   AA82         MOV     R2,DPL
   \   0001EC   AB83         MOV     R3,DPH
   \   0001EE   7900         MOV     R1,#0x0
   \   0001F0   12....       LCALL   ??HalUARTWrite?relay
    539          #endif
    540              osal_msg_deallocate( msg_ptr );
   \   0001F3                ; Setup parameters for call to function osal_msg_deallocate
   \   0001F3   AA..         MOV     R2,?V0 + 6
   \   0001F5   AB..         MOV     R3,?V0 + 7
   \   0001F7   12....       LCALL   ??osal_msg_deallocate?relay
    541            }
    542          }
   \                     ??MT_ProcessDebugMsg_1:
   \   0001FA   740B         MOV     A,#0xb
   \   0001FC   12....       LCALL   ?DEALLOC_XSTACK8
   \   0001FF   7F08         MOV     R7,#0x8
   \   000201   02....       LJMP    ?BANKED_LEAVE_XDATA
    543          #endif // ZTOOL
    544          
    545          #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
    546          /*********************************************************************
    547           * @fn      MT_ProcessDebugStr
    548           *
    549           * @brief
    550           *
    551           *   Build and send a debug string.
    552           *
    553           * @param   byte *dstr - pointer to the data portion of the debug message
    554           *
    555           * @return  void
    556           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    557          void MT_ProcessDebugStr( mtDebugStr_t *dstr )
   \                     MT_ProcessDebugStr:
    558          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   \   000005   8A..         MOV     ?V0 + 0,R2
   \   000007   8B..         MOV     ?V0 + 1,R3
    559            byte *msg_ptr;
    560          
    561            // Get a message buffer to build the debug message
    562            msg_ptr = osal_mem_alloc( (byte)(SPI_0DATA_MSG_LEN + dstr->sln) );
   \   000009                ; Setup parameters for call to function osal_mem_alloc
   \   000009   85..82       MOV     DPL,?V0 + 0
   \   00000C   85..83       MOV     DPH,?V0 + 1
   \   00000F   A3           INC     DPTR
   \   000010   A3           INC     DPTR
   \   000011   E0           MOVX    A,@DPTR
   \   000012   2405         ADD     A,#0x5
   \   000014   F5..         MOV     ?V0 + 2,A
   \   000016   AA..         MOV     R2,?V0 + 2
   \   000018   7B00         MOV     R3,#0x0
   \   00001A   12....       LCALL   ??osal_mem_alloc?relay
   \   00001D   8A..         MOV     ?V0 + 2,R2
   \   00001F   8B..         MOV     ?V0 + 3,R3
   \   000021   AE..         MOV     R6,?V0 + 2
   \   000023   AF..         MOV     R7,?V0 + 3
    563            if ( msg_ptr )
   \   000025   EE           MOV     A,R6
   \   000026   6400         XRL     A,#0x0
   \   000028   7003         JNZ     ??MT_ProcessDebugStr_0
   \   00002A   EF           MOV     A,R7
   \   00002B   6400         XRL     A,#0x0
   \                     ??MT_ProcessDebugStr_0:
   \   00002D   604A         JZ      ??MT_ProcessDebugStr_1
    564            {
    565          #ifdef SPI_MGR_DEFAULT_PORT
    566              MT_BuildSPIMsg( SPI_RESPONSE_BIT | SPI_SYS_STRING_MSG, msg_ptr, dstr->sln, dstr->pString );
   \   00002F                ; Setup parameters for call to function MT_BuildSPIMsg
   \   00002F   85..82       MOV     DPL,?V0 + 0
   \   000032   85..83       MOV     DPH,?V0 + 1
   \   000035   A3           INC     DPTR
   \   000036   A3           INC     DPTR
   \   000037   A3           INC     DPTR
   \   000038   12....       LCALL   ?PUSH_XSTACK8_X_TWO
   \   00003B   85..82       MOV     DPL,?V0 + 0
   \   00003E   85..83       MOV     DPH,?V0 + 1
   \   000041   A3           INC     DPTR
   \   000042   A3           INC     DPTR
   \   000043   E0           MOVX    A,@DPTR
   \   000044   F9           MOV     R1,A
   \   000045   EE           MOV     A,R6
   \   000046   FC           MOV     R4,A
   \   000047   EF           MOV     A,R7
   \   000048   FD           MOV     R5,A
   \   000049   7A15         MOV     R2,#0x15
   \   00004B   7B10         MOV     R3,#0x10
   \   00004D   12....       LCALL   ??MT_BuildSPIMsg?relay
   \   000050   7402         MOV     A,#0x2
   \   000052   12....       LCALL   ?DEALLOC_XSTACK8
    567              HalUARTWrite ( SPI_MGR_DEFAULT_PORT, msg_ptr, SPI_0DATA_MSG_LEN + dstr->sln );
   \   000055                ; Setup parameters for call to function HalUARTWrite
   \   000055   85..82       MOV     DPL,?V0 + 0
   \   000058   85..83       MOV     DPH,?V0 + 1
   \   00005B   A3           INC     DPTR
   \   00005C   A3           INC     DPTR
   \   00005D   E0           MOVX    A,@DPTR
   \   00005E   F8           MOV     R0,A
   \   00005F   7900         MOV     R1,#0x0
   \   000061   7405         MOV     A,#0x5
   \   000063   28           ADD     A,R0
   \   000064   FC           MOV     R4,A
   \   000065   7400         MOV     A,#0x0
   \   000067   39           ADDC    A,R1
   \   000068   FD           MOV     R5,A
   \   000069   EE           MOV     A,R6
   \   00006A   FA           MOV     R2,A
   \   00006B   EF           MOV     A,R7
   \   00006C   FB           MOV     R3,A
   \   00006D   7900         MOV     R1,#0x0
   \   00006F   12....       LCALL   ??HalUARTWrite?relay
    568          #endif
    569              osal_mem_free( msg_ptr );
   \   000072                ; Setup parameters for call to function osal_mem_free
   \   000072   EE           MOV     A,R6
   \   000073   FA           MOV     R2,A
   \   000074   EF           MOV     A,R7
   \   000075   FB           MOV     R3,A
   \   000076   12....       LCALL   ??osal_mem_free?relay
    570            }
    571          }
   \                     ??MT_ProcessDebugStr_1:
   \   000079   7F04         MOV     R7,#0x4
   \   00007B   02....       LJMP    ?BANKED_LEAVE_XDATA
    572          #endif // ZTOOL
    573          
    574          #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
    575          /*********************************************************************
    576           * @fn      MT_ProcessSetNV
    577           *
    578           * @brief
    579           *
    580           *   The Set NV serial message.
    581           *
    582           * @param   byte *msg - pointer to the data
    583           *
    584           * @return  ZSuccess if successful
    585           *
    586           * @MT SPI_CMD_SYS_SET_NV
    587           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    588          byte MT_ProcessSetNV( byte *pData )
   \                     MT_ProcessSetNV:
    589          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   \   000005   8A..         MOV     ?V0 + 0,R2
   \   000007   8B..         MOV     ?V0 + 1,R3
    590            uint16  attrib;
    591            uint16  attlen;
    592          
    593            attrib = (uint16) *pData;
   \   000009   85..82       MOV     DPL,?V0 + 0
   \   00000C   85..83       MOV     DPH,?V0 + 1
   \   00000F   E0           MOVX    A,@DPTR
   \   000010   7900         MOV     R1,#0x0
   \   000012   FE           MOV     R6,A
   \   000013   E9           MOV     A,R1
   \   000014   FF           MOV     R7,A
    594            pData += 2;   // skip additional byte containing len field
   \   000015   E5..         MOV     A,?V0 + 0
   \   000017   2402         ADD     A,#0x2
   \   000019   F5..         MOV     ?V0 + 0,A
   \   00001B   E5..         MOV     A,?V0 + 1
   \   00001D   3400         ADDC    A,#0x0
   \   00001F   F5..         MOV     ?V0 + 1,A
    595            attlen = osal_nv_item_len( attrib );
   \   000021                ; Setup parameters for call to function osal_nv_item_len
   \   000021   EE           MOV     A,R6
   \   000022   FA           MOV     R2,A
   \   000023   EF           MOV     A,R7
   \   000024   FB           MOV     R3,A
   \   000025   12....       LCALL   ??osal_nv_item_len?relay
   \   000028   8A..         MOV     ?V0 + 4,R2
   \   00002A   8B..         MOV     ?V0 + 5,R3
   \   00002C   85....       MOV     ?V0 + 2,?V0 + 4
   \   00002F   85....       MOV     ?V0 + 3,?V0 + 5
    596          
    597            return osal_nv_write( attrib, 0, attlen, pData );
   \   000032                ; Setup parameters for call to function osal_nv_write
   \   000032   78..         MOV     R0,#?V0 + 0
   \   000034   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000037   78..         MOV     R0,#?V0 + 2
   \   000039   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00003C   7C00         MOV     R4,#0x0
   \   00003E   7D00         MOV     R5,#0x0
   \   000040   EE           MOV     A,R6
   \   000041   FA           MOV     R2,A
   \   000042   EF           MOV     A,R7
   \   000043   FB           MOV     R3,A
   \   000044   12....       LCALL   ??osal_nv_write?relay
   \   000047   7404         MOV     A,#0x4
   \   000049   12....       LCALL   ?DEALLOC_XSTACK8
   \   00004C   7F06         MOV     R7,#0x6
   \   00004E   02....       LJMP    ?BANKED_LEAVE_XDATA
    598          }
    599          #endif
    600          
    601          #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
    602          /*********************************************************************
    603           * @fn      MT_ProcessGetNV
    604           *
    605           * @brief
    606           *
    607           *   The Get NV serial message.
    608           *
    609           * @param   byte *msg - pointer to the data
    610           *
    611           * @return  void
    612           *
    613           * @MT SPI_CMD_SYS_GET_NV
    614           *
    615           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    616          void MT_ProcessGetNV( byte *pData )
   \                     MT_ProcessGetNV:
    617          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 2
   \   000005   74FE         MOV     A,#-0x2
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   85..82       MOV     DPL,?XSP + 0
   \   00000D   85..83       MOV     DPH,?XSP + 1
   \   000010   EA           MOV     A,R2
   \   000011   F0           MOVX    @DPTR,A
   \   000012   A3           INC     DPTR
   \   000013   EB           MOV     A,R3
   \   000014   F0           MOVX    @DPTR,A
    618            uint16  attrib;
    619            uint16 attlen;
    620            uint16 buflen;
    621            uint8 *buf;
    622          
    623            attrib = (uint16)*pData;
   \   000015   85..82       MOV     DPL,?XSP + 0
   \   000018   85..83       MOV     DPH,?XSP + 1
   \   00001B   E0           MOVX    A,@DPTR
   \   00001C   F8           MOV     R0,A
   \   00001D   A3           INC     DPTR
   \   00001E   E0           MOVX    A,@DPTR
   \   00001F   F583         MOV     DPH,A
   \   000021   8882         MOV     DPL,R0
   \   000023   E0           MOVX    A,@DPTR
   \   000024   F8           MOV     R0,A
   \   000025   7900         MOV     R1,#0x0
   \   000027   88..         MOV     ?V0 + 2,R0
   \   000029   89..         MOV     ?V0 + 3,R1
    624            attlen = osal_nv_item_len( attrib );
   \   00002B                ; Setup parameters for call to function osal_nv_item_len
   \   00002B   AA..         MOV     R2,?V0 + 2
   \   00002D   AB..         MOV     R3,?V0 + 3
   \   00002F   12....       LCALL   ??osal_nv_item_len?relay
   \   000032   8A..         MOV     ?V0 + 4,R2
   \   000034   8B..         MOV     ?V0 + 5,R3
   \   000036   85....       MOV     ?V0 + 0,?V0 + 4
   \   000039   85....       MOV     ?V0 + 1,?V0 + 5
    625          
    626            buflen = attlen + 3;
   \   00003C   7403         MOV     A,#0x3
   \   00003E   25..         ADD     A,?V0 + 0
   \   000040   F8           MOV     R0,A
   \   000041   7400         MOV     A,#0x0
   \   000043   35..         ADDC    A,?V0 + 1
   \   000045   F9           MOV     R1,A
   \   000046   E8           MOV     A,R0
   \   000047   FE           MOV     R6,A
   \   000048   E9           MOV     A,R1
   \   000049   FF           MOV     R7,A
    627            buf = osal_mem_alloc( buflen );
   \   00004A                ; Setup parameters for call to function osal_mem_alloc
   \   00004A   EE           MOV     A,R6
   \   00004B   FA           MOV     R2,A
   \   00004C   EF           MOV     A,R7
   \   00004D   FB           MOV     R3,A
   \   00004E   12....       LCALL   ??osal_mem_alloc?relay
   \   000051   8A..         MOV     ?V0 + 4,R2
   \   000053   8B..         MOV     ?V0 + 5,R3
   \   000055   85....       MOV     ?V0 + 6,?V0 + 4
   \   000058   85....       MOV     ?V0 + 7,?V0 + 5
    628            if ( buf != NULL )
   \   00005B   E5..         MOV     A,?V0 + 6
   \   00005D   6400         XRL     A,#0x0
   \   00005F   7004         JNZ     ??MT_ProcessGetNV_0
   \   000061   E5..         MOV     A,?V0 + 7
   \   000063   6400         XRL     A,#0x0
   \                     ??MT_ProcessGetNV_0:
   \   000065   606E         JZ      ??MT_ProcessGetNV_1
    629            {
    630              osal_memset( buf, 0, buflen );
   \   000067                ; Setup parameters for call to function osal_memset
   \   000067   EE           MOV     A,R6
   \   000068   FC           MOV     R4,A
   \   000069   EF           MOV     A,R7
   \   00006A   FD           MOV     R5,A
   \   00006B   7900         MOV     R1,#0x0
   \   00006D   AA..         MOV     R2,?V0 + 6
   \   00006F   AB..         MOV     R3,?V0 + 7
   \   000071   12....       LCALL   ??osal_memset?relay
    631          
    632              buf[0] = osal_nv_read( attrib, 0, attlen, &buf[3] );
   \   000074                ; Setup parameters for call to function osal_nv_read
   \   000074   E5..         MOV     A,?V0 + 6
   \   000076   2403         ADD     A,#0x3
   \   000078   F5..         MOV     ?V0 + 4,A
   \   00007A   E5..         MOV     A,?V0 + 7
   \   00007C   3400         ADDC    A,#0x0
   \   00007E   F5..         MOV     ?V0 + 5,A
   \   000080   78..         MOV     R0,#?V0 + 4
   \   000082   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000085   78..         MOV     R0,#?V0 + 0
   \   000087   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00008A   7C00         MOV     R4,#0x0
   \   00008C   7D00         MOV     R5,#0x0
   \   00008E   AA..         MOV     R2,?V0 + 2
   \   000090   AB..         MOV     R3,?V0 + 3
   \   000092   12....       LCALL   ??osal_nv_read?relay
   \   000095   7404         MOV     A,#0x4
   \   000097   12....       LCALL   ?DEALLOC_XSTACK8
   \   00009A   E9           MOV     A,R1
   \   00009B   85..82       MOV     DPL,?V0 + 6
   \   00009E   85..83       MOV     DPH,?V0 + 7
   \   0000A1   F0           MOVX    @DPTR,A
    633              buf[1] = (uint8)attrib;
   \   0000A2   85..82       MOV     DPL,?V0 + 6
   \   0000A5   85..83       MOV     DPH,?V0 + 7
   \   0000A8   A3           INC     DPTR
   \   0000A9   E5..         MOV     A,?V0 + 2
   \   0000AB   F0           MOVX    @DPTR,A
    634              buf[2] = attlen;
   \   0000AC   85..82       MOV     DPL,?V0 + 6
   \   0000AF   85..83       MOV     DPH,?V0 + 7
   \   0000B2   A3           INC     DPTR
   \   0000B3   A3           INC     DPTR
   \   0000B4   E5..         MOV     A,?V0 + 0
   \   0000B6   F0           MOVX    @DPTR,A
    635          
    636              MT_BuildAndSendZToolResponse( (SPI_0DATA_MSG_LEN + buflen),
    637                                            (SPI_RESPONSE_BIT | SPI_CMD_SYS_GET_NV),
    638                                            buflen, buf );
   \   0000B7                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   0000B7   78..         MOV     R0,#?V0 + 6
   \   0000B9   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000BC   EE           MOV     A,R6
   \   0000BD   FC           MOV     R4,A
   \   0000BE   7A13         MOV     R2,#0x13
   \   0000C0   7B10         MOV     R3,#0x10
   \   0000C2   EE           MOV     A,R6
   \   0000C3   2405         ADD     A,#0x5
   \   0000C5   F9           MOV     R1,A
   \   0000C6   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
   \   0000C9   7402         MOV     A,#0x2
   \   0000CB   12....       LCALL   ?DEALLOC_XSTACK8
    639              osal_mem_free( buf );
   \   0000CE                ; Setup parameters for call to function osal_mem_free
   \   0000CE   AA..         MOV     R2,?V0 + 6
   \   0000D0   AB..         MOV     R3,?V0 + 7
   \   0000D2   12....       LCALL   ??osal_mem_free?relay
    640            }
    641          }
   \                     ??MT_ProcessGetNV_1:
   \   0000D5   7402         MOV     A,#0x2
   \   0000D7   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000DA   7F08         MOV     R7,#0x8
   \   0000DC   02....       LJMP    ?BANKED_LEAVE_XDATA
    642          #endif
    643          
    644          #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
    645          #if !defined ( NONWK )
    646          /***************************************************************************************************
    647           * @fn      MT_ProcessGetNvInfo
    648           *
    649           * @brief
    650           *
    651           *   The Get NV Info serial message.
    652           *
    653           * @param   byte *msg - pointer to the data
    654           *
    655           * @return  void
    656           *
    657           * @MT SPI_CMD_SYS_GET_NV_INFO
    658           *
    659           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    660          void MT_ProcessGetNvInfo( void )
   \                     MT_ProcessGetNvInfo:
    661          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 8
   \   000005   74F8         MOV     A,#-0x8
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    662            uint8 len;
    663            uint8 stat;
    664            uint8 *buf;
    665            uint8 *pBuf;
    666            uint16 tmp16;
    667            uint32 tmp32;
    668          
    669            // Get required length of buffer
    670            // Status + ExtAddr + ChanList + PanID  + SecLevel + PreCfgKey
    671            len = 1 + Z_EXTADDR_LEN + 4 + 2 + 1 + SEC_KEY_LEN;
   \   00000A   7F20         MOV     R7,#0x20
    672          
    673            buf = osal_mem_alloc( len );
   \   00000C                ; Setup parameters for call to function osal_mem_alloc
   \   00000C   EF           MOV     A,R7
   \   00000D   F5..         MOV     ?V0 + 2,A
   \   00000F   AA..         MOV     R2,?V0 + 2
   \   000011   7B00         MOV     R3,#0x0
   \   000013   12....       LCALL   ??osal_mem_alloc?relay
   \   000016   85..82       MOV     DPL,?XSP + 0
   \   000019   85..83       MOV     DPH,?XSP + 1
   \   00001C   EA           MOV     A,R2
   \   00001D   F0           MOVX    @DPTR,A
   \   00001E   A3           INC     DPTR
   \   00001F   EB           MOV     A,R3
   \   000020   F0           MOVX    @DPTR,A
    674            if ( buf )
   \   000021   85..82       MOV     DPL,?XSP + 0
   \   000024   85..83       MOV     DPH,?XSP + 1
   \   000027   E0           MOVX    A,@DPTR
   \   000028   6400         XRL     A,#0x0
   \   00002A   7004         JNZ     ??MT_ProcessGetNvInfo_0
   \   00002C   A3           INC     DPTR
   \   00002D   E0           MOVX    A,@DPTR
   \   00002E   6400         XRL     A,#0x0
   \                     ??MT_ProcessGetNvInfo_0:
   \   000030   7003         JNZ     $+5
   \   000032   02....       LJMP    ??MT_ProcessGetNvInfo_1 & 0xFFFF
    675            {
    676              // Assume NV not available
    677              osal_memset( buf, 0xFF, len );
   \   000035                ; Setup parameters for call to function osal_memset
   \   000035   EF           MOV     A,R7
   \   000036   F5..         MOV     ?V0 + 2,A
   \   000038   AC..         MOV     R4,?V0 + 2
   \   00003A   7D00         MOV     R5,#0x0
   \   00003C   79FF         MOV     R1,#-0x1
   \   00003E   85..82       MOV     DPL,?XSP + 0
   \   000041   85..83       MOV     DPH,?XSP + 1
   \   000044   E0           MOVX    A,@DPTR
   \   000045   FA           MOV     R2,A
   \   000046   A3           INC     DPTR
   \   000047   E0           MOVX    A,@DPTR
   \   000048   FB           MOV     R3,A
   \   000049   12....       LCALL   ??osal_memset?relay
    678          
    679              // Skip over status
    680              pBuf = buf + 1;
   \   00004C   85..82       MOV     DPL,?XSP + 0
   \   00004F   85..83       MOV     DPH,?XSP + 1
   \   000052   E0           MOVX    A,@DPTR
   \   000053   2401         ADD     A,#0x1
   \   000055   F8           MOV     R0,A
   \   000056   A3           INC     DPTR
   \   000057   E0           MOVX    A,@DPTR
   \   000058   3400         ADDC    A,#0x0
   \   00005A   F9           MOV     R1,A
   \   00005B   88..         MOV     ?V0 + 0,R0
   \   00005D   89..         MOV     ?V0 + 1,R1
    681          
    682              // Start with 64-bit extended address
    683              stat = osal_nv_read( ZCD_NV_EXTADDR, 0, Z_EXTADDR_LEN, pBuf );
   \   00005F                ; Setup parameters for call to function osal_nv_read
   \   00005F   78..         MOV     R0,#?V0 + 0
   \   000061   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000064   75..08       MOV     ?V0 + 2,#0x8
   \   000067   75..00       MOV     ?V0 + 3,#0x0
   \   00006A   78..         MOV     R0,#?V0 + 2
   \   00006C   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00006F   7C00         MOV     R4,#0x0
   \   000071   7D00         MOV     R5,#0x0
   \   000073   7A01         MOV     R2,#0x1
   \   000075   7B00         MOV     R3,#0x0
   \   000077   12....       LCALL   ??osal_nv_read?relay
   \   00007A   7404         MOV     A,#0x4
   \   00007C   12....       LCALL   ?DEALLOC_XSTACK8
   \   00007F   E9           MOV     A,R1
   \   000080   FE           MOV     R6,A
    684              if ( stat ) stat = 0x01;
   \   000081   EE           MOV     A,R6
   \   000082   6002         JZ      ??MT_ProcessGetNvInfo_2
   \   000084   7E01         MOV     R6,#0x1
    685              MT_ReverseBytes( pBuf, Z_EXTADDR_LEN );
   \                     ??MT_ProcessGetNvInfo_2:
   \   000086                ; Setup parameters for call to function MT_ReverseBytes
   \   000086   7908         MOV     R1,#0x8
   \   000088   AA..         MOV     R2,?V0 + 0
   \   00008A   AB..         MOV     R3,?V0 + 1
   \   00008C   12....       LCALL   ??MT_ReverseBytes?relay
    686              pBuf += Z_EXTADDR_LEN;
   \   00008F   E5..         MOV     A,?V0 + 0
   \   000091   2408         ADD     A,#0x8
   \   000093   F5..         MOV     ?V0 + 0,A
   \   000095   E5..         MOV     A,?V0 + 1
   \   000097   3400         ADDC    A,#0x0
   \   000099   F5..         MOV     ?V0 + 1,A
    687          
    688              // Scan channel list (bit mask)
    689              if (  osal_nv_read( ZCD_NV_CHANLIST, 0, sizeof( tmp32 ), &tmp32 ) )
   \   00009B                ; Setup parameters for call to function osal_nv_read
   \   00009B   7404         MOV     A,#0x4
   \   00009D   12....       LCALL   ?XSTACK_DISP0_8
   \   0000A0   8582..       MOV     ?V0 + 2,DPL
   \   0000A3   8583..       MOV     ?V0 + 3,DPH
   \   0000A6   78..         MOV     R0,#?V0 + 2
   \   0000A8   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000AB   75..04       MOV     ?V0 + 2,#0x4
   \   0000AE   75..00       MOV     ?V0 + 3,#0x0
   \   0000B1   78..         MOV     R0,#?V0 + 2
   \   0000B3   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000B6   7C00         MOV     R4,#0x0
   \   0000B8   7D00         MOV     R5,#0x0
   \   0000BA   7A84         MOV     R2,#-0x7c
   \   0000BC   7B00         MOV     R3,#0x0
   \   0000BE   12....       LCALL   ??osal_nv_read?relay
   \   0000C1   7404         MOV     A,#0x4
   \   0000C3   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000C6   E9           MOV     A,R1
   \   0000C7   6007         JZ      ??MT_ProcessGetNvInfo_3
    690                stat |= 0x02;
   \   0000C9   D3           SETB    C
   \   0000CA   EE           MOV     A,R6
   \   0000CB   92E1         MOV     0xE0 /* A   */.1,C
   \   0000CD   FE           MOV     R6,A
   \   0000CE   8064         SJMP    ??MT_ProcessGetNvInfo_4
    691              else
    692              {
    693                pBuf[0] = BREAK_UINT32( tmp32, 3 );
   \                     ??MT_ProcessGetNvInfo_3:
   \   0000D0   7404         MOV     A,#0x4
   \   0000D2   12....       LCALL   ?XSTACK_DISP0_8
   \   0000D5   78..         MOV     R0,#?V0 + 4
   \   0000D7   12....       LCALL   ?L_MOV_X
   \   0000DA   7418         MOV     A,#0x18
   \   0000DC   78..         MOV     R0,#?V0 + 4
   \   0000DE   12....       LCALL   ?UL_SHR
   \   0000E1   85..82       MOV     DPL,?V0 + 0
   \   0000E4   85..83       MOV     DPH,?V0 + 1
   \   0000E7   E5..         MOV     A,?V0 + 4
   \   0000E9   F0           MOVX    @DPTR,A
    694                pBuf[1] = BREAK_UINT32( tmp32, 2 );
   \   0000EA   7404         MOV     A,#0x4
   \   0000EC   12....       LCALL   ?XSTACK_DISP0_8
   \   0000EF   78..         MOV     R0,#?V0 + 4
   \   0000F1   12....       LCALL   ?L_MOV_X
   \   0000F4   7410         MOV     A,#0x10
   \   0000F6   78..         MOV     R0,#?V0 + 4
   \   0000F8   12....       LCALL   ?UL_SHR
   \   0000FB   85..82       MOV     DPL,?V0 + 0
   \   0000FE   85..83       MOV     DPH,?V0 + 1
   \   000101   A3           INC     DPTR
   \   000102   E5..         MOV     A,?V0 + 4
   \   000104   F0           MOVX    @DPTR,A
    695                pBuf[2] = BREAK_UINT32( tmp32, 1 );
   \   000105   7404         MOV     A,#0x4
   \   000107   12....       LCALL   ?XSTACK_DISP0_8
   \   00010A   78..         MOV     R0,#?V0 + 4
   \   00010C   12....       LCALL   ?L_MOV_X
   \   00010F   E5..         MOV     A,?V0 + 5
   \   000111   F5..         MOV     ?V0 + 4,A
   \   000113   85..82       MOV     DPL,?V0 + 0
   \   000116   85..83       MOV     DPH,?V0 + 1
   \   000119   A3           INC     DPTR
   \   00011A   A3           INC     DPTR
   \   00011B   E5..         MOV     A,?V0 + 4
   \   00011D   F0           MOVX    @DPTR,A
    696                pBuf[3] = BREAK_UINT32( tmp32, 0 );
   \   00011E   7404         MOV     A,#0x4
   \   000120   12....       LCALL   ?XSTACK_DISP0_8
   \   000123   78..         MOV     R0,#?V0 + 4
   \   000125   12....       LCALL   ?L_MOV_X
   \   000128   85..82       MOV     DPL,?V0 + 0
   \   00012B   85..83       MOV     DPH,?V0 + 1
   \   00012E   A3           INC     DPTR
   \   00012F   A3           INC     DPTR
   \   000130   A3           INC     DPTR
   \   000131   E5..         MOV     A,?V0 + 4
   \   000133   F0           MOVX    @DPTR,A
    697              }
    698              pBuf += sizeof( tmp32 );
   \                     ??MT_ProcessGetNvInfo_4:
   \   000134   E5..         MOV     A,?V0 + 0
   \   000136   2404         ADD     A,#0x4
   \   000138   F5..         MOV     ?V0 + 0,A
   \   00013A   E5..         MOV     A,?V0 + 1
   \   00013C   3400         ADDC    A,#0x0
   \   00013E   F5..         MOV     ?V0 + 1,A
    699          
    700              // ZigBee PanID
    701              if ( osal_nv_read( ZCD_NV_PANID, 0, sizeof( tmp16 ), &tmp16 ) )
   \   000140                ; Setup parameters for call to function osal_nv_read
   \   000140   7402         MOV     A,#0x2
   \   000142   12....       LCALL   ?XSTACK_DISP0_8
   \   000145   8582..       MOV     ?V0 + 2,DPL
   \   000148   8583..       MOV     ?V0 + 3,DPH
   \   00014B   78..         MOV     R0,#?V0 + 2
   \   00014D   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000150   75..02       MOV     ?V0 + 2,#0x2
   \   000153   75..00       MOV     ?V0 + 3,#0x0
   \   000156   78..         MOV     R0,#?V0 + 2
   \   000158   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00015B   7C00         MOV     R4,#0x0
   \   00015D   7D00         MOV     R5,#0x0
   \   00015F   7A83         MOV     R2,#-0x7d
   \   000161   7B00         MOV     R3,#0x0
   \   000163   12....       LCALL   ??osal_nv_read?relay
   \   000166   7404         MOV     A,#0x4
   \   000168   12....       LCALL   ?DEALLOC_XSTACK8
   \   00016B   E9           MOV     A,R1
   \   00016C   6007         JZ      ??MT_ProcessGetNvInfo_5
    702                stat |= 0x04;
   \   00016E   D3           SETB    C
   \   00016F   EE           MOV     A,R6
   \   000170   92E2         MOV     0xE0 /* A   */.2,C
   \   000172   FE           MOV     R6,A
   \   000173   801E         SJMP    ??MT_ProcessGetNvInfo_6
    703              else
    704              {
    705                pBuf[0] = HI_UINT16( tmp16 );
   \                     ??MT_ProcessGetNvInfo_5:
   \   000175   7402         MOV     A,#0x2
   \   000177   12....       LCALL   ?XSTACK_DISP0_8
   \   00017A   A3           INC     DPTR
   \   00017B   E0           MOVX    A,@DPTR
   \   00017C   F9           MOV     R1,A
   \   00017D   E9           MOV     A,R1
   \   00017E   85..82       MOV     DPL,?V0 + 0
   \   000181   85..83       MOV     DPH,?V0 + 1
   \   000184   F0           MOVX    @DPTR,A
    706                pBuf[1] = LO_UINT16( tmp16 );
   \   000185   7402         MOV     A,#0x2
   \   000187   12....       LCALL   ?XSTACK_DISP0_8
   \   00018A   E0           MOVX    A,@DPTR
   \   00018B   85..82       MOV     DPL,?V0 + 0
   \   00018E   85..83       MOV     DPH,?V0 + 1
   \   000191   A3           INC     DPTR
   \   000192   F0           MOVX    @DPTR,A
    707              }
    708              pBuf += sizeof( tmp16 );
   \                     ??MT_ProcessGetNvInfo_6:
   \   000193   E5..         MOV     A,?V0 + 0
   \   000195   2402         ADD     A,#0x2
   \   000197   F5..         MOV     ?V0 + 0,A
   \   000199   E5..         MOV     A,?V0 + 1
   \   00019B   3400         ADDC    A,#0x0
   \   00019D   F5..         MOV     ?V0 + 1,A
    709          
    710              // Security level
    711              if ( osal_nv_read( ZCD_NV_SECURITY_LEVEL, 0, sizeof( uint8 ), pBuf++ ) )
   \   00019F   85....       MOV     ?V0 + 2,?V0 + 0
   \   0001A2   85....       MOV     ?V0 + 3,?V0 + 1
   \   0001A5   85..82       MOV     DPL,?V0 + 2
   \   0001A8   85..83       MOV     DPH,?V0 + 3
   \   0001AB   A3           INC     DPTR
   \   0001AC   8582..       MOV     ?V0 + 0,DPL
   \   0001AF   8583..       MOV     ?V0 + 1,DPH
   \   0001B2                ; Setup parameters for call to function osal_nv_read
   \   0001B2   78..         MOV     R0,#?V0 + 2
   \   0001B4   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0001B7   75..01       MOV     ?V0 + 2,#0x1
   \   0001BA   75..00       MOV     ?V0 + 3,#0x0
   \   0001BD   78..         MOV     R0,#?V0 + 2
   \   0001BF   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0001C2   7C00         MOV     R4,#0x0
   \   0001C4   7D00         MOV     R5,#0x0
   \   0001C6   7A61         MOV     R2,#0x61
   \   0001C8   7B00         MOV     R3,#0x0
   \   0001CA   12....       LCALL   ??osal_nv_read?relay
   \   0001CD   7404         MOV     A,#0x4
   \   0001CF   12....       LCALL   ?DEALLOC_XSTACK8
   \   0001D2   E9           MOV     A,R1
   \   0001D3   6005         JZ      ??MT_ProcessGetNvInfo_7
    712                stat |= 0x08;
   \   0001D5   D3           SETB    C
   \   0001D6   EE           MOV     A,R6
   \   0001D7   92E3         MOV     0xE0 /* A   */.3,C
   \   0001D9   FE           MOV     R6,A
    713          
    714              // Pre-configured security key
    715              if ( osal_nv_read( ZCD_NV_PRECFGKEY, 0, SEC_KEY_LEN, pBuf ) )
   \                     ??MT_ProcessGetNvInfo_7:
   \   0001DA                ; Setup parameters for call to function osal_nv_read
   \   0001DA   78..         MOV     R0,#?V0 + 0
   \   0001DC   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0001DF   75..10       MOV     ?V0 + 2,#0x10
   \   0001E2   75..00       MOV     ?V0 + 3,#0x0
   \   0001E5   78..         MOV     R0,#?V0 + 2
   \   0001E7   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0001EA   7C00         MOV     R4,#0x0
   \   0001EC   7D00         MOV     R5,#0x0
   \   0001EE   7A62         MOV     R2,#0x62
   \   0001F0   7B00         MOV     R3,#0x0
   \   0001F2   12....       LCALL   ??osal_nv_read?relay
   \   0001F5   7404         MOV     A,#0x4
   \   0001F7   12....       LCALL   ?DEALLOC_XSTACK8
   \   0001FA   E9           MOV     A,R1
   \   0001FB   6005         JZ      ??MT_ProcessGetNvInfo_8
    716                stat |= 0x10;
   \   0001FD   D3           SETB    C
   \   0001FE   EE           MOV     A,R6
   \   0001FF   92E4         MOV     0xE0 /* A   */.4,C
   \   000201   FE           MOV     R6,A
    717          
    718              // Status bit mask - bit=1 indicates failure
    719              *buf = stat;
   \                     ??MT_ProcessGetNvInfo_8:
   \   000202   EE           MOV     A,R6
   \   000203   C0E0         PUSH    A
   \   000205   85..82       MOV     DPL,?XSP + 0
   \   000208   85..83       MOV     DPH,?XSP + 1
   \   00020B   E0           MOVX    A,@DPTR
   \   00020C   F8           MOV     R0,A
   \   00020D   A3           INC     DPTR
   \   00020E   E0           MOVX    A,@DPTR
   \   00020F   F583         MOV     DPH,A
   \   000211   8882         MOV     DPL,R0
   \   000213   D0E0         POP     A
   \   000215   F0           MOVX    @DPTR,A
    720          
    721              MT_BuildAndSendZToolResponse( (SPI_0DATA_MSG_LEN + len),
    722                                            (SPI_RESPONSE_BIT | SPI_CMD_SYS_GET_NV_INFO),
    723                                            len, buf );
   \   000216                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000216   85..82       MOV     DPL,?XSP + 0
   \   000219   85..83       MOV     DPH,?XSP + 1
   \   00021C   12....       LCALL   ?PUSH_XSTACK8_X_TWO
   \   00021F   EF           MOV     A,R7
   \   000220   FC           MOV     R4,A
   \   000221   7A1F         MOV     R2,#0x1f
   \   000223   7B10         MOV     R3,#0x10
   \   000225   7405         MOV     A,#0x5
   \   000227   2F           ADD     A,R7
   \   000228   F9           MOV     R1,A
   \   000229   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
   \   00022C   7402         MOV     A,#0x2
   \   00022E   12....       LCALL   ?DEALLOC_XSTACK8
    724          
    725              osal_mem_free( buf );
   \   000231                ; Setup parameters for call to function osal_mem_free
   \   000231   85..82       MOV     DPL,?XSP + 0
   \   000234   85..83       MOV     DPH,?XSP + 1
   \   000237   E0           MOVX    A,@DPTR
   \   000238   FA           MOV     R2,A
   \   000239   A3           INC     DPTR
   \   00023A   E0           MOVX    A,@DPTR
   \   00023B   FB           MOV     R3,A
   \   00023C   12....       LCALL   ??osal_mem_free?relay
    726            }
    727          }
   \                     ??MT_ProcessGetNvInfo_1:
   \   00023F   7408         MOV     A,#0x8
   \   000241   12....       LCALL   ?DEALLOC_XSTACK8
   \   000244   7F08         MOV     R7,#0x8
   \   000246   02....       LJMP    ?BANKED_LEAVE_XDATA
    728          #endif  // NONWK
    729          #endif  // ZTOOL
    730          
    731          #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
    732          #define DEVICE_INFO_RESPONSE_LEN 46
    733          #define TYPE_COORDINATOR         1
    734          #define TYPE_ROUTER              2
    735          #define TYPE_ENDDEVICE           4
    736          /***************************************************************************************************
    737           * @fn      MT_ProcessGetDeviceInfo
    738           *
    739           * @brief
    740           *
    741           *   The Get Device Info serial message.
    742           *
    743           * @param   byte *msg - pointer to the data
    744           *
    745           * @return  void
    746           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    747          void MT_ProcessGetDeviceInfo( void )
   \                     MT_ProcessGetDeviceInfo:
    748          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 5
   \   000005   74FB         MOV     A,#-0x5
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    749            byte *buf;
    750            byte *pBuf;
    751            uint8 deviceType = 0;
   \   00000A   7400         MOV     A,#0x0
   \   00000C   85..82       MOV     DPL,?XSP + 0
   \   00000F   85..83       MOV     DPH,?XSP + 1
   \   000012   F0           MOVX    @DPTR,A
    752            uint16 shortAddr;
    753            uint16 *assocList;
    754            byte assocCnt;
    755            uint16 *puint16;
    756            byte x;
    757          
    758            buf = osal_mem_alloc( DEVICE_INFO_RESPONSE_LEN );
   \   000013                ; Setup parameters for call to function osal_mem_alloc
   \   000013   7A2E         MOV     R2,#0x2e
   \   000015   7B00         MOV     R3,#0x0
   \   000017   12....       LCALL   ??osal_mem_alloc?relay
   \   00001A   7401         MOV     A,#0x1
   \   00001C   12....       LCALL   ?XSTACK_DISP0_8
   \   00001F   EA           MOV     A,R2
   \   000020   F0           MOVX    @DPTR,A
   \   000021   A3           INC     DPTR
   \   000022   EB           MOV     A,R3
   \   000023   F0           MOVX    @DPTR,A
    759            if ( buf )
   \   000024   7401         MOV     A,#0x1
   \   000026   12....       LCALL   ?XSTACK_DISP0_8
   \   000029   E0           MOVX    A,@DPTR
   \   00002A   6400         XRL     A,#0x0
   \   00002C   7004         JNZ     ??MT_ProcessGetDeviceInfo_0
   \   00002E   A3           INC     DPTR
   \   00002F   E0           MOVX    A,@DPTR
   \   000030   6400         XRL     A,#0x0
   \                     ??MT_ProcessGetDeviceInfo_0:
   \   000032   7003         JNZ     $+5
   \   000034   02....       LJMP    ??MT_ProcessGetDeviceInfo_1 & 0xFFFF
    760            {
    761              pBuf = buf;
   \   000037   7401         MOV     A,#0x1
   \   000039   12....       LCALL   ?XSTACK_DISP0_8
   \   00003C   E0           MOVX    A,@DPTR
   \   00003D   F8           MOV     R0,A
   \   00003E   A3           INC     DPTR
   \   00003F   E0           MOVX    A,@DPTR
   \   000040   F9           MOV     R1,A
   \   000041   88..         MOV     ?V0 + 0,R0
   \   000043   89..         MOV     ?V0 + 1,R1
    762          
    763              *pBuf++ = ZSUCCESS;
   \   000045   7400         MOV     A,#0x0
   \   000047   85..82       MOV     DPL,?V0 + 0
   \   00004A   85..83       MOV     DPH,?V0 + 1
   \   00004D   F0           MOVX    @DPTR,A
   \   00004E   85..82       MOV     DPL,?V0 + 0
   \   000051   85..83       MOV     DPH,?V0 + 1
   \   000054   A3           INC     DPTR
   \   000055   8582..       MOV     ?V0 + 0,DPL
   \   000058   8583..       MOV     ?V0 + 1,DPH
    764          
    765              osal_nv_read( ZCD_NV_EXTADDR, 0, Z_EXTADDR_LEN, pBuf );
   \   00005B                ; Setup parameters for call to function osal_nv_read
   \   00005B   78..         MOV     R0,#?V0 + 0
   \   00005D   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000060   75..08       MOV     ?V0 + 4,#0x8
   \   000063   75..00       MOV     ?V0 + 5,#0x0
   \   000066   78..         MOV     R0,#?V0 + 4
   \   000068   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00006B   7C00         MOV     R4,#0x0
   \   00006D   7D00         MOV     R5,#0x0
   \   00006F   7A01         MOV     R2,#0x1
   \   000071   7B00         MOV     R3,#0x0
   \   000073   12....       LCALL   ??osal_nv_read?relay
   \   000076   7404         MOV     A,#0x4
   \   000078   12....       LCALL   ?DEALLOC_XSTACK8
    766              // Outgoing extended address needs to be reversed
    767              MT_ReverseBytes( pBuf, Z_EXTADDR_LEN );
   \   00007B                ; Setup parameters for call to function MT_ReverseBytes
   \   00007B   7908         MOV     R1,#0x8
   \   00007D   AA..         MOV     R2,?V0 + 0
   \   00007F   AB..         MOV     R3,?V0 + 1
   \   000081   12....       LCALL   ??MT_ReverseBytes?relay
    768              pBuf += Z_EXTADDR_LEN;
   \   000084   E5..         MOV     A,?V0 + 0
   \   000086   2408         ADD     A,#0x8
   \   000088   F5..         MOV     ?V0 + 0,A
   \   00008A   E5..         MOV     A,?V0 + 1
   \   00008C   3400         ADDC    A,#0x0
   \   00008E   F5..         MOV     ?V0 + 1,A
    769          
    770          #if !defined( NONWK )
    771              shortAddr = NLME_GetShortAddr();
   \   000090                ; Setup parameters for call to function NLME_GetShortAddr
   \   000090   12....       LCALL   ??NLME_GetShortAddr?relay
   \   000093   8A..         MOV     ?V0 + 4,R2
   \   000095   8B..         MOV     ?V0 + 5,R3
   \   000097   AE..         MOV     R6,?V0 + 4
    772          #else
    773              shortAddr = 0;
    774          #endif
    775          
    776              *pBuf++ = HI_UINT16( shortAddr );
   \   000099   85..82       MOV     DPL,?V0 + 0
   \   00009C   85..83       MOV     DPH,?V0 + 1
   \   00009F   E5..         MOV     A,?V0 + 5
   \   0000A1   F0           MOVX    @DPTR,A
   \   0000A2   85..82       MOV     DPL,?V0 + 0
   \   0000A5   85..83       MOV     DPH,?V0 + 1
   \   0000A8   A3           INC     DPTR
   \   0000A9   8582..       MOV     ?V0 + 0,DPL
   \   0000AC   8583..       MOV     ?V0 + 1,DPH
    777              *pBuf++ = LO_UINT16( shortAddr );
   \   0000AF   EE           MOV     A,R6
   \   0000B0   85..82       MOV     DPL,?V0 + 0
   \   0000B3   85..83       MOV     DPH,?V0 + 1
   \   0000B6   F0           MOVX    @DPTR,A
   \   0000B7   85..82       MOV     DPL,?V0 + 0
   \   0000BA   85..83       MOV     DPH,?V0 + 1
   \   0000BD   A3           INC     DPTR
   \   0000BE   8582..       MOV     ?V0 + 0,DPL
   \   0000C1   8583..       MOV     ?V0 + 1,DPH
    778          
    779              // Return device type
    780          #if !defined( NONWK )
    781          #if defined (ZDO_COORDINATOR)
    782              deviceType |= (uint8) TYPE_COORDINATOR;
    783            #if defined (SOFT_START)
    784              deviceType |= (uint8) TYPE_ROUTER;
    785            #endif
    786          #endif
    787          #if defined (RTR_NWK) && !defined (ZDO_COORDINATOR)
    788              deviceType |= (uint8) TYPE_ROUTER;
    789          #elif !defined (RTR_NWK)
    790              deviceType |= (uint8) TYPE_ENDDEVICE;
   \   0000C4   85..82       MOV     DPL,?XSP + 0
   \   0000C7   85..83       MOV     DPH,?XSP + 1
   \   0000CA   E0           MOVX    A,@DPTR
   \   0000CB   D2E2         SETB    0xE0 /* A   */.2
   \   0000CD   F0           MOVX    @DPTR,A
    791          #endif
    792          #endif
    793              *pBuf++ = (byte) deviceType;
   \   0000CE   85..82       MOV     DPL,?XSP + 0
   \   0000D1   85..83       MOV     DPH,?XSP + 1
   \   0000D4   E0           MOVX    A,@DPTR
   \   0000D5   85..82       MOV     DPL,?V0 + 0
   \   0000D8   85..83       MOV     DPH,?V0 + 1
   \   0000DB   F0           MOVX    @DPTR,A
   \   0000DC   85..82       MOV     DPL,?V0 + 0
   \   0000DF   85..83       MOV     DPH,?V0 + 1
   \   0000E2   A3           INC     DPTR
   \   0000E3   8582..       MOV     ?V0 + 0,DPL
   \   0000E6   8583..       MOV     ?V0 + 1,DPH
    794          
    795              //Return device state
    796          #if !defined( NONWK )
    797              *pBuf++ = (byte)devState;
   \   0000E9   90....       MOV     DPTR,#devState
   \   0000EC   E0           MOVX    A,@DPTR
   \   0000ED   85..82       MOV     DPL,?V0 + 0
   \   0000F0   85..83       MOV     DPH,?V0 + 1
   \   0000F3   F0           MOVX    @DPTR,A
   \   0000F4   85..82       MOV     DPL,?V0 + 0
   \   0000F7   85..83       MOV     DPH,?V0 + 1
   \   0000FA   A3           INC     DPTR
   \   0000FB   8582..       MOV     ?V0 + 0,DPL
   \   0000FE   8583..       MOV     ?V0 + 1,DPH
    798          #else
    799              *pBuf++ = (byte)0;
    800          #endif
    801          
    802          #if defined(RTR_NWK) && !defined( NONWK )
    803              assocList = AssocMakeList( &assocCnt );
    804          #else
    805              assocCnt = 0;
   \   000101   75..00       MOV     ?V0 + 3,#0x0
    806              assocList = NULL;
   \   000104   7403         MOV     A,#0x3
   \   000106   12....       LCALL   ?XSTACK_DISP0_8
   \   000109   7400         MOV     A,#0x0
   \   00010B   F0           MOVX    @DPTR,A
   \   00010C   A3           INC     DPTR
   \   00010D   7400         MOV     A,#0x0
   \   00010F   F0           MOVX    @DPTR,A
    807          #endif
    808          
    809              *pBuf++ = assocCnt;
   \   000110   85..82       MOV     DPL,?V0 + 0
   \   000113   85..83       MOV     DPH,?V0 + 1
   \   000116   E5..         MOV     A,?V0 + 3
   \   000118   F0           MOVX    @DPTR,A
   \   000119   85..82       MOV     DPL,?V0 + 0
   \   00011C   85..83       MOV     DPH,?V0 + 1
   \   00011F   A3           INC     DPTR
   \   000120   8582..       MOV     ?V0 + 0,DPL
   \   000123   8583..       MOV     ?V0 + 1,DPH
    810          
    811              // upto 16 devices
    812              osal_memset( pBuf, 0, (16 * sizeof(uint16)) );
   \   000126                ; Setup parameters for call to function osal_memset
   \   000126   7C20         MOV     R4,#0x20
   \   000128   7D00         MOV     R5,#0x0
   \   00012A   7900         MOV     R1,#0x0
   \   00012C   AA..         MOV     R2,?V0 + 0
   \   00012E   AB..         MOV     R3,?V0 + 1
   \   000130   12....       LCALL   ??osal_memset?relay
    813              puint16 = assocList;
   \   000133   7403         MOV     A,#0x3
   \   000135   12....       LCALL   ?XSTACK_DISP0_8
   \   000138   E0           MOVX    A,@DPTR
   \   000139   F8           MOV     R0,A
   \   00013A   A3           INC     DPTR
   \   00013B   E0           MOVX    A,@DPTR
   \   00013C   F9           MOV     R1,A
   \   00013D   88..         MOV     ?V0 + 6,R0
   \   00013F   89..         MOV     ?V0 + 7,R1
    814              for ( x = 0; x < assocCnt; x++ )
   \   000141   75..00       MOV     ?V0 + 2,#0x0
   \                     ??MT_ProcessGetDeviceInfo_2:
   \   000144   E5..         MOV     A,?V0 + 2
   \   000146   C3           CLR     C
   \   000147   95..         SUBB    A,?V0 + 3
   \   000149   5049         JNC     ??MT_ProcessGetDeviceInfo_3
    815              {
    816                *pBuf++ = HI_UINT16( *puint16 );
   \   00014B   85..82       MOV     DPL,?V0 + 6
   \   00014E   85..83       MOV     DPH,?V0 + 7
   \   000151   A3           INC     DPTR
   \   000152   E0           MOVX    A,@DPTR
   \   000153   F9           MOV     R1,A
   \   000154   E9           MOV     A,R1
   \   000155   85..82       MOV     DPL,?V0 + 0
   \   000158   85..83       MOV     DPH,?V0 + 1
   \   00015B   F0           MOVX    @DPTR,A
   \   00015C   85..82       MOV     DPL,?V0 + 0
   \   00015F   85..83       MOV     DPH,?V0 + 1
   \   000162   A3           INC     DPTR
   \   000163   8582..       MOV     ?V0 + 0,DPL
   \   000166   8583..       MOV     ?V0 + 1,DPH
    817                *pBuf++ = LO_UINT16( *puint16 );
   \   000169   85..82       MOV     DPL,?V0 + 6
   \   00016C   85..83       MOV     DPH,?V0 + 7
   \   00016F   E0           MOVX    A,@DPTR
   \   000170   85..82       MOV     DPL,?V0 + 0
   \   000173   85..83       MOV     DPH,?V0 + 1
   \   000176   F0           MOVX    @DPTR,A
   \   000177   85..82       MOV     DPL,?V0 + 0
   \   00017A   85..83       MOV     DPH,?V0 + 1
   \   00017D   A3           INC     DPTR
   \   00017E   8582..       MOV     ?V0 + 0,DPL
   \   000181   8583..       MOV     ?V0 + 1,DPH
    818                puint16++;
   \   000184   E5..         MOV     A,?V0 + 6
   \   000186   2402         ADD     A,#0x2
   \   000188   F5..         MOV     ?V0 + 6,A
   \   00018A   E5..         MOV     A,?V0 + 7
   \   00018C   3400         ADDC    A,#0x0
   \   00018E   F5..         MOV     ?V0 + 7,A
    819              }
   \   000190   05..         INC     ?V0 + 2
   \   000192   80B0         SJMP    ??MT_ProcessGetDeviceInfo_2
    820          
    821              if ( assocList )
   \                     ??MT_ProcessGetDeviceInfo_3:
   \   000194   7403         MOV     A,#0x3
   \   000196   12....       LCALL   ?XSTACK_DISP0_8
   \   000199   E0           MOVX    A,@DPTR
   \   00019A   6400         XRL     A,#0x0
   \   00019C   7004         JNZ     ??MT_ProcessGetDeviceInfo_4
   \   00019E   A3           INC     DPTR
   \   00019F   E0           MOVX    A,@DPTR
   \   0001A0   6400         XRL     A,#0x0
   \                     ??MT_ProcessGetDeviceInfo_4:
   \   0001A2   600D         JZ      ??MT_ProcessGetDeviceInfo_5
    822                osal_mem_free( assocList );
   \   0001A4                ; Setup parameters for call to function osal_mem_free
   \   0001A4   7403         MOV     A,#0x3
   \   0001A6   12....       LCALL   ?XSTACK_DISP0_8
   \   0001A9   E0           MOVX    A,@DPTR
   \   0001AA   FA           MOV     R2,A
   \   0001AB   A3           INC     DPTR
   \   0001AC   E0           MOVX    A,@DPTR
   \   0001AD   FB           MOV     R3,A
   \   0001AE   12....       LCALL   ??osal_mem_free?relay
    823          
    824              MT_BuildAndSendZToolResponse( (SPI_0DATA_MSG_LEN + DEVICE_INFO_RESPONSE_LEN),
    825                                            (SPI_RESPONSE_BIT | SPI_CMD_SYS_GET_DEVICE_INFO),
    826                                            DEVICE_INFO_RESPONSE_LEN, buf );
   \                     ??MT_ProcessGetDeviceInfo_5:
   \   0001B1                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   0001B1   7401         MOV     A,#0x1
   \   0001B3   12....       LCALL   ?XSTACK_DISP0_8
   \   0001B6   12....       LCALL   ?PUSH_XSTACK8_X_TWO
   \   0001B9   7C2E         MOV     R4,#0x2e
   \   0001BB   7A14         MOV     R2,#0x14
   \   0001BD   7B10         MOV     R3,#0x10
   \   0001BF   7933         MOV     R1,#0x33
   \   0001C1   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
   \   0001C4   7402         MOV     A,#0x2
   \   0001C6   12....       LCALL   ?DEALLOC_XSTACK8
    827          
    828              osal_mem_free( buf );
   \   0001C9                ; Setup parameters for call to function osal_mem_free
   \   0001C9   7401         MOV     A,#0x1
   \   0001CB   12....       LCALL   ?XSTACK_DISP0_8
   \   0001CE   E0           MOVX    A,@DPTR
   \   0001CF   FA           MOV     R2,A
   \   0001D0   A3           INC     DPTR
   \   0001D1   E0           MOVX    A,@DPTR
   \   0001D2   FB           MOV     R3,A
   \   0001D3   12....       LCALL   ??osal_mem_free?relay
    829            }
    830          }
   \                     ??MT_ProcessGetDeviceInfo_1:
   \   0001D6   7405         MOV     A,#0x5
   \   0001D8   12....       LCALL   ?DEALLOC_XSTACK8
   \   0001DB   7F08         MOV     R7,#0x8
   \   0001DD   02....       LJMP    ?BANKED_LEAVE_XDATA
    831          #endif
    832          
    833          #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
    834          /***************************************************************************************************
    835           * @fn      MT_ProcessSerialCommand
    836           *
    837           * @brief
    838           *
    839           *   Process Serial Message.
    840           *
    841           * @param   byte *msg - pointer to event message
    842           *
    843           * @return  void
    844           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    845          void MT_ProcessSerialCommand( byte *msg )
   \                     MT_ProcessSerialCommand:
    846          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 27
   \   000005   74E5         MOV     A,#-0x1b
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   7407         MOV     A,#0x7
   \   00000C   12....       LCALL   ?XSTACK_DISP0_8
   \   00000F   EA           MOV     A,R2
   \   000010   F0           MOVX    @DPTR,A
   \   000011   A3           INC     DPTR
   \   000012   EB           MOV     A,R3
   \   000013   F0           MOVX    @DPTR,A
    847            UINT16 cmd;
    848            UINT16 callbackID;
    849            byte len;
    850            byte ret;
    851            byte *pData;
    852            uint16 tmp16;
    853            uint32 tmp32;
    854            byte extAddr[Z_EXTADDR_LEN];
    855            byte *retValue;
    856            byte x = 0;
   \   000014   7F00         MOV     R7,#0x0
    857          #if !defined ( NONWK )
    858            uint16 attLen;
    859          #endif // NONWK
    860          
    861            // dig out header info
    862            cmd = BUILD_UINT16( msg[1], msg[0] );
   \   000016   7407         MOV     A,#0x7
   \   000018   12....       LCALL   ?XSTACK_DISP0_8
   \   00001B   E0           MOVX    A,@DPTR
   \   00001C   F8           MOV     R0,A
   \   00001D   A3           INC     DPTR
   \   00001E   E0           MOVX    A,@DPTR
   \   00001F   F583         MOV     DPH,A
   \   000021   8882         MOV     DPL,R0
   \   000023   A3           INC     DPTR
   \   000024   E0           MOVX    A,@DPTR
   \   000025   FA           MOV     R2,A
   \   000026   7B00         MOV     R3,#0x0
   \   000028   7407         MOV     A,#0x7
   \   00002A   12....       LCALL   ?XSTACK_DISP0_8
   \   00002D   E0           MOVX    A,@DPTR
   \   00002E   F8           MOV     R0,A
   \   00002F   A3           INC     DPTR
   \   000030   E0           MOVX    A,@DPTR
   \   000031   F583         MOV     DPH,A
   \   000033   8882         MOV     DPL,R0
   \   000035   E0           MOVX    A,@DPTR
   \   000036   F8           MOV     R0,A
   \   000037   E4           CLR     A
   \   000038   C8           XCH     A,R0
   \   000039   F9           MOV     R1,A
   \   00003A   E8           MOV     A,R0
   \   00003B   2A           ADD     A,R2
   \   00003C   F8           MOV     R0,A
   \   00003D   E9           MOV     A,R1
   \   00003E   3B           ADDC    A,R3
   \   00003F   F9           MOV     R1,A
   \   000040   740B         MOV     A,#0xb
   \   000042   12....       LCALL   ?XSTACK_DISP0_8
   \   000045   E8           MOV     A,R0
   \   000046   F0           MOVX    @DPTR,A
   \   000047   A3           INC     DPTR
   \   000048   E9           MOV     A,R1
   \   000049   F0           MOVX    @DPTR,A
    863            save_cmd = cmd;
   \   00004A   740B         MOV     A,#0xb
   \   00004C   12....       LCALL   ?XSTACK_DISP0_8
   \   00004F   E0           MOVX    A,@DPTR
   \   000050   F8           MOV     R0,A
   \   000051   A3           INC     DPTR
   \   000052   E0           MOVX    A,@DPTR
   \   000053   F9           MOV     R1,A
   \   000054   90....       MOV     DPTR,#save_cmd
   \   000057   E8           MOV     A,R0
   \   000058   F0           MOVX    @DPTR,A
   \   000059   A3           INC     DPTR
   \   00005A   E9           MOV     A,R1
   \   00005B   F0           MOVX    @DPTR,A
    864            len = msg[2];
    865            pData = &msg[3];
   \   00005C   7407         MOV     A,#0x7
   \   00005E   12....       LCALL   ?XSTACK_DISP0_8
   \   000061   E0           MOVX    A,@DPTR
   \   000062   2403         ADD     A,#0x3
   \   000064   F8           MOV     R0,A
   \   000065   A3           INC     DPTR
   \   000066   E0           MOVX    A,@DPTR
   \   000067   3400         ADDC    A,#0x0
   \   000069   F9           MOV     R1,A
   \   00006A   85..82       MOV     DPL,?XSP + 0
   \   00006D   85..83       MOV     DPH,?XSP + 1
   \   000070   E8           MOV     A,R0
   \   000071   F0           MOVX    @DPTR,A
   \   000072   A3           INC     DPTR
   \   000073   E9           MOV     A,R1
   \   000074   F0           MOVX    @DPTR,A
    866          
    867              // Setup for return;
    868              len = 0;
   \   000075   7E00         MOV     R6,#0x0
    869              retValue = &ret;
   \   000077   7402         MOV     A,#0x2
   \   000079   12....       LCALL   ?XSTACK_DISP0_8
   \   00007C   A882         MOV     R0,DPL
   \   00007E   A983         MOV     R1,DPH
   \   000080   7405         MOV     A,#0x5
   \   000082   12....       LCALL   ?XSTACK_DISP0_8
   \   000085   E8           MOV     A,R0
   \   000086   F0           MOVX    @DPTR,A
   \   000087   A3           INC     DPTR
   \   000088   E9           MOV     A,R1
   \   000089   F0           MOVX    @DPTR,A
    870          
    871              //Process the contents of the message
    872              switch ( cmd )
   \   00008A   740B         MOV     A,#0xb
   \   00008C   12....       LCALL   ?XSTACK_DISP0_8
   \   00008F   E0           MOVX    A,@DPTR
   \   000090   F5..         MOV     ?V0 + 0,A
   \   000092   A3           INC     DPTR
   \   000093   E0           MOVX    A,@DPTR
   \   000094   F5..         MOV     ?V0 + 1,A
   \   000096   78..         MOV     R0,#?V0 + 0
   \   000098   12....       LCALL   ?US_SWITCH_DENSE
   \                     `?<Jumptable for MT_ProcessSerialCommand>_0`:
   \   00009B   0100         DW        1
   \   00009D   1E           DB        30
   \   00009E   ....         DW        ??MT_ProcessSerialCommand_0
   \   0000A0   ....         DW        ??MT_ProcessSerialCommand_1
   \   0000A2   ....         DW        ??MT_ProcessSerialCommand_2
   \   0000A4   ....         DW        ??MT_ProcessSerialCommand_3
   \   0000A6   ....         DW        ??MT_ProcessSerialCommand_0
   \   0000A8   ....         DW        ??MT_ProcessSerialCommand_4
   \   0000AA   ....         DW        ??MT_ProcessSerialCommand_5
   \   0000AC   ....         DW        ??MT_ProcessSerialCommand_6
   \   0000AE   ....         DW        ??MT_ProcessSerialCommand_7
   \   0000B0   ....         DW        ??MT_ProcessSerialCommand_0
   \   0000B2   ....         DW        ??MT_ProcessSerialCommand_0
   \   0000B4   ....         DW        ??MT_ProcessSerialCommand_0
   \   0000B6   ....         DW        ??MT_ProcessSerialCommand_0
   \   0000B8   ....         DW        ??MT_ProcessSerialCommand_0
   \   0000BA   ....         DW        ??MT_ProcessSerialCommand_0
   \   0000BC   ....         DW        ??MT_ProcessSerialCommand_0
   \   0000BE   ....         DW        ??MT_ProcessSerialCommand_8
   \   0000C0   ....         DW        ??MT_ProcessSerialCommand_9
   \   0000C2   ....         DW        ??MT_ProcessSerialCommand_10
   \   0000C4   ....         DW        ??MT_ProcessSerialCommand_11
   \   0000C6   ....         DW        ??MT_ProcessSerialCommand_12
   \   0000C8   ....         DW        ??MT_ProcessSerialCommand_0
   \   0000CA   ....         DW        ??MT_ProcessSerialCommand_13
   \   0000CC   ....         DW        ??MT_ProcessSerialCommand_14
   \   0000CE   ....         DW        ??MT_ProcessSerialCommand_15
   \   0000D0   ....         DW        ??MT_ProcessSerialCommand_16
   \   0000D2   ....         DW        ??MT_ProcessSerialCommand_17
   \   0000D4   ....         DW        ??MT_ProcessSerialCommand_18
   \   0000D6   ....         DW        ??MT_ProcessSerialCommand_19
   \   0000D8   ....         DW        ??MT_ProcessSerialCommand_20
   \   0000DA   ....         DW        ??MT_ProcessSerialCommand_21
   \   0000DC   ....         DW        ??MT_ProcessSerialCommand_22
    873              {
    874          #ifdef MACSIM
    875                case SPI_CMD_ZIGNET_DATA:
    876                  MACSIM_TranslateMsg( pData, len );
    877                  break;
    878          #endif
    879          
    880                case SPI_CMD_SYS_RAM_READ:
    881                  extAddr[0] = MT_RAMRead( (UINT16)BUILD_UINT16( pData[1], pData[0] ), &extAddr[1] );
   \                     ??MT_ProcessSerialCommand_1:
   \   0000DE                ; Setup parameters for call to function MT_RAMRead
   \   0000DE   7412         MOV     A,#0x12
   \   0000E0   12....       LCALL   ?XSTACK_DISP0_8
   \   0000E3   AC82         MOV     R4,DPL
   \   0000E5   AD83         MOV     R5,DPH
   \   0000E7   85..82       MOV     DPL,?XSP + 0
   \   0000EA   85..83       MOV     DPH,?XSP + 1
   \   0000ED   E0           MOVX    A,@DPTR
   \   0000EE   F8           MOV     R0,A
   \   0000EF   A3           INC     DPTR
   \   0000F0   E0           MOVX    A,@DPTR
   \   0000F1   F583         MOV     DPH,A
   \   0000F3   8882         MOV     DPL,R0
   \   0000F5   A3           INC     DPTR
   \   0000F6   E0           MOVX    A,@DPTR
   \   0000F7   FA           MOV     R2,A
   \   0000F8   7B00         MOV     R3,#0x0
   \   0000FA   85..82       MOV     DPL,?XSP + 0
   \   0000FD   85..83       MOV     DPH,?XSP + 1
   \   000100   E0           MOVX    A,@DPTR
   \   000101   F8           MOV     R0,A
   \   000102   A3           INC     DPTR
   \   000103   E0           MOVX    A,@DPTR
   \   000104   F583         MOV     DPH,A
   \   000106   8882         MOV     DPL,R0
   \   000108   E0           MOVX    A,@DPTR
   \   000109   F8           MOV     R0,A
   \   00010A   E4           CLR     A
   \   00010B   C8           XCH     A,R0
   \   00010C   F9           MOV     R1,A
   \   00010D   E8           MOV     A,R0
   \   00010E   2A           ADD     A,R2
   \   00010F   FA           MOV     R2,A
   \   000110   E9           MOV     A,R1
   \   000111   3B           ADDC    A,R3
   \   000112   FB           MOV     R3,A
   \   000113   12....       LCALL   ??MT_RAMRead?relay
   \   000116   E9           MOV     A,R1
   \   000117   C0E0         PUSH    A
   \   000119   7411         MOV     A,#0x11
   \   00011B   12....       LCALL   ?XSTACK_DISP0_8
   \   00011E   D0E0         POP     A
   \   000120   F0           MOVX    @DPTR,A
    882                  len = MT_RAM_READ_RESP_LEN;
   \   000121   7E02         MOV     R6,#0x2
    883                  retValue = extAddr;
   \   000123   7411         MOV     A,#0x11
   \   000125   12....       LCALL   ?XSTACK_DISP0_8
   \   000128   A882         MOV     R0,DPL
   \   00012A   A983         MOV     R1,DPH
   \   00012C   7405         MOV     A,#0x5
   \   00012E   12....       LCALL   ?XSTACK_DISP0_8
   \   000131   E8           MOV     A,R0
   \   000132   F0           MOVX    @DPTR,A
   \   000133   A3           INC     DPTR
   \   000134   E9           MOV     A,R1
   \   000135   F0           MOVX    @DPTR,A
   \   000136   02....       LJMP    ??MT_ProcessSerialCommand_0 & 0xFFFF
    884                  break;
    885          
    886                case SPI_CMD_SYS_RAM_WRITE:
    887                  ret = MT_RAMWrite( (UINT16)BUILD_UINT16( pData[1], pData[0] ), pData[2] );
   \                     ??MT_ProcessSerialCommand_2:
   \   000139                ; Setup parameters for call to function MT_RAMWrite
   \   000139   85..82       MOV     DPL,?XSP + 0
   \   00013C   85..83       MOV     DPH,?XSP + 1
   \   00013F   E0           MOVX    A,@DPTR
   \   000140   F8           MOV     R0,A
   \   000141   A3           INC     DPTR
   \   000142   E0           MOVX    A,@DPTR
   \   000143   F583         MOV     DPH,A
   \   000145   8882         MOV     DPL,R0
   \   000147   A3           INC     DPTR
   \   000148   A3           INC     DPTR
   \   000149   E0           MOVX    A,@DPTR
   \   00014A   F9           MOV     R1,A
   \   00014B   85..82       MOV     DPL,?XSP + 0
   \   00014E   85..83       MOV     DPH,?XSP + 1
   \   000151   E0           MOVX    A,@DPTR
   \   000152   F8           MOV     R0,A
   \   000153   A3           INC     DPTR
   \   000154   E0           MOVX    A,@DPTR
   \   000155   F583         MOV     DPH,A
   \   000157   8882         MOV     DPL,R0
   \   000159   A3           INC     DPTR
   \   00015A   E0           MOVX    A,@DPTR
   \   00015B   FC           MOV     R4,A
   \   00015C   7D00         MOV     R5,#0x0
   \   00015E   85..82       MOV     DPL,?XSP + 0
   \   000161   85..83       MOV     DPH,?XSP + 1
   \   000164   E0           MOVX    A,@DPTR
   \   000165   F8           MOV     R0,A
   \   000166   A3           INC     DPTR
   \   000167   E0           MOVX    A,@DPTR
   \   000168   F583         MOV     DPH,A
   \   00016A   8882         MOV     DPL,R0
   \   00016C   E0           MOVX    A,@DPTR
   \   00016D   FA           MOV     R2,A
   \   00016E   E4           CLR     A
   \   00016F   CA           XCH     A,R2
   \   000170   FB           MOV     R3,A
   \   000171   EA           MOV     A,R2
   \   000172   2C           ADD     A,R4
   \   000173   FA           MOV     R2,A
   \   000174   EB           MOV     A,R3
   \   000175   3D           ADDC    A,R5
   \   000176   FB           MOV     R3,A
   \   000177   12....       LCALL   ??MT_RAMWrite?relay
   \   00017A   E9           MOV     A,R1
   \   00017B   C0E0         PUSH    A
   \   00017D   7402         MOV     A,#0x2
   \   00017F   12....       LCALL   ?XSTACK_DISP0_8
   \   000182   D0E0         POP     A
   \   000184   F0           MOVX    @DPTR,A
    888                  len = MT_RAM_WRITE_RESP_LEN;
   \   000185   7E01         MOV     R6,#0x1
   \   000187   02....       LJMP    ??MT_ProcessSerialCommand_0 & 0xFFFF
    889                  break;
    890          
    891                case SPI_CMD_SYS_SET_DEBUG_THRESHOLD:
    892                  ret = MT_SetDebugThreshold( pData[0], pData[1] );
   \                     ??MT_ProcessSerialCommand_3:
   \   00018A                ; Setup parameters for call to function MT_SetDebugThreshold
   \   00018A   85..82       MOV     DPL,?XSP + 0
   \   00018D   85..83       MOV     DPH,?XSP + 1
   \   000190   E0           MOVX    A,@DPTR
   \   000191   F8           MOV     R0,A
   \   000192   A3           INC     DPTR
   \   000193   E0           MOVX    A,@DPTR
   \   000194   F583         MOV     DPH,A
   \   000196   8882         MOV     DPL,R0
   \   000198   A3           INC     DPTR
   \   000199   E0           MOVX    A,@DPTR
   \   00019A   FA           MOV     R2,A
   \   00019B   85..82       MOV     DPL,?XSP + 0
   \   00019E   85..83       MOV     DPH,?XSP + 1
   \   0001A1   E0           MOVX    A,@DPTR
   \   0001A2   F8           MOV     R0,A
   \   0001A3   A3           INC     DPTR
   \   0001A4   E0           MOVX    A,@DPTR
   \   0001A5   F583         MOV     DPH,A
   \   0001A7   8882         MOV     DPL,R0
   \   0001A9   E0           MOVX    A,@DPTR
   \   0001AA   F9           MOV     R1,A
   \   0001AB   12....       LCALL   ??MT_SetDebugThreshold?relay
   \   0001AE   E9           MOV     A,R1
   \   0001AF   C0E0         PUSH    A
   \   0001B1   7402         MOV     A,#0x2
   \   0001B3   12....       LCALL   ?XSTACK_DISP0_8
   \   0001B6   D0E0         POP     A
   \   0001B8   F0           MOVX    @DPTR,A
    893                  len = 1;
   \   0001B9   7E01         MOV     R6,#0x1
   \   0001BB   02....       LJMP    ??MT_ProcessSerialCommand_0 & 0xFFFF
    894                  break;
    895          
    896                case SPI_CMD_TRACE_SUB:
    897                  break;
    898          
    899                case SPI_CMD_SYS_RESET:
    900                  MT_Reset( pData[0] );
   \                     ??MT_ProcessSerialCommand_4:
   \   0001BE                ; Setup parameters for call to function MT_Reset
   \   0001BE   85..82       MOV     DPL,?XSP + 0
   \   0001C1   85..83       MOV     DPH,?XSP + 1
   \   0001C4   E0           MOVX    A,@DPTR
   \   0001C5   F8           MOV     R0,A
   \   0001C6   A3           INC     DPTR
   \   0001C7   E0           MOVX    A,@DPTR
   \   0001C8   F583         MOV     DPH,A
   \   0001CA   8882         MOV     DPL,R0
   \   0001CC   E0           MOVX    A,@DPTR
   \   0001CD   F9           MOV     R1,A
   \   0001CE   12....       LCALL   ??MT_Reset?relay
   \   0001D1   02....       LJMP    ??MT_ProcessSerialCommand_0 & 0xFFFF
    901                  break;
    902          
    903                case SPI_CMD_SYS_CALLBACK_SUB_CMD:
    904                  // a callback value of 0xFFFF turns on all available callbacks
    905                  callbackID = BUILD_UINT16( pData[1] , pData[0] );
   \                     ??MT_ProcessSerialCommand_5:
   \   0001D4   85..82       MOV     DPL,?XSP + 0
   \   0001D7   85..83       MOV     DPH,?XSP + 1
   \   0001DA   E0           MOVX    A,@DPTR
   \   0001DB   F8           MOV     R0,A
   \   0001DC   A3           INC     DPTR
   \   0001DD   E0           MOVX    A,@DPTR
   \   0001DE   F583         MOV     DPH,A
   \   0001E0   8882         MOV     DPL,R0
   \   0001E2   A3           INC     DPTR
   \   0001E3   E0           MOVX    A,@DPTR
   \   0001E4   FA           MOV     R2,A
   \   0001E5   7B00         MOV     R3,#0x0
   \   0001E7   85..82       MOV     DPL,?XSP + 0
   \   0001EA   85..83       MOV     DPH,?XSP + 1
   \   0001ED   E0           MOVX    A,@DPTR
   \   0001EE   F8           MOV     R0,A
   \   0001EF   A3           INC     DPTR
   \   0001F0   E0           MOVX    A,@DPTR
   \   0001F1   F583         MOV     DPH,A
   \   0001F3   8882         MOV     DPL,R0
   \   0001F5   E0           MOVX    A,@DPTR
   \   0001F6   F8           MOV     R0,A
   \   0001F7   E4           CLR     A
   \   0001F8   C8           XCH     A,R0
   \   0001F9   F9           MOV     R1,A
   \   0001FA   E8           MOV     A,R0
   \   0001FB   2A           ADD     A,R2
   \   0001FC   F8           MOV     R0,A
   \   0001FD   E9           MOV     A,R1
   \   0001FE   3B           ADDC    A,R3
   \   0001FF   F9           MOV     R1,A
   \   000200   7419         MOV     A,#0x19
   \   000202   12....       LCALL   ?XSTACK_DISP0_8
   \   000205   E8           MOV     A,R0
   \   000206   F0           MOVX    @DPTR,A
   \   000207   A3           INC     DPTR
   \   000208   E9           MOV     A,R1
   \   000209   F0           MOVX    @DPTR,A
    906                  if ( callbackID == 0xFFFF )
    907                  {
    908                    // What is the action
    909                    if ( pData[2] )
    910                    {
    911                      // Turn on
    912          #if defined( MT_MAC_CB_FUNC )
    913                      _macCallbackSub = 0xFFFF;
    914          #endif
    915          #if defined( MT_NWK_CB_FUNC )
    916                      _nwkCallbackSub = 0xFFFF;
    917          #endif
    918          
    919          #if defined( MT_ZDO_FUNC )
    920                      _zdoCallbackSub = 0xFFFFFFFF;
    921          #endif
    922          #if defined( MT_AF_CB_FUNC )
    923                      _afCallbackSub = 0xFFFF;
    924          #endif
    925          #if defined( MT_SAPI_CB_FUNC )
    926                      _sapiCallbackSub = 0xFFFF;
    927          #endif
    928                    }
    929                    else
    930                    {
    931                      // Turn off
    932          #if defined( MT_MAC_CB_FUNC )
    933                      _macCallbackSub = 0x0000;
    934          #endif
    935          #if defined( MT_NWK_CB_FUNC )
    936                      _nwkCallbackSub = 0x0000;
    937          #endif
    938          
    939          #if defined( MT_ZDO_FUNC )
    940                      _zdoCallbackSub = 0x00000000;
    941          #endif
    942          #if defined( MT_AF_CB_FUNC )
    943                      _afCallbackSub = 0x0000;
    944          #endif
    945          #if defined( MT_SAPI_CB_FUNC )
    946                      _sapiCallbackSub = 0x0000;
    947          #endif
    948                    }
    949                  }
    950                  else
    951                  {
    952                    //First check which layer callbacks are desired and then set the preference
    953          
    954          #if defined( MT_MAC_CB_FUNC )
    955                    //If it is a MAC callback, set the corresponding callback subscription bit
    956                    if (( callbackID & 0xFFF0 ) == SPI_MAC_CB_TYPE )
    957                    {
    958                      //Based on the action field, either enable or disable subscription
    959                      if ( pData[2] )
    960                        _macCallbackSub |=  ( 1 << ( pData[1] & 0x0F ) );
    961                      else
    962                        _macCallbackSub &= ~( 1 << ( pData[1] & 0x0F ) );
    963                    }
    964          #endif
    965          
    966          #if defined( MT_NWK_CB_FUNC )
    967                    //If it is a NWK callback, set the corresponding callback subscription bit
    968                    if (( callbackID & 0xFFF0 ) == SPI_NWK_CB_TYPE )
    969                    {
    970          
    971                      //Based on the action field, either enable or disable subscription
    972                      if ( pData[2] )
    973                        _nwkCallbackSub |=  ( 1 << ( pData[1] & 0x0F ) ) ;
    974                      else
    975                        _nwkCallbackSub &= ~( 1 << ( pData[1] & 0x0F ) );
    976                    }
    977          #endif
    978          
    979          #if defined( MT_ZDO_FUNC )
    980                    //If it is a APS callback, set the corresponding callback subscription bit
    981                    if ( ((callbackID & 0xFFF0) == SPI_ZDO_CB_TYPE) ||
    982                         ((callbackID & 0xFFF0) == SPI_ZDO_CB2_TYPE) )
    983                    {
    984                      //Based on the action field, either enable or disable subscription
    985                      if ( pData[2] )
    986                        _zdoCallbackSub |=  ( 1L << ( pData[1] & 0x1F ) );
    987                      else
    988                        _zdoCallbackSub &= ~( 1L << ( pData[1] & 0x1F ) );
    989                    }
    990          #endif
    991          
    992          #if defined( MT_AF_CB_FUNC )
    993                    // Set the corresponding callback subscription bit for an AF callback.
    994                    if (( callbackID & 0xFFF0 ) == SPI_AF_CB_TYPE )
    995                    {
    996                      // Based on the action field, either enable or disable subscription.
    997                      if ( pData[2] )
    998                        _afCallbackSub |=  ( 1 << ( pData[1] & 0x0F ) );
    999                      else
   1000                        _afCallbackSub &= ~( 1 << ( pData[1] & 0x0F ) );
   1001                    }
   1002          #endif
   1003          #if defined( MT_SAPI_CB_FUNC )
   1004                    // Set the corresponding callback subscription bit for an SAPI callback.
   1005                    if (( callbackID & 0xFFF0 ) == SPI_SAPI_CB_TYPE )
   1006                    {
   1007                      // Based on the action field, either enable or disable subscription.
   1008                      if ( pData[2] )
   1009                        _sapiCallbackSub |=  ( 1 << ( pData[1] & 0x0F ) );
   1010                      else
   1011                        _sapiCallbackSub &= ~( 1 << ( pData[1] & 0x0F ) );
   1012                    }
   1013          #endif
   1014                  }
   1015                  len = 1;
   \   00020A   7E01         MOV     R6,#0x1
   1016                  ret = ZSUCCESS;
   \   00020C   7400         MOV     A,#0x0
   \   00020E   C0E0         PUSH    A
   \   000210   7402         MOV     A,#0x2
   \   000212   12....       LCALL   ?XSTACK_DISP0_8
   \   000215   D0E0         POP     A
   \   000217   F0           MOVX    @DPTR,A
   \   000218   02....       LJMP    ??MT_ProcessSerialCommand_0 & 0xFFFF
   1017                  break;
   1018          
   1019                case SPI_CMD_SYS_PING:
   1020                  // Get a message buffer to build response message
   1021                  // The Ping response now has capabilities included
   1022          
   1023                  // Build Capabilities
   1024                  tmp16 = MT_CAP_MAC | MT_CAP_NWK | MT_CAP_AF |
   1025                          MT_CAP_ZDO | MT_CAP_USER_TEST | MT_CAP_SAPI_FUNC;
   \                     ??MT_ProcessSerialCommand_6:
   \   00021B   7409         MOV     A,#0x9
   \   00021D   12....       LCALL   ?XSTACK_DISP0_8
   \   000220   7400         MOV     A,#0x0
   \   000222   F0           MOVX    @DPTR,A
   \   000223   A3           INC     DPTR
   \   000224   7400         MOV     A,#0x0
   \   000226   F0           MOVX    @DPTR,A
   1026          
   1027                  // Convert to high byte first into temp buffer
   1028                  extAddr[0] = HI_UINT16( tmp16 );
   \   000227   7409         MOV     A,#0x9
   \   000229   12....       LCALL   ?XSTACK_DISP0_8
   \   00022C   A3           INC     DPTR
   \   00022D   E0           MOVX    A,@DPTR
   \   00022E   F9           MOV     R1,A
   \   00022F   E9           MOV     A,R1
   \   000230   C0E0         PUSH    A
   \   000232   7411         MOV     A,#0x11
   \   000234   12....       LCALL   ?XSTACK_DISP0_8
   \   000237   D0E0         POP     A
   \   000239   F0           MOVX    @DPTR,A
   1029                  extAddr[1] = LO_UINT16( tmp16 );
   \   00023A   7409         MOV     A,#0x9
   \   00023C   12....       LCALL   ?XSTACK_DISP0_8
   \   00023F   E0           MOVX    A,@DPTR
   \   000240   C0E0         PUSH    A
   \   000242   7412         MOV     A,#0x12
   \   000244   12....       LCALL   ?XSTACK_DISP0_8
   \   000247   D0E0         POP     A
   \   000249   F0           MOVX    @DPTR,A
   1030                  len = sizeof ( tmp16 );
   \   00024A   7E02         MOV     R6,#0x2
   1031                  retValue = extAddr;
   \   00024C   7411         MOV     A,#0x11
   \   00024E   12....       LCALL   ?XSTACK_DISP0_8
   \   000251   A882         MOV     R0,DPL
   \   000253   A983         MOV     R1,DPH
   \   000255   7405         MOV     A,#0x5
   \   000257   12....       LCALL   ?XSTACK_DISP0_8
   \   00025A   E8           MOV     A,R0
   \   00025B   F0           MOVX    @DPTR,A
   \   00025C   A3           INC     DPTR
   \   00025D   E9           MOV     A,R1
   \   00025E   F0           MOVX    @DPTR,A
   \   00025F   02....       LJMP    ??MT_ProcessSerialCommand_0 & 0xFFFF
   1032                  break;
   1033          
   1034                case SPI_CMD_SYS_VERSION:
   1035                  {
   1036          #if !defined ( NONWK )
   1037                    uint8 i = NLME_GetProtocolVersion() - 1;
   \                     ??MT_ProcessSerialCommand_7:
   \   000262                ; Setup parameters for call to function NLME_GetProtocolVersion
   \   000262   12....       LCALL   ??NLME_GetProtocolVersion?relay
   \   000265   E9           MOV     A,R1
   \   000266   24FF         ADD     A,#-0x1
   \   000268   F5..         MOV     ?V0 + 0,A
   1038          #else
   1039                    uint8 i = 1;   // just say '1.1' -- irrelevant if stack isn't there anyway
   1040          #endif
   1041          
   1042                    // Get a message buffer to build response message
   1043                    len      = (byte)(osal_strlen( (char *)MTVersionString[i] ));
   \   00026A                ; Setup parameters for call to function osal_strlen
   \   00026A   A8..         MOV     R0,?V0 + 0
   \   00026C   7900         MOV     R1,#0x0
   \   00026E   E8           MOV     A,R0
   \   00026F   75F002       MOV     B,#0x2
   \   000272   A4           MUL     AB
   \   000273   C8           XCH     A,R0
   \   000274   AAF0         MOV     R2,B
   \   000276   75F000       MOV     B,#0x0
   \   000279   A4           MUL     AB
   \   00027A   2A           ADD     A,R2
   \   00027B   FA           MOV     R2,A
   \   00027C   75F002       MOV     B,#0x2
   \   00027F   E9           MOV     A,R1
   \   000280   A4           MUL     AB
   \   000281   2A           ADD     A,R2
   \   000282   F9           MOV     R1,A
   \   000283   E8           MOV     A,R0
   \   000284   24..         ADD     A,#(MTVersionString & 0xff)
   \   000286   F582         MOV     DPL,A
   \   000288   E9           MOV     A,R1
   \   000289   34..         ADDC    A,#((MTVersionString >> 8) & 0xff)
   \   00028B   F583         MOV     DPH,A
   \   00028D   E0           MOVX    A,@DPTR
   \   00028E   FA           MOV     R2,A
   \   00028F   A3           INC     DPTR
   \   000290   E0           MOVX    A,@DPTR
   \   000291   FB           MOV     R3,A
   \   000292   12....       LCALL   ??osal_strlen?relay
   \   000295   EA           MOV     A,R2
   \   000296   FE           MOV     R6,A
   1044                    retValue = (byte *)MTVersionString[i];
   \   000297   A8..         MOV     R0,?V0 + 0
   \   000299   7900         MOV     R1,#0x0
   \   00029B   E8           MOV     A,R0
   \   00029C   75F002       MOV     B,#0x2
   \   00029F   A4           MUL     AB
   \   0002A0   C8           XCH     A,R0
   \   0002A1   AAF0         MOV     R2,B
   \   0002A3   75F000       MOV     B,#0x0
   \   0002A6   A4           MUL     AB
   \   0002A7   2A           ADD     A,R2
   \   0002A8   FA           MOV     R2,A
   \   0002A9   75F002       MOV     B,#0x2
   \   0002AC   E9           MOV     A,R1
   \   0002AD   A4           MUL     AB
   \   0002AE   2A           ADD     A,R2
   \   0002AF   F9           MOV     R1,A
   \   0002B0   E8           MOV     A,R0
   \   0002B1   24..         ADD     A,#(MTVersionString & 0xff)
   \   0002B3   F582         MOV     DPL,A
   \   0002B5   E9           MOV     A,R1
   \   0002B6   34..         ADDC    A,#((MTVersionString >> 8) & 0xff)
   \   0002B8   F583         MOV     DPH,A
   \   0002BA   E0           MOVX    A,@DPTR
   \   0002BB   F8           MOV     R0,A
   \   0002BC   A3           INC     DPTR
   \   0002BD   E0           MOVX    A,@DPTR
   \   0002BE   F9           MOV     R1,A
   \   0002BF   7405         MOV     A,#0x5
   \   0002C1   12....       LCALL   ?XSTACK_DISP0_8
   \   0002C4   E8           MOV     A,R0
   \   0002C5   F0           MOVX    @DPTR,A
   \   0002C6   A3           INC     DPTR
   \   0002C7   E9           MOV     A,R1
   \   0002C8   F0           MOVX    @DPTR,A
   \   0002C9   02....       LJMP    ??MT_ProcessSerialCommand_0 & 0xFFFF
   1045                  }
   1046                    break;
   1047          
   1048                case SPI_CMD_SYS_SET_EXTADDR:
   1049                  // Incoming extended address is reversed
   1050                  MT_ReverseBytes( pData, Z_EXTADDR_LEN );
   \                     ??MT_ProcessSerialCommand_8:
   \   0002CC                ; Setup parameters for call to function MT_ReverseBytes
   \   0002CC   7908         MOV     R1,#0x8
   \   0002CE   85..82       MOV     DPL,?XSP + 0
   \   0002D1   85..83       MOV     DPH,?XSP + 1
   \   0002D4   E0           MOVX    A,@DPTR
   \   0002D5   FA           MOV     R2,A
   \   0002D6   A3           INC     DPTR
   \   0002D7   E0           MOVX    A,@DPTR
   \   0002D8   FB           MOV     R3,A
   \   0002D9   12....       LCALL   ??MT_ReverseBytes?relay
   1051          
   1052                  if ( ZMacSetReq( ZMacExtAddr, pData ) == ZMacSuccess )
   \   0002DC                ; Setup parameters for call to function ZMacSetReq
   \   0002DC   85..82       MOV     DPL,?XSP + 0
   \   0002DF   85..83       MOV     DPH,?XSP + 1
   \   0002E2   E0           MOVX    A,@DPTR
   \   0002E3   FA           MOV     R2,A
   \   0002E4   A3           INC     DPTR
   \   0002E5   E0           MOVX    A,@DPTR
   \   0002E6   FB           MOV     R3,A
   \   0002E7   79E2         MOV     R1,#-0x1e
   \   0002E9   12....       LCALL   ZMacSetReq & 0xFFFF
   \   0002EC   E9           MOV     A,R1
   \   0002ED   7031         JNZ     ??MT_ProcessSerialCommand_23
   1053                    ret = osal_nv_write( ZCD_NV_EXTADDR, 0, Z_EXTADDR_LEN, pData );
   \   0002EF                ; Setup parameters for call to function osal_nv_write
   \   0002EF   85..82       MOV     DPL,?XSP + 0
   \   0002F2   85..83       MOV     DPH,?XSP + 1
   \   0002F5   12....       LCALL   ?PUSH_XSTACK8_X_TWO
   \   0002F8   75..08       MOV     ?V0 + 0,#0x8
   \   0002FB   75..00       MOV     ?V0 + 1,#0x0
   \   0002FE   78..         MOV     R0,#?V0 + 0
   \   000300   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000303   7C00         MOV     R4,#0x0
   \   000305   7D00         MOV     R5,#0x0
   \   000307   7A01         MOV     R2,#0x1
   \   000309   7B00         MOV     R3,#0x0
   \   00030B   12....       LCALL   ??osal_nv_write?relay
   \   00030E   7404         MOV     A,#0x4
   \   000310   12....       LCALL   ?DEALLOC_XSTACK8
   \   000313   E9           MOV     A,R1
   \   000314   C0E0         PUSH    A
   \   000316   7402         MOV     A,#0x2
   \   000318   12....       LCALL   ?XSTACK_DISP0_8
   \   00031B   D0E0         POP     A
   \   00031D   F0           MOVX    @DPTR,A
   \   00031E   800C         SJMP    ??MT_ProcessSerialCommand_24
   1054                  else
   1055                    ret = 1;
   \                     ??MT_ProcessSerialCommand_23:
   \   000320   7401         MOV     A,#0x1
   \   000322   C0E0         PUSH    A
   \   000324   7402         MOV     A,#0x2
   \   000326   12....       LCALL   ?XSTACK_DISP0_8
   \   000329   D0E0         POP     A
   \   00032B   F0           MOVX    @DPTR,A
   1056                  len = 1;
   \                     ??MT_ProcessSerialCommand_24:
   \   00032C   7E01         MOV     R6,#0x1
   \   00032E   02....       LJMP    ??MT_ProcessSerialCommand_0 & 0xFFFF
   1057                  break;
   1058          
   1059                case SPI_CMD_SYS_GET_EXTADDR:
   1060                  ZMacGetReq( ZMacExtAddr, extAddr );
   \                     ??MT_ProcessSerialCommand_9:
   \   000331                ; Setup parameters for call to function ZMacGetReq
   \   000331   7411         MOV     A,#0x11
   \   000333   12....       LCALL   ?XSTACK_DISP0_8
   \   000336   AA82         MOV     R2,DPL
   \   000338   AB83         MOV     R3,DPH
   \   00033A   79E2         MOV     R1,#-0x1e
   \   00033C   12....       LCALL   ZMacGetReq & 0xFFFF
   1061          
   1062                  // Outgoing extended address needs to be reversed
   1063                  MT_ReverseBytes( extAddr, Z_EXTADDR_LEN );
   \   00033F                ; Setup parameters for call to function MT_ReverseBytes
   \   00033F   7908         MOV     R1,#0x8
   \   000341   7411         MOV     A,#0x11
   \   000343   12....       LCALL   ?XSTACK_DISP0_8
   \   000346   AA82         MOV     R2,DPL
   \   000348   AB83         MOV     R3,DPH
   \   00034A   12....       LCALL   ??MT_ReverseBytes?relay
   1064          
   1065                  len = Z_EXTADDR_LEN;
   \   00034D   7E08         MOV     R6,#0x8
   1066                  retValue = extAddr;
   \   00034F   7411         MOV     A,#0x11
   \   000351   12....       LCALL   ?XSTACK_DISP0_8
   \   000354   A882         MOV     R0,DPL
   \   000356   A983         MOV     R1,DPH
   \   000358   7405         MOV     A,#0x5
   \   00035A   12....       LCALL   ?XSTACK_DISP0_8
   \   00035D   E8           MOV     A,R0
   \   00035E   F0           MOVX    @DPTR,A
   \   00035F   A3           INC     DPTR
   \   000360   E9           MOV     A,R1
   \   000361   F0           MOVX    @DPTR,A
   \   000362   02....       LJMP    ??MT_ProcessSerialCommand_0 & 0xFFFF
   1067                  break;
   1068          
   1069          #if !defined ( NONWK )
   1070                case SPI_CMD_SYS_SET_PANID:
   1071                  tmp16 = BUILD_UINT16( pData[1], pData[0] );
   \                     ??MT_ProcessSerialCommand_18:
   \   000365   85..82       MOV     DPL,?XSP + 0
   \   000368   85..83       MOV     DPH,?XSP + 1
   \   00036B   E0           MOVX    A,@DPTR
   \   00036C   F8           MOV     R0,A
   \   00036D   A3           INC     DPTR
   \   00036E   E0           MOVX    A,@DPTR
   \   00036F   F583         MOV     DPH,A
   \   000371   8882         MOV     DPL,R0
   \   000373   A3           INC     DPTR
   \   000374   E0           MOVX    A,@DPTR
   \   000375   FA           MOV     R2,A
   \   000376   7B00         MOV     R3,#0x0
   \   000378   85..82       MOV     DPL,?XSP + 0
   \   00037B   85..83       MOV     DPH,?XSP + 1
   \   00037E   E0           MOVX    A,@DPTR
   \   00037F   F8           MOV     R0,A
   \   000380   A3           INC     DPTR
   \   000381   E0           MOVX    A,@DPTR
   \   000382   F583         MOV     DPH,A
   \   000384   8882         MOV     DPL,R0
   \   000386   E0           MOVX    A,@DPTR
   \   000387   F8           MOV     R0,A
   \   000388   E4           CLR     A
   \   000389   C8           XCH     A,R0
   \   00038A   F9           MOV     R1,A
   \   00038B   E8           MOV     A,R0
   \   00038C   2A           ADD     A,R2
   \   00038D   F8           MOV     R0,A
   \   00038E   E9           MOV     A,R1
   \   00038F   3B           ADDC    A,R3
   \   000390   F9           MOV     R1,A
   \   000391   7409         MOV     A,#0x9
   \   000393   12....       LCALL   ?XSTACK_DISP0_8
   \   000396   E8           MOV     A,R0
   \   000397   F0           MOVX    @DPTR,A
   \   000398   A3           INC     DPTR
   \   000399   E9           MOV     A,R1
   \   00039A   F0           MOVX    @DPTR,A
   1072                  attLen = osal_nv_item_len( ZCD_NV_PANID );
   \   00039B                ; Setup parameters for call to function osal_nv_item_len
   \   00039B   7A83         MOV     R2,#-0x7d
   \   00039D   7B00         MOV     R3,#0x0
   \   00039F   12....       LCALL   ??osal_nv_item_len?relay
   \   0003A2   7403         MOV     A,#0x3
   \   0003A4   12....       LCALL   ?XSTACK_DISP0_8
   \   0003A7   EA           MOV     A,R2
   \   0003A8   F0           MOVX    @DPTR,A
   \   0003A9   A3           INC     DPTR
   \   0003AA   EB           MOV     A,R3
   \   0003AB   F0           MOVX    @DPTR,A
   1073                  ret = osal_nv_write( ZCD_NV_PANID, 0, attLen, &tmp16 );
   \   0003AC                ; Setup parameters for call to function osal_nv_write
   \   0003AC   7409         MOV     A,#0x9
   \   0003AE   12....       LCALL   ?XSTACK_DISP0_8
   \   0003B1   8582..       MOV     ?V0 + 0,DPL
   \   0003B4   8583..       MOV     ?V0 + 1,DPH
   \   0003B7   78..         MOV     R0,#?V0 + 0
   \   0003B9   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0003BC   7405         MOV     A,#0x5
   \   0003BE   12....       LCALL   ?XSTACK_DISP0_8
   \   0003C1   12....       LCALL   ?PUSH_XSTACK8_X_TWO
   \   0003C4   7C00         MOV     R4,#0x0
   \   0003C6   7D00         MOV     R5,#0x0
   \   0003C8   7A83         MOV     R2,#-0x7d
   \   0003CA   7B00         MOV     R3,#0x0
   \   0003CC   12....       LCALL   ??osal_nv_write?relay
   \   0003CF   7404         MOV     A,#0x4
   \   0003D1   12....       LCALL   ?DEALLOC_XSTACK8
   \   0003D4   E9           MOV     A,R1
   \   0003D5   C0E0         PUSH    A
   \   0003D7   7402         MOV     A,#0x2
   \   0003D9   12....       LCALL   ?XSTACK_DISP0_8
   \   0003DC   D0E0         POP     A
   \   0003DE   F0           MOVX    @DPTR,A
   1074                  len = 1;
   \   0003DF   7E01         MOV     R6,#0x1
   \   0003E1   02....       LJMP    ??MT_ProcessSerialCommand_0 & 0xFFFF
   1075                  break;
   1076          
   1077                case SPI_CMD_SYS_SET_CHANNELS:
   1078                  tmp32 = BUILD_UINT32( pData[3], pData[2], pData[1], pData[0] );
   \                     ??MT_ProcessSerialCommand_19:
   \   0003E4   85..82       MOV     DPL,?XSP + 0
   \   0003E7   85..83       MOV     DPH,?XSP + 1
   \   0003EA   E0           MOVX    A,@DPTR
   \   0003EB   F8           MOV     R0,A
   \   0003EC   A3           INC     DPTR
   \   0003ED   E0           MOVX    A,@DPTR
   \   0003EE   F583         MOV     DPH,A
   \   0003F0   8882         MOV     DPL,R0
   \   0003F2   A3           INC     DPTR
   \   0003F3   A3           INC     DPTR
   \   0003F4   A3           INC     DPTR
   \   0003F5   E0           MOVX    A,@DPTR
   \   0003F6   F5..         MOV     ?V0 + 0,A
   \   0003F8   E4           CLR     A
   \   0003F9   F5..         MOV     ?V0 + 1,A
   \   0003FB   F5..         MOV     ?V0 + 2,A
   \   0003FD   F5..         MOV     ?V0 + 3,A
   \   0003FF   85..82       MOV     DPL,?XSP + 0
   \   000402   85..83       MOV     DPH,?XSP + 1
   \   000405   E0           MOVX    A,@DPTR
   \   000406   F8           MOV     R0,A
   \   000407   A3           INC     DPTR
   \   000408   E0           MOVX    A,@DPTR
   \   000409   F583         MOV     DPH,A
   \   00040B   8882         MOV     DPL,R0
   \   00040D   A3           INC     DPTR
   \   00040E   A3           INC     DPTR
   \   00040F   E0           MOVX    A,@DPTR
   \   000410   F5..         MOV     ?V0 + 4,A
   \   000412   E4           CLR     A
   \   000413   F5..         MOV     ?V0 + 5,A
   \   000415   F5..         MOV     ?V0 + 6,A
   \   000417   F5..         MOV     ?V0 + 7,A
   \   000419   7408         MOV     A,#0x8
   \   00041B   78..         MOV     R0,#?V0 + 4
   \   00041D   12....       LCALL   ?L_SHL
   \   000420   78..         MOV     R0,#?V0 + 0
   \   000422   79..         MOV     R1,#?V0 + 4
   \   000424   12....       LCALL   ?L_ADD
   \   000427   85..82       MOV     DPL,?XSP + 0
   \   00042A   85..83       MOV     DPH,?XSP + 1
   \   00042D   E0           MOVX    A,@DPTR
   \   00042E   F8           MOV     R0,A
   \   00042F   A3           INC     DPTR
   \   000430   E0           MOVX    A,@DPTR
   \   000431   F583         MOV     DPH,A
   \   000433   8882         MOV     DPL,R0
   \   000435   A3           INC     DPTR
   \   000436   E0           MOVX    A,@DPTR
   \   000437   F5..         MOV     ?V0 + 4,A
   \   000439   E4           CLR     A
   \   00043A   F5..         MOV     ?V0 + 5,A
   \   00043C   F5..         MOV     ?V0 + 6,A
   \   00043E   F5..         MOV     ?V0 + 7,A
   \   000440   7410         MOV     A,#0x10
   \   000442   78..         MOV     R0,#?V0 + 4
   \   000444   12....       LCALL   ?L_SHL
   \   000447   78..         MOV     R0,#?V0 + 0
   \   000449   79..         MOV     R1,#?V0 + 4
   \   00044B   12....       LCALL   ?L_ADD
   \   00044E   85..82       MOV     DPL,?XSP + 0
   \   000451   85..83       MOV     DPH,?XSP + 1
   \   000454   E0           MOVX    A,@DPTR
   \   000455   F8           MOV     R0,A
   \   000456   A3           INC     DPTR
   \   000457   E0           MOVX    A,@DPTR
   \   000458   F583         MOV     DPH,A
   \   00045A   8882         MOV     DPL,R0
   \   00045C   E0           MOVX    A,@DPTR
   \   00045D   F5..         MOV     ?V0 + 4,A
   \   00045F   E4           CLR     A
   \   000460   F5..         MOV     ?V0 + 5,A
   \   000462   F5..         MOV     ?V0 + 6,A
   \   000464   F5..         MOV     ?V0 + 7,A
   \   000466   7418         MOV     A,#0x18
   \   000468   78..         MOV     R0,#?V0 + 4
   \   00046A   12....       LCALL   ?L_SHL
   \   00046D   78..         MOV     R0,#?V0 + 0
   \   00046F   79..         MOV     R1,#?V0 + 4
   \   000471   12....       LCALL   ?L_ADD
   \   000474   740D         MOV     A,#0xd
   \   000476   12....       LCALL   ?XSTACK_DISP0_8
   \   000479   E5..         MOV     A,?V0 + 0
   \   00047B   F0           MOVX    @DPTR,A
   \   00047C   A3           INC     DPTR
   \   00047D   E5..         MOV     A,?V0 + 1
   \   00047F   F0           MOVX    @DPTR,A
   \   000480   A3           INC     DPTR
   \   000481   E5..         MOV     A,?V0 + 2
   \   000483   F0           MOVX    @DPTR,A
   \   000484   A3           INC     DPTR
   \   000485   E5..         MOV     A,?V0 + 3
   \   000487   F0           MOVX    @DPTR,A
   1079                  attLen = osal_nv_item_len( ZCD_NV_CHANLIST );
   \   000488                ; Setup parameters for call to function osal_nv_item_len
   \   000488   7A84         MOV     R2,#-0x7c
   \   00048A   7B00         MOV     R3,#0x0
   \   00048C   12....       LCALL   ??osal_nv_item_len?relay
   \   00048F   7403         MOV     A,#0x3
   \   000491   12....       LCALL   ?XSTACK_DISP0_8
   \   000494   EA           MOV     A,R2
   \   000495   F0           MOVX    @DPTR,A
   \   000496   A3           INC     DPTR
   \   000497   EB           MOV     A,R3
   \   000498   F0           MOVX    @DPTR,A
   1080                  ret = osal_nv_write( ZCD_NV_CHANLIST, 0, attLen, &tmp32 );
   \   000499                ; Setup parameters for call to function osal_nv_write
   \   000499   740D         MOV     A,#0xd
   \   00049B   12....       LCALL   ?XSTACK_DISP0_8
   \   00049E   8582..       MOV     ?V0 + 0,DPL
   \   0004A1   8583..       MOV     ?V0 + 1,DPH
   \   0004A4   78..         MOV     R0,#?V0 + 0
   \   0004A6   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0004A9   7405         MOV     A,#0x5
   \   0004AB   12....       LCALL   ?XSTACK_DISP0_8
   \   0004AE   12....       LCALL   ?PUSH_XSTACK8_X_TWO
   \   0004B1   7C00         MOV     R4,#0x0
   \   0004B3   7D00         MOV     R5,#0x0
   \   0004B5   7A84         MOV     R2,#-0x7c
   \   0004B7   7B00         MOV     R3,#0x0
   \   0004B9   12....       LCALL   ??osal_nv_write?relay
   \   0004BC   7404         MOV     A,#0x4
   \   0004BE   12....       LCALL   ?DEALLOC_XSTACK8
   \   0004C1   E9           MOV     A,R1
   \   0004C2   C0E0         PUSH    A
   \   0004C4   7402         MOV     A,#0x2
   \   0004C6   12....       LCALL   ?XSTACK_DISP0_8
   \   0004C9   D0E0         POP     A
   \   0004CB   F0           MOVX    @DPTR,A
   1081                  len = 1;
   \   0004CC   7E01         MOV     R6,#0x1
   \   0004CE   02....       LJMP    ??MT_ProcessSerialCommand_0 & 0xFFFF
   1082                  break;
   1083          
   1084                case SPI_CMD_SYS_SET_SECLEVEL:
   1085                  attLen = osal_nv_item_len( ZCD_NV_SECURITY_LEVEL );
   \                     ??MT_ProcessSerialCommand_20:
   \   0004D1                ; Setup parameters for call to function osal_nv_item_len
   \   0004D1   7A61         MOV     R2,#0x61
   \   0004D3   7B00         MOV     R3,#0x0
   \   0004D5   12....       LCALL   ??osal_nv_item_len?relay
   \   0004D8   7403         MOV     A,#0x3
   \   0004DA   12....       LCALL   ?XSTACK_DISP0_8
   \   0004DD   EA           MOV     A,R2
   \   0004DE   F0           MOVX    @DPTR,A
   \   0004DF   A3           INC     DPTR
   \   0004E0   EB           MOV     A,R3
   \   0004E1   F0           MOVX    @DPTR,A
   1086                  ret = osal_nv_write( ZCD_NV_SECURITY_LEVEL, 0, attLen, pData );
   \   0004E2                ; Setup parameters for call to function osal_nv_write
   \   0004E2   85..82       MOV     DPL,?XSP + 0
   \   0004E5   85..83       MOV     DPH,?XSP + 1
   \   0004E8   12....       LCALL   ?PUSH_XSTACK8_X_TWO
   \   0004EB   7405         MOV     A,#0x5
   \   0004ED   12....       LCALL   ?XSTACK_DISP0_8
   \   0004F0   12....       LCALL   ?PUSH_XSTACK8_X_TWO
   \   0004F3   7C00         MOV     R4,#0x0
   \   0004F5   7D00         MOV     R5,#0x0
   \   0004F7   7A61         MOV     R2,#0x61
   \   0004F9   7B00         MOV     R3,#0x0
   \   0004FB   12....       LCALL   ??osal_nv_write?relay
   \   0004FE   7404         MOV     A,#0x4
   \   000500   12....       LCALL   ?DEALLOC_XSTACK8
   \   000503   E9           MOV     A,R1
   \   000504   C0E0         PUSH    A
   \   000506   7402         MOV     A,#0x2
   \   000508   12....       LCALL   ?XSTACK_DISP0_8
   \   00050B   D0E0         POP     A
   \   00050D   F0           MOVX    @DPTR,A
   1087                  len = 1;
   \   00050E   7E01         MOV     R6,#0x1
   \   000510   02....       LJMP    ??MT_ProcessSerialCommand_0 & 0xFFFF
   1088                  break;
   1089          
   1090                case SPI_CMD_SYS_SET_PRECFGKEY:
   1091                  attLen = osal_nv_item_len( ZCD_NV_PRECFGKEY );
   \                     ??MT_ProcessSerialCommand_21:
   \   000513                ; Setup parameters for call to function osal_nv_item_len
   \   000513   7A62         MOV     R2,#0x62
   \   000515   7B00         MOV     R3,#0x0
   \   000517   12....       LCALL   ??osal_nv_item_len?relay
   \   00051A   7403         MOV     A,#0x3
   \   00051C   12....       LCALL   ?XSTACK_DISP0_8
   \   00051F   EA           MOV     A,R2
   \   000520   F0           MOVX    @DPTR,A
   \   000521   A3           INC     DPTR
   \   000522   EB           MOV     A,R3
   \   000523   F0           MOVX    @DPTR,A
   1092                  ret = osal_nv_write( ZCD_NV_PRECFGKEY, 0, attLen, pData );
   \   000524                ; Setup parameters for call to function osal_nv_write
   \   000524   85..82       MOV     DPL,?XSP + 0
   \   000527   85..83       MOV     DPH,?XSP + 1
   \   00052A   12....       LCALL   ?PUSH_XSTACK8_X_TWO
   \   00052D   7405         MOV     A,#0x5
   \   00052F   12....       LCALL   ?XSTACK_DISP0_8
   \   000532   12....       LCALL   ?PUSH_XSTACK8_X_TWO
   \   000535   7C00         MOV     R4,#0x0
   \   000537   7D00         MOV     R5,#0x0
   \   000539   7A62         MOV     R2,#0x62
   \   00053B   7B00         MOV     R3,#0x0
   \   00053D   12....       LCALL   ??osal_nv_write?relay
   \   000540   7404         MOV     A,#0x4
   \   000542   12....       LCALL   ?DEALLOC_XSTACK8
   \   000545   E9           MOV     A,R1
   \   000546   C0E0         PUSH    A
   \   000548   7402         MOV     A,#0x2
   \   00054A   12....       LCALL   ?XSTACK_DISP0_8
   \   00054D   D0E0         POP     A
   \   00054F   F0           MOVX    @DPTR,A
   1093                  len = 1;
   \   000550   7E01         MOV     R6,#0x1
   \   000552   02....       LJMP    ??MT_ProcessSerialCommand_0 & 0xFFFF
   1094                  break;
   1095          
   1096                case SPI_CMD_SYS_GET_NV_INFO:
   1097                  MT_ProcessGetNvInfo();
   \                     ??MT_ProcessSerialCommand_22:
   \   000555                ; Setup parameters for call to function MT_ProcessGetNvInfo
   \   000555   12....       LCALL   ??MT_ProcessGetNvInfo?relay
   \   000558   02....       LJMP    ??MT_ProcessSerialCommand_0 & 0xFFFF
   1098                  break;
   1099          #endif // NONWK
   1100          
   1101                case SPI_CMD_SYS_GET_DEVICE_INFO:
   1102                  MT_ProcessGetDeviceInfo();
   \                     ??MT_ProcessSerialCommand_12:
   \   00055B                ; Setup parameters for call to function MT_ProcessGetDeviceInfo
   \   00055B   12....       LCALL   ??MT_ProcessGetDeviceInfo?relay
   \   00055E   02....       LJMP    ??MT_ProcessSerialCommand_0 & 0xFFFF
   1103                  break;
   1104          
   1105                case SPI_CMD_SYS_SET_NV:
   1106                  ret = MT_ProcessSetNV( pData );
   \                     ??MT_ProcessSerialCommand_10:
   \   000561                ; Setup parameters for call to function MT_ProcessSetNV
   \   000561   85..82       MOV     DPL,?XSP + 0
   \   000564   85..83       MOV     DPH,?XSP + 1
   \   000567   E0           MOVX    A,@DPTR
   \   000568   FA           MOV     R2,A
   \   000569   A3           INC     DPTR
   \   00056A   E0           MOVX    A,@DPTR
   \   00056B   FB           MOV     R3,A
   \   00056C   12....       LCALL   ??MT_ProcessSetNV?relay
   \   00056F   E9           MOV     A,R1
   \   000570   C0E0         PUSH    A
   \   000572   7402         MOV     A,#0x2
   \   000574   12....       LCALL   ?XSTACK_DISP0_8
   \   000577   D0E0         POP     A
   \   000579   F0           MOVX    @DPTR,A
   1107                  len = 1;
   \   00057A   7E01         MOV     R6,#0x1
   \   00057C   02....       LJMP    ??MT_ProcessSerialCommand_0 & 0xFFFF
   1108                  break;
   1109          
   1110                case SPI_CMD_SYS_GET_NV:
   1111                  MT_ProcessGetNV( pData );
   \                     ??MT_ProcessSerialCommand_11:
   \   00057F                ; Setup parameters for call to function MT_ProcessGetNV
   \   00057F   85..82       MOV     DPL,?XSP + 0
   \   000582   85..83       MOV     DPH,?XSP + 1
   \   000585   E0           MOVX    A,@DPTR
   \   000586   FA           MOV     R2,A
   \   000587   A3           INC     DPTR
   \   000588   E0           MOVX    A,@DPTR
   \   000589   FB           MOV     R3,A
   \   00058A   12....       LCALL   ??MT_ProcessGetNV?relay
   \   00058D   02....       LJMP    ??MT_ProcessSerialCommand_0 & 0xFFFF
   1112                  break;
   1113          
   1114                case SPI_CMD_SYS_TIME_ALIVE:
   1115                  // Time since last reset (seconds)
   1116                  tmp32 = osal_GetSystemClock() / 1000;
   \                     ??MT_ProcessSerialCommand_17:
   \   000590                ; Setup parameters for call to function osal_GetSystemClock
   \   000590   12....       LCALL   ??osal_GetSystemClock?relay
   \   000593   8A..         MOV     ?V0 + 4,R2
   \   000595   8B..         MOV     ?V0 + 5,R3
   \   000597   8C..         MOV     ?V0 + 6,R4
   \   000599   8D..         MOV     ?V0 + 7,R5
   \   00059B   90....       MOV     DPTR,#__Constant_3e8
   \   00059E   78..         MOV     R0,#?V0 + 0
   \   0005A0   12....       LCALL   ?L_MOV_X
   \   0005A3   78..         MOV     R0,#?V0 + 4
   \   0005A5   79..         MOV     R1,#?V0 + 0
   \   0005A7   12....       LCALL   ?UL_DIV_MOD
   \   0005AA   740D         MOV     A,#0xd
   \   0005AC   12....       LCALL   ?XSTACK_DISP0_8
   \   0005AF   E5..         MOV     A,?V0 + 4
   \   0005B1   F0           MOVX    @DPTR,A
   \   0005B2   A3           INC     DPTR
   \   0005B3   E5..         MOV     A,?V0 + 5
   \   0005B5   F0           MOVX    @DPTR,A
   \   0005B6   A3           INC     DPTR
   \   0005B7   E5..         MOV     A,?V0 + 6
   \   0005B9   F0           MOVX    @DPTR,A
   \   0005BA   A3           INC     DPTR
   \   0005BB   E5..         MOV     A,?V0 + 7
   \   0005BD   F0           MOVX    @DPTR,A
   1117                  // Convert to high byte first into temp buffer
   1118                  extAddr[0] = BREAK_UINT32( tmp32, 3 );
   \   0005BE   740D         MOV     A,#0xd
   \   0005C0   12....       LCALL   ?XSTACK_DISP0_8
   \   0005C3   78..         MOV     R0,#?V0 + 0
   \   0005C5   12....       LCALL   ?L_MOV_X
   \   0005C8   7418         MOV     A,#0x18
   \   0005CA   78..         MOV     R0,#?V0 + 0
   \   0005CC   12....       LCALL   ?UL_SHR
   \   0005CF   7411         MOV     A,#0x11
   \   0005D1   12....       LCALL   ?XSTACK_DISP0_8
   \   0005D4   E5..         MOV     A,?V0 + 0
   \   0005D6   F0           MOVX    @DPTR,A
   1119                  extAddr[1] = BREAK_UINT32( tmp32, 2 );
   \   0005D7   740D         MOV     A,#0xd
   \   0005D9   12....       LCALL   ?XSTACK_DISP0_8
   \   0005DC   78..         MOV     R0,#?V0 + 0
   \   0005DE   12....       LCALL   ?L_MOV_X
   \   0005E1   7410         MOV     A,#0x10
   \   0005E3   78..         MOV     R0,#?V0 + 0
   \   0005E5   12....       LCALL   ?UL_SHR
   \   0005E8   7412         MOV     A,#0x12
   \   0005EA   12....       LCALL   ?XSTACK_DISP0_8
   \   0005ED   E5..         MOV     A,?V0 + 0
   \   0005EF   F0           MOVX    @DPTR,A
   1120                  extAddr[2] = BREAK_UINT32( tmp32, 1 );
   \   0005F0   740D         MOV     A,#0xd
   \   0005F2   12....       LCALL   ?XSTACK_DISP0_8
   \   0005F5   78..         MOV     R0,#?V0 + 0
   \   0005F7   12....       LCALL   ?L_MOV_X
   \   0005FA   E5..         MOV     A,?V0 + 1
   \   0005FC   F5..         MOV     ?V0 + 0,A
   \   0005FE   7413         MOV     A,#0x13
   \   000600   12....       LCALL   ?XSTACK_DISP0_8
   \   000603   E5..         MOV     A,?V0 + 0
   \   000605   F0           MOVX    @DPTR,A
   1121                  extAddr[3] = BREAK_UINT32( tmp32, 0 );
   \   000606   740D         MOV     A,#0xd
   \   000608   12....       LCALL   ?XSTACK_DISP0_8
   \   00060B   78..         MOV     R0,#?V0 + 0
   \   00060D   12....       LCALL   ?L_MOV_X
   \   000610   7414         MOV     A,#0x14
   \   000612   12....       LCALL   ?XSTACK_DISP0_8
   \   000615   E5..         MOV     A,?V0 + 0
   \   000617   F0           MOVX    @DPTR,A
   1122                  len = sizeof ( tmp32 );
   \   000618   7E04         MOV     R6,#0x4
   1123                  retValue = extAddr;
   \   00061A   7411         MOV     A,#0x11
   \   00061C   12....       LCALL   ?XSTACK_DISP0_8
   \   00061F   A882         MOV     R0,DPL
   \   000621   A983         MOV     R1,DPH
   \   000623   7405         MOV     A,#0x5
   \   000625   12....       LCALL   ?XSTACK_DISP0_8
   \   000628   E8           MOV     A,R0
   \   000629   F0           MOVX    @DPTR,A
   \   00062A   A3           INC     DPTR
   \   00062B   E9           MOV     A,R1
   \   00062C   F0           MOVX    @DPTR,A
   \   00062D   02....       LJMP    ??MT_ProcessSerialCommand_0 & 0xFFFF
   1124                  break;
   1125          
   1126                case SPI_CMD_SYS_KEY_EVENT:
   1127                  // Translate between SPI values to device values
   1128                  if ( pData[1] & 0x01 )
   \                     ??MT_ProcessSerialCommand_13:
   \   000630   85..82       MOV     DPL,?XSP + 0
   \   000633   85..83       MOV     DPH,?XSP + 1
   \   000636   E0           MOVX    A,@DPTR
   \   000637   F8           MOV     R0,A
   \   000638   A3           INC     DPTR
   \   000639   E0           MOVX    A,@DPTR
   \   00063A   F583         MOV     DPH,A
   \   00063C   8882         MOV     DPL,R0
   \   00063E   A3           INC     DPTR
   \   00063F   E0           MOVX    A,@DPTR
   \   000640   A2E0         MOV     C,0xE0 /* A   */.0
   \   000642   5005         JNC     ??MT_ProcessSerialCommand_25
   1129                    x |= HAL_KEY_SW_1;
   \   000644   D3           SETB    C
   \   000645   EF           MOV     A,R7
   \   000646   92E0         MOV     0xE0 /* A   */.0,C
   \   000648   FF           MOV     R7,A
   1130                  if ( pData[1] & 0x02 )
   \                     ??MT_ProcessSerialCommand_25:
   \   000649   85..82       MOV     DPL,?XSP + 0
   \   00064C   85..83       MOV     DPH,?XSP + 1
   \   00064F   E0           MOVX    A,@DPTR
   \   000650   F8           MOV     R0,A
   \   000651   A3           INC     DPTR
   \   000652   E0           MOVX    A,@DPTR
   \   000653   F583         MOV     DPH,A
   \   000655   8882         MOV     DPL,R0
   \   000657   A3           INC     DPTR
   \   000658   E0           MOVX    A,@DPTR
   \   000659   A2E1         MOV     C,0xE0 /* A   */.1
   \   00065B   5005         JNC     ??MT_ProcessSerialCommand_26
   1131                    x |= HAL_KEY_SW_2;
   \   00065D   D3           SETB    C
   \   00065E   EF           MOV     A,R7
   \   00065F   92E1         MOV     0xE0 /* A   */.1,C
   \   000661   FF           MOV     R7,A
   1132                  if ( pData[1] & 0x04 )
   \                     ??MT_ProcessSerialCommand_26:
   \   000662   85..82       MOV     DPL,?XSP + 0
   \   000665   85..83       MOV     DPH,?XSP + 1
   \   000668   E0           MOVX    A,@DPTR
   \   000669   F8           MOV     R0,A
   \   00066A   A3           INC     DPTR
   \   00066B   E0           MOVX    A,@DPTR
   \   00066C   F583         MOV     DPH,A
   \   00066E   8882         MOV     DPL,R0
   \   000670   A3           INC     DPTR
   \   000671   E0           MOVX    A,@DPTR
   \   000672   A2E2         MOV     C,0xE0 /* A   */.2
   \   000674   5005         JNC     ??MT_ProcessSerialCommand_27
   1133                    x |= HAL_KEY_SW_3;
   \   000676   D3           SETB    C
   \   000677   EF           MOV     A,R7
   \   000678   92E4         MOV     0xE0 /* A   */.4,C
   \   00067A   FF           MOV     R7,A
   1134                  if ( pData[1] & 0x08 )
   \                     ??MT_ProcessSerialCommand_27:
   \   00067B   85..82       MOV     DPL,?XSP + 0
   \   00067E   85..83       MOV     DPH,?XSP + 1
   \   000681   E0           MOVX    A,@DPTR
   \   000682   F8           MOV     R0,A
   \   000683   A3           INC     DPTR
   \   000684   E0           MOVX    A,@DPTR
   \   000685   F583         MOV     DPH,A
   \   000687   8882         MOV     DPL,R0
   \   000689   A3           INC     DPTR
   \   00068A   E0           MOVX    A,@DPTR
   \   00068B   A2E3         MOV     C,0xE0 /* A   */.3
   \   00068D   5005         JNC     ??MT_ProcessSerialCommand_28
   1135                    x |= HAL_KEY_SW_4;
   \   00068F   D3           SETB    C
   \   000690   EF           MOV     A,R7
   \   000691   92E3         MOV     0xE0 /* A   */.3,C
   \   000693   FF           MOV     R7,A
   1136          #if defined ( HAL_KEY_SW_5 )
   1137                  if ( pData[1] & 0x10 )
   \                     ??MT_ProcessSerialCommand_28:
   \   000694   85..82       MOV     DPL,?XSP + 0
   \   000697   85..83       MOV     DPH,?XSP + 1
   \   00069A   E0           MOVX    A,@DPTR
   \   00069B   F8           MOV     R0,A
   \   00069C   A3           INC     DPTR
   \   00069D   E0           MOVX    A,@DPTR
   \   00069E   F583         MOV     DPH,A
   \   0006A0   8882         MOV     DPL,R0
   \   0006A2   A3           INC     DPTR
   \   0006A3   E0           MOVX    A,@DPTR
   \   0006A4   A2E4         MOV     C,0xE0 /* A   */.4
   \   0006A6   5005         JNC     ??MT_ProcessSerialCommand_29
   1138                    x |= HAL_KEY_SW_5;
   \   0006A8   D3           SETB    C
   \   0006A9   EF           MOV     A,R7
   \   0006AA   92E2         MOV     0xE0 /* A   */.2,C
   \   0006AC   FF           MOV     R7,A
   1139          #endif
   1140          #if defined ( HAL_KEY_SW_6 )
   1141                  if ( pData[1] & 0x20 )
   \                     ??MT_ProcessSerialCommand_29:
   \   0006AD   85..82       MOV     DPL,?XSP + 0
   \   0006B0   85..83       MOV     DPH,?XSP + 1
   \   0006B3   E0           MOVX    A,@DPTR
   \   0006B4   F8           MOV     R0,A
   \   0006B5   A3           INC     DPTR
   \   0006B6   E0           MOVX    A,@DPTR
   \   0006B7   F583         MOV     DPH,A
   \   0006B9   8882         MOV     DPL,R0
   \   0006BB   A3           INC     DPTR
   \   0006BC   E0           MOVX    A,@DPTR
   \   0006BD   A2E5         MOV     C,0xE0 /* A   */.5
   \   0006BF   5005         JNC     ??MT_ProcessSerialCommand_30
   1142                    x |= HAL_KEY_SW_6;
   \   0006C1   D3           SETB    C
   \   0006C2   EF           MOV     A,R7
   \   0006C3   92E5         MOV     0xE0 /* A   */.5,C
   \   0006C5   FF           MOV     R7,A
   1143          #endif
   1144          #if defined ( HAL_KEY_SW_7 )
   1145                  if ( pData[1] & 0x40 )
   \                     ??MT_ProcessSerialCommand_30:
   \   0006C6   85..82       MOV     DPL,?XSP + 0
   \   0006C9   85..83       MOV     DPH,?XSP + 1
   \   0006CC   E0           MOVX    A,@DPTR
   \   0006CD   F8           MOV     R0,A
   \   0006CE   A3           INC     DPTR
   \   0006CF   E0           MOVX    A,@DPTR
   \   0006D0   F583         MOV     DPH,A
   \   0006D2   8882         MOV     DPL,R0
   \   0006D4   A3           INC     DPTR
   \   0006D5   E0           MOVX    A,@DPTR
   \   0006D6   A2E6         MOV     C,0xE0 /* A   */.6
   \   0006D8   5005         JNC     ??MT_ProcessSerialCommand_31
   1146                    x |= HAL_KEY_SW_7;
   \   0006DA   D3           SETB    C
   \   0006DB   EF           MOV     A,R7
   \   0006DC   92E6         MOV     0xE0 /* A   */.6,C
   \   0006DE   FF           MOV     R7,A
   1147          #endif
   1148          #if defined ( HAL_KEY_SW_8 )
   1149                  if ( pData[1] & 0x80 )
   1150                    x |= HAL_KEY_SW_8;
   1151          #endif
   1152                  ret = OnBoard_SendKeys( x, pData[0]  );
   \                     ??MT_ProcessSerialCommand_31:
   \   0006DF                ; Setup parameters for call to function OnBoard_SendKeys
   \   0006DF   85..82       MOV     DPL,?XSP + 0
   \   0006E2   85..83       MOV     DPH,?XSP + 1
   \   0006E5   E0           MOVX    A,@DPTR
   \   0006E6   F8           MOV     R0,A
   \   0006E7   A3           INC     DPTR
   \   0006E8   E0           MOVX    A,@DPTR
   \   0006E9   F583         MOV     DPH,A
   \   0006EB   8882         MOV     DPL,R0
   \   0006ED   E0           MOVX    A,@DPTR
   \   0006EE   FA           MOV     R2,A
   \   0006EF   EF           MOV     A,R7
   \   0006F0   F9           MOV     R1,A
   \   0006F1   12....       LCALL   ??OnBoard_SendKeys?relay
   \   0006F4   E9           MOV     A,R1
   \   0006F5   C0E0         PUSH    A
   \   0006F7   7402         MOV     A,#0x2
   \   0006F9   12....       LCALL   ?XSTACK_DISP0_8
   \   0006FC   D0E0         POP     A
   \   0006FE   F0           MOVX    @DPTR,A
   1153                  len = 1;
   \   0006FF   7E01         MOV     R6,#0x1
   \   000701   8059         SJMP    ??MT_ProcessSerialCommand_0
   1154                  break;
   1155          
   1156                case SPI_CMD_SYS_HEARTBEAT:
   1157                  ret = ZSUCCESS;
   \                     ??MT_ProcessSerialCommand_14:
   \   000703   7400         MOV     A,#0x0
   \   000705   C0E0         PUSH    A
   \   000707   7402         MOV     A,#0x2
   \   000709   12....       LCALL   ?XSTACK_DISP0_8
   \   00070C   D0E0         POP     A
   \   00070E   F0           MOVX    @DPTR,A
   1158                  len = 1;
   \   00070F   7E01         MOV     R6,#0x1
   \   000711   8049         SJMP    ??MT_ProcessSerialCommand_0
   1159                  break;
   1160          
   1161          #if !defined ( NONWK )
   1162                case SPI_CMD_SYS_APP_MSG:
   1163                  ret = MTProcessAppMsg( pData, msg[2] );
   \                     ??MT_ProcessSerialCommand_15:
   \   000713                ; Setup parameters for call to function MTProcessAppMsg
   \   000713   7407         MOV     A,#0x7
   \   000715   12....       LCALL   ?XSTACK_DISP0_8
   \   000718   E0           MOVX    A,@DPTR
   \   000719   F8           MOV     R0,A
   \   00071A   A3           INC     DPTR
   \   00071B   E0           MOVX    A,@DPTR
   \   00071C   F583         MOV     DPH,A
   \   00071E   8882         MOV     DPL,R0
   \   000720   A3           INC     DPTR
   \   000721   A3           INC     DPTR
   \   000722   E0           MOVX    A,@DPTR
   \   000723   F9           MOV     R1,A
   \   000724   85..82       MOV     DPL,?XSP + 0
   \   000727   85..83       MOV     DPH,?XSP + 1
   \   00072A   E0           MOVX    A,@DPTR
   \   00072B   FA           MOV     R2,A
   \   00072C   A3           INC     DPTR
   \   00072D   E0           MOVX    A,@DPTR
   \   00072E   FB           MOV     R3,A
   \   00072F   12....       LCALL   ??MTProcessAppMsg?relay
   \   000732   E9           MOV     A,R1
   \   000733   C0E0         PUSH    A
   \   000735   7402         MOV     A,#0x2
   \   000737   12....       LCALL   ?XSTACK_DISP0_8
   \   00073A   D0E0         POP     A
   \   00073C   F0           MOVX    @DPTR,A
   1164                  len = 0;
   \   00073D   7E00         MOV     R6,#0x0
   \   00073F   801B         SJMP    ??MT_ProcessSerialCommand_0
   1165                  break;
   1166          #endif // NONWK
   1167          
   1168                case SPI_CMD_SYS_LED_CONTROL:
   1169          #if (defined HAL_LED) && (HAL_LED == TRUE)
   1170                  ret = MTProcessLedControl( pData );
   \                     ??MT_ProcessSerialCommand_16:
   \   000741                ; Setup parameters for call to function MTProcessLedControl
   \   000741   85..82       MOV     DPL,?XSP + 0
   \   000744   85..83       MOV     DPH,?XSP + 1
   \   000747   E0           MOVX    A,@DPTR
   \   000748   FA           MOV     R2,A
   \   000749   A3           INC     DPTR
   \   00074A   E0           MOVX    A,@DPTR
   \   00074B   FB           MOV     R3,A
   \   00074C   12....       LCALL   ??MTProcessLedControl?relay
   \   00074F   E9           MOV     A,R1
   \   000750   C0E0         PUSH    A
   \   000752   7402         MOV     A,#0x2
   \   000754   12....       LCALL   ?XSTACK_DISP0_8
   \   000757   D0E0         POP     A
   \   000759   F0           MOVX    @DPTR,A
   1171                  len = 1;
   \   00075A   7E01         MOV     R6,#0x1
   1172          #endif
   1173                  break;
   1174          
   1175          #ifdef MT_MAC_FUNC
   1176                case SPI_CMD_MAC_INIT:
   1177                case SPI_CMD_MAC_ASSOCIATE_REQ:
   1178                case SPI_CMD_MAC_ASSOCIATE_RSP:
   1179                case SPI_CMD_MAC_DISASSOCIATE_REQ:
   1180                case SPI_CMD_MAC_DATA_REQ:
   1181                case SPI_CMD_MAC_GET_REQ:
   1182                case SPI_CMD_MAC_SET_REQ:
   1183                case SPI_CMD_MAC_START_REQ:
   1184                case SPI_CMD_MAC_SCAN_REQ:
   1185                case SPI_CMD_MAC_RESET_REQ:
   1186                case SPI_CMD_MAC_GTS_REQ:
   1187                case SPI_CMD_MAC_ORPHAN_RSP:
   1188                case SPI_CMD_MAC_RX_ENABLE_REQ:
   1189                case SPI_CMD_MAC_SYNC_REQ:
   1190                case SPI_CMD_MAC_POLL_REQ:
   1191                case SPI_CMD_MAC_PURGE_REQ:
   1192                  MT_MacCommandProcessing( cmd , len , pData );
   1193                  break;
   1194          #endif
   1195          
   1196          #ifdef MT_NWK_FUNC
   1197                case SPI_CMD_NWK_INIT:
   1198                case SPI_CMD_NLDE_DATA_REQ:
   1199                case SPI_CMD_NLME_INIT_COORD_REQ:
   1200                case SPI_CMD_NLME_PERMIT_JOINING_REQ:
   1201                case SPI_CMD_NLME_JOIN_REQ:
   1202                case SPI_CMD_NLME_LEAVE_REQ:
   1203                case SPI_CMD_NLME_RESET_REQ:
   1204                case SPI_CMD_NLME_RX_STATE_REQ:
   1205                case SPI_CMD_NLME_GET_REQ:
   1206                case SPI_CMD_NLME_SET_REQ:
   1207                case SPI_CMD_NLME_NWK_DISC_REQ:
   1208                case SPI_CMD_NLME_ROUTE_DISC_REQ:
   1209                case SPI_CMD_NLME_DIRECT_JOIN_REQ:
   1210                case SPI_CMD_NLME_ORPHAN_JOIN_REQ:
   1211                case SPI_CMD_NLME_START_ROUTER_REQ:
   1212                  MT_NwkCommandProcessing( cmd , len , pData );
   1213                  break;
   1214          #endif
   1215          
   1216          #ifdef MT_ZDO_FUNC
   1217                case SPI_CMD_ZDO_AUTO_ENDDEVICEBIND_REQ:
   1218                case SPI_CMD_ZDO_AUTO_FIND_DESTINATION_REQ:
   1219                case SPI_CMD_ZDO_NWK_ADDR_REQ:
   1220                case SPI_CMD_ZDO_IEEE_ADDR_REQ:
   1221                case SPI_CMD_ZDO_NODE_DESC_REQ:
   1222                case SPI_CMD_ZDO_POWER_DESC_REQ:
   1223                case SPI_CMD_ZDO_SIMPLE_DESC_REQ:
   1224                case SPI_CMD_ZDO_ACTIVE_EPINT_REQ:
   1225                case SPI_CMD_ZDO_MATCH_DESC_REQ:
   1226                case SPI_CMD_ZDO_COMPLEX_DESC_REQ:
   1227                case SPI_CMD_ZDO_USER_DESC_REQ:
   1228                case SPI_CMD_ZDO_END_DEV_BIND_REQ:
   1229                case SPI_CMD_ZDO_BIND_REQ:
   1230                case SPI_CMD_ZDO_UNBIND_REQ:
   1231                case SPI_CMD_ZDO_MGMT_NWKDISC_REQ:
   1232                case SPI_CMD_ZDO_MGMT_LQI_REQ:
   1233                case SPI_CMD_ZDO_MGMT_RTG_REQ:
   1234                case SPI_CMD_ZDO_MGMT_BIND_REQ:
   1235                case SPI_CMD_ZDO_MGMT_DIRECT_JOIN_REQ:
   1236                case SPI_CMD_ZDO_USER_DESC_SET:
   1237                case SPI_CMD_ZDO_END_DEV_ANNCE:
   1238                case SPI_CMD_ZDO_MGMT_LEAVE_REQ:
   1239                case SPI_CMD_ZDO_MGMT_PERMIT_JOIN_REQ:
   1240                case SPI_CMD_ZDO_SERVERDISC_REQ:
   1241                case SPI_CMD_ZDO_NETWORK_START_REQ:
   1242                  MT_ZdoCommandProcessing( cmd , len , pData );
   1243                  break;
   1244          #endif
   1245          
   1246          #if defined ( MT_AF_FUNC )
   1247                case SPI_CMD_AF_INIT:
   1248                case SPI_CMD_AF_REGISTER:
   1249                case SPI_CMD_AF_SENDMSG:
   1250                  MT_afCommandProcessing( cmd , len , pData );
   1251                  break;
   1252          #endif
   1253          
   1254          #if defined ( MT_SAPI_FUNC )
   1255                case SPI_CMD_SAPI_SYS_RESET:
   1256                case SPI_CMD_SAPI_START_REQ:
   1257                case SPI_CMD_SAPI_BIND_DEVICE:
   1258                case SPI_CMD_SAPI_ALLOW_BIND:
   1259                case SPI_CMD_SAPI_SEND_DATA:
   1260                case SPI_CMD_SAPI_READ_CFG:
   1261                case SPI_CMD_SAPI_WRITE_CFG:
   1262                case SPI_CMD_SAPI_GET_DEV_INFO:
   1263                case SPI_CMD_SAPI_FIND_DEV:
   1264                case SPI_CMD_SAPI_PMT_JOIN:
   1265                  ret = MT_sapiCommandProcessing( cmd , len , pData );
   1266                  if ( ret == 0xff )
   1267                    len = 0;
   1268                  else
   1269                    len = 1;
   1270                  break;
   1271          #endif
   1272          
   1273          #if defined ( MT_USER_TEST_FUNC )
   1274                case SPI_CMD_USER_TEST:
   1275                  MT_ProcessAppUserCmd( pData );
   1276                  break;
   1277          #endif
   1278          
   1279                default:
   1280                  break;
   1281              }
   1282          
   1283              if ( len )
   \                     ??MT_ProcessSerialCommand_0:
   \   00075C   EE           MOV     A,R6
   \   00075D   6024         JZ      ??MT_ProcessSerialCommand_32
   1284              {
   1285                MT_BuildAndSendZToolResponse( (SPI_0DATA_MSG_LEN + len),
   1286                                              (SPI_RESPONSE_BIT | cmd),
   1287                                              len, retValue );
   \   00075F                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   00075F   7405         MOV     A,#0x5
   \   000761   12....       LCALL   ?XSTACK_DISP0_8
   \   000764   12....       LCALL   ?PUSH_XSTACK8_X_TWO
   \   000767   EE           MOV     A,R6
   \   000768   FC           MOV     R4,A
   \   000769   740D         MOV     A,#0xd
   \   00076B   12....       LCALL   ?XSTACK_DISP0_8
   \   00076E   E0           MOVX    A,@DPTR
   \   00076F   4400         ORL     A,#0x0
   \   000771   FA           MOV     R2,A
   \   000772   A3           INC     DPTR
   \   000773   E0           MOVX    A,@DPTR
   \   000774   4410         ORL     A,#0x10
   \   000776   FB           MOV     R3,A
   \   000777   7405         MOV     A,#0x5
   \   000779   2E           ADD     A,R6
   \   00077A   F9           MOV     R1,A
   \   00077B   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
   \   00077E   7402         MOV     A,#0x2
   \   000780   12....       LCALL   ?DEALLOC_XSTACK8
   1288              }
   1289            }
   \                     ??MT_ProcessSerialCommand_32:
   \   000783   741B         MOV     A,#0x1b
   \   000785   12....       LCALL   ?DEALLOC_XSTACK8
   \   000788   7F08         MOV     R7,#0x8
   \   00078A   02....       LJMP    ?BANKED_LEAVE_XDATA
   1290          #endif // ZTOOL
   1291          
   1292          #if (defined HAL_LED) && (HAL_LED == TRUE)
   1293          /***************************************************************************************************
   1294           * @fn      MTProcessLedControl
   1295           *
   1296           * @brief
   1297           *
   1298           *   Process the LED Control Message
   1299           *
   1300           * @param   data - input serial buffer
   1301           *
   1302           * @return  status
   1303           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1304          byte MTProcessLedControl( byte *pData )
   \                     MTProcessLedControl:
   1305          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
   1306            byte iLed;
   1307            byte Led;
   1308            byte iMode;
   1309            byte Mode;
   1310          
   1311            iLed = *pData++;
   \   000009   8E82         MOV     DPL,R6
   \   00000B   8F83         MOV     DPH,R7
   \   00000D   E0           MOVX    A,@DPTR
   \   00000E   F5..         MOV     ?V0 + 0,A
   \   000010   8E82         MOV     DPL,R6
   \   000012   8F83         MOV     DPH,R7
   \   000014   A3           INC     DPTR
   \   000015   AE82         MOV     R6,DPL
   \   000017   AF83         MOV     R7,DPH
   1312            iMode = *pData;
   \   000019   8E82         MOV     DPL,R6
   \   00001B   8F83         MOV     DPH,R7
   \   00001D   E0           MOVX    A,@DPTR
   \   00001E   F5..         MOV     ?V0 + 2,A
   1313          
   1314            if ( iLed == 1 )
   \   000020   7401         MOV     A,#0x1
   \   000022   65..         XRL     A,?V0 + 0
   \   000024   7005         JNZ     ??MTProcessLedControl_0
   1315              Led = HAL_LED_1;
   \   000026   75..01       MOV     ?V0 + 1,#0x1
   \   000029   802F         SJMP    ??MTProcessLedControl_1
   1316            else if ( iLed == 2 )
   \                     ??MTProcessLedControl_0:
   \   00002B   7402         MOV     A,#0x2
   \   00002D   65..         XRL     A,?V0 + 0
   \   00002F   7005         JNZ     ??MTProcessLedControl_2
   1317              Led = HAL_LED_2;
   \   000031   75..02       MOV     ?V0 + 1,#0x2
   \   000034   8024         SJMP    ??MTProcessLedControl_1
   1318            else if ( iLed == 3 )
   \                     ??MTProcessLedControl_2:
   \   000036   7403         MOV     A,#0x3
   \   000038   65..         XRL     A,?V0 + 0
   \   00003A   7005         JNZ     ??MTProcessLedControl_3
   1319              Led = HAL_LED_3;
   \   00003C   75..04       MOV     ?V0 + 1,#0x4
   \   00003F   8019         SJMP    ??MTProcessLedControl_1
   1320            else if ( iLed == 4 )
   \                     ??MTProcessLedControl_3:
   \   000041   7404         MOV     A,#0x4
   \   000043   65..         XRL     A,?V0 + 0
   \   000045   7005         JNZ     ??MTProcessLedControl_4
   1321              Led = HAL_LED_4;
   \   000047   75..08       MOV     ?V0 + 1,#0x8
   \   00004A   800E         SJMP    ??MTProcessLedControl_1
   1322            else if ( iLed == 0xFF )
   \                     ??MTProcessLedControl_4:
   \   00004C   74FF         MOV     A,#-0x1
   \   00004E   65..         XRL     A,?V0 + 0
   \   000050   7005         JNZ     ??MTProcessLedControl_5
   1323              Led = HAL_LED_ALL;
   \   000052   75..0F       MOV     ?V0 + 1,#0xf
   \   000055   8003         SJMP    ??MTProcessLedControl_1
   1324            else
   1325              Led = 0;
   \                     ??MTProcessLedControl_5:
   \   000057   75..00       MOV     ?V0 + 1,#0x0
   1326          
   1327            if ( iMode == 0 )
   \                     ??MTProcessLedControl_1:
   \   00005A   E5..         MOV     A,?V0 + 2
   \   00005C   7005         JNZ     ??MTProcessLedControl_6
   1328              Mode = HAL_LED_MODE_OFF;
   \   00005E   75..00       MOV     ?V0 + 3,#0x0
   \   000061   802F         SJMP    ??MTProcessLedControl_7
   1329            else if ( iMode == 1 )
   \                     ??MTProcessLedControl_6:
   \   000063   7401         MOV     A,#0x1
   \   000065   65..         XRL     A,?V0 + 2
   \   000067   7005         JNZ     ??MTProcessLedControl_8
   1330              Mode = HAL_LED_MODE_ON;
   \   000069   75..01       MOV     ?V0 + 3,#0x1
   \   00006C   8024         SJMP    ??MTProcessLedControl_7
   1331            else if ( iMode == 2 )
   \                     ??MTProcessLedControl_8:
   \   00006E   7402         MOV     A,#0x2
   \   000070   65..         XRL     A,?V0 + 2
   \   000072   7005         JNZ     ??MTProcessLedControl_9
   1332              Mode = HAL_LED_MODE_BLINK;
   \   000074   75..02       MOV     ?V0 + 3,#0x2
   \   000077   8019         SJMP    ??MTProcessLedControl_7
   1333            else if ( iMode == 3 )
   \                     ??MTProcessLedControl_9:
   \   000079   7403         MOV     A,#0x3
   \   00007B   65..         XRL     A,?V0 + 2
   \   00007D   7005         JNZ     ??MTProcessLedControl_10
   1334              Mode = HAL_LED_MODE_FLASH;
   \   00007F   75..04       MOV     ?V0 + 3,#0x4
   \   000082   800E         SJMP    ??MTProcessLedControl_7
   1335            else if ( iMode == 4 )
   \                     ??MTProcessLedControl_10:
   \   000084   7404         MOV     A,#0x4
   \   000086   65..         XRL     A,?V0 + 2
   \   000088   7005         JNZ     ??MTProcessLedControl_11
   1336              Mode = HAL_LED_MODE_TOGGLE;
   \   00008A   75..08       MOV     ?V0 + 3,#0x8
   \   00008D   8003         SJMP    ??MTProcessLedControl_7
   1337            else
   1338              Led = 0;
   \                     ??MTProcessLedControl_11:
   \   00008F   75..00       MOV     ?V0 + 1,#0x0
   1339          
   1340            if ( Led != 0 )
   \                     ??MTProcessLedControl_7:
   \   000092   E5..         MOV     A,?V0 + 1
   \   000094   600B         JZ      ??MTProcessLedControl_12
   1341            {
   1342              HalLedSet (Led, Mode );
   \   000096                ; Setup parameters for call to function HalLedSet
   \   000096   AA..         MOV     R2,?V0 + 3
   \   000098   A9..         MOV     R1,?V0 + 1
   \   00009A   12....       LCALL   ??HalLedSet?relay
   1343              return ( ZSuccess );
   \   00009D   7900         MOV     R1,#0x0
   \   00009F   8002         SJMP    ??MTProcessLedControl_13
   1344            }
   1345            else
   1346              return ( ZFailure );
   \                     ??MTProcessLedControl_12:
   \   0000A1   7901         MOV     R1,#0x1
   \                     ??MTProcessLedControl_13:
   \   0000A3   7F04         MOV     R7,#0x4
   \   0000A5   02....       LJMP    ?BANKED_LEAVE_XDATA
   1347          }
   1348          #endif // HAL_LED
   1349          
   1350          #if !defined ( NONWK )
   1351          /*********************************************************************
   1352           * @fn      MTProcessAppMsg
   1353           *
   1354           * @brief
   1355           *
   1356           *   Process the User App Message
   1357           *
   1358           * @param   data - input serial buffer
   1359           * @param   len - data length
   1360           *
   1361           * @return  status
   1362           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1363          byte MTProcessAppMsg( byte *pData, byte len )
   \                     MTProcessAppMsg:
   1364          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 2
   \   000005   74FE         MOV     A,#-0x2
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   8A..         MOV     ?V0 + 6,R2
   \   00000C   8B..         MOV     ?V0 + 7,R3
   \   00000E   E9           MOV     A,R1
   \   00000F   FE           MOV     R6,A
   1365            byte ret = ZFailure;
   \   000010   7F01         MOV     R7,#0x1
   1366            byte endpoint;
   1367            endPointDesc_t *epDesc;
   1368            mtSysAppMsg_t *msg;
   1369          
   1370            // Get the endpoint and skip past it.
   1371            endpoint = *pData++;
   \   000012   85..82       MOV     DPL,?V0 + 6
   \   000015   85..83       MOV     DPH,?V0 + 7
   \   000018   E0           MOVX    A,@DPTR
   \   000019   F5..         MOV     ?V0 + 3,A
   \   00001B   85..82       MOV     DPL,?V0 + 6
   \   00001E   85..83       MOV     DPH,?V0 + 7
   \   000021   A3           INC     DPTR
   \   000022   8582..       MOV     ?V0 + 6,DPL
   \   000025   8583..       MOV     ?V0 + 7,DPH
   1372            len--;
   \   000028   1E           DEC     R6
   1373          
   1374            // Look up the endpoint
   1375            epDesc = afFindEndPointDesc( endpoint );
   \   000029                ; Setup parameters for call to function afFindEndPointDesc
   \   000029   A9..         MOV     R1,?V0 + 3
   \   00002B   12....       LCALL   ??afFindEndPointDesc?relay
   \   00002E   85..82       MOV     DPL,?XSP + 0
   \   000031   85..83       MOV     DPH,?XSP + 1
   \   000034   EA           MOV     A,R2
   \   000035   F0           MOVX    @DPTR,A
   \   000036   A3           INC     DPTR
   \   000037   EB           MOV     A,R3
   \   000038   F0           MOVX    @DPTR,A
   1376          
   1377            if ( epDesc )
   \   000039   85..82       MOV     DPL,?XSP + 0
   \   00003C   85..83       MOV     DPH,?XSP + 1
   \   00003F   E0           MOVX    A,@DPTR
   \   000040   6400         XRL     A,#0x0
   \   000042   7004         JNZ     ??MTProcessAppMsg_0
   \   000044   A3           INC     DPTR
   \   000045   E0           MOVX    A,@DPTR
   \   000046   6400         XRL     A,#0x0
   \                     ??MTProcessAppMsg_0:
   \   000048   7003         JNZ     $+5
   \   00004A   02....       LJMP    ??MTProcessAppMsg_1 & 0xFFFF
   1378            {
   1379              // Build and send the message to the APP
   1380              msg = (mtSysAppMsg_t *)osal_msg_allocate( sizeof( mtSysAppMsg_t ) + len );
   \   00004D                ; Setup parameters for call to function osal_msg_allocate
   \   00004D   8E..         MOV     ?V0 + 0,R6
   \   00004F   75..00       MOV     ?V0 + 1,#0x0
   \   000052   7406         MOV     A,#0x6
   \   000054   25..         ADD     A,?V0 + 0
   \   000056   FA           MOV     R2,A
   \   000057   7400         MOV     A,#0x0
   \   000059   35..         ADDC    A,?V0 + 1
   \   00005B   FB           MOV     R3,A
   \   00005C   12....       LCALL   ??osal_msg_allocate?relay
   \   00005F   8A..         MOV     ?V0 + 0,R2
   \   000061   8B..         MOV     ?V0 + 1,R3
   \   000063   85....       MOV     ?V0 + 4,?V0 + 0
   \   000066   85....       MOV     ?V0 + 5,?V0 + 1
   1381              if ( msg )
   \   000069   E5..         MOV     A,?V0 + 4
   \   00006B   6400         XRL     A,#0x0
   \   00006D   7004         JNZ     ??MTProcessAppMsg_2
   \   00006F   E5..         MOV     A,?V0 + 5
   \   000071   6400         XRL     A,#0x0
   \                     ??MTProcessAppMsg_2:
   \   000073   7003         JNZ     $+5
   \   000075   02....       LJMP    ??MTProcessAppMsg_1 & 0xFFFF
   1382              {
   1383                msg->hdr.event = MT_SYS_APP_MSG;
   \   000078   7423         MOV     A,#0x23
   \   00007A   85..82       MOV     DPL,?V0 + 4
   \   00007D   85..83       MOV     DPH,?V0 + 5
   \   000080   F0           MOVX    @DPTR,A
   1384                msg->endpoint = endpoint;
   \   000081   85..82       MOV     DPL,?V0 + 4
   \   000084   85..83       MOV     DPH,?V0 + 5
   \   000087   A3           INC     DPTR
   \   000088   A3           INC     DPTR
   \   000089   E5..         MOV     A,?V0 + 3
   \   00008B   F0           MOVX    @DPTR,A
   1385                msg->appDataLen = len;
   \   00008C   EE           MOV     A,R6
   \   00008D   85..82       MOV     DPL,?V0 + 4
   \   000090   85..83       MOV     DPH,?V0 + 5
   \   000093   A3           INC     DPTR
   \   000094   A3           INC     DPTR
   \   000095   A3           INC     DPTR
   \   000096   F0           MOVX    @DPTR,A
   1386                msg->appData = (uint8*)(msg+1);
   \   000097   E5..         MOV     A,?V0 + 4
   \   000099   2406         ADD     A,#0x6
   \   00009B   F8           MOV     R0,A
   \   00009C   E5..         MOV     A,?V0 + 5
   \   00009E   3400         ADDC    A,#0x0
   \   0000A0   F9           MOV     R1,A
   \   0000A1   85..82       MOV     DPL,?V0 + 4
   \   0000A4   85..83       MOV     DPH,?V0 + 5
   \   0000A7   A3           INC     DPTR
   \   0000A8   A3           INC     DPTR
   \   0000A9   A3           INC     DPTR
   \   0000AA   A3           INC     DPTR
   \   0000AB   E8           MOV     A,R0
   \   0000AC   F0           MOVX    @DPTR,A
   \   0000AD   A3           INC     DPTR
   \   0000AE   E9           MOV     A,R1
   \   0000AF   F0           MOVX    @DPTR,A
   1387          
   1388                osal_memcpy( msg->appData, pData, len );
   \   0000B0                ; Setup parameters for call to function osal_memcpy
   \   0000B0   85....       MOV     ?V0 + 0,?V0 + 6
   \   0000B3   85....       MOV     ?V0 + 1,?V0 + 7
   \   0000B6   75..00       MOV     ?V0 + 2,#0x0
   \   0000B9   78..         MOV     R0,#?V0 + 0
   \   0000BB   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   0000BE   EE           MOV     A,R6
   \   0000BF   F5..         MOV     ?V0 + 0,A
   \   0000C1   AC..         MOV     R4,?V0 + 0
   \   0000C3   7D00         MOV     R5,#0x0
   \   0000C5   85..82       MOV     DPL,?V0 + 4
   \   0000C8   85..83       MOV     DPH,?V0 + 5
   \   0000CB   A3           INC     DPTR
   \   0000CC   A3           INC     DPTR
   \   0000CD   A3           INC     DPTR
   \   0000CE   A3           INC     DPTR
   \   0000CF   E0           MOVX    A,@DPTR
   \   0000D0   FA           MOV     R2,A
   \   0000D1   A3           INC     DPTR
   \   0000D2   E0           MOVX    A,@DPTR
   \   0000D3   FB           MOV     R3,A
   \   0000D4   12....       LCALL   ??osal_memcpy?relay
   \   0000D7   7403         MOV     A,#0x3
   \   0000D9   12....       LCALL   ?DEALLOC_XSTACK8
   1389          
   1390                osal_msg_send( *(epDesc->task_id), (uint8 *)msg );
   \   0000DC                ; Setup parameters for call to function osal_msg_send
   \   0000DC   AA..         MOV     R2,?V0 + 4
   \   0000DE   AB..         MOV     R3,?V0 + 5
   \   0000E0   85..82       MOV     DPL,?XSP + 0
   \   0000E3   85..83       MOV     DPH,?XSP + 1
   \   0000E6   E0           MOVX    A,@DPTR
   \   0000E7   F8           MOV     R0,A
   \   0000E8   A3           INC     DPTR
   \   0000E9   E0           MOVX    A,@DPTR
   \   0000EA   F583         MOV     DPH,A
   \   0000EC   8882         MOV     DPL,R0
   \   0000EE   A3           INC     DPTR
   \   0000EF   E0           MOVX    A,@DPTR
   \   0000F0   F8           MOV     R0,A
   \   0000F1   A3           INC     DPTR
   \   0000F2   E0           MOVX    A,@DPTR
   \   0000F3   F583         MOV     DPH,A
   \   0000F5   8882         MOV     DPL,R0
   \   0000F7   E0           MOVX    A,@DPTR
   \   0000F8   F9           MOV     R1,A
   \   0000F9   12....       LCALL   ??osal_msg_send?relay
   1391          
   1392                ret = ZSuccess;
   \   0000FC   7F00         MOV     R7,#0x0
   1393              }
   1394            }
   1395          
   1396            return ret;
   \                     ??MTProcessAppMsg_1:
   \   0000FE   EF           MOV     A,R7
   \   0000FF   F9           MOV     R1,A
   \   000100   7402         MOV     A,#0x2
   \   000102   12....       LCALL   ?DEALLOC_XSTACK8
   \   000105   7F08         MOV     R7,#0x8
   \   000107   02....       LJMP    ?BANKED_LEAVE_XDATA
   1397          }
   1398          #endif // NONWK
   1399          
   1400          #if defined ( ZTOOL_PORT )
   1401          /*********************************************************************
   1402           * @fn      MTProcessAppRspMsg
   1403           *
   1404           * @brief
   1405           *
   1406           *   Process the User App Response Message
   1407           *
   1408           * @param   data - output serial buffer.  The first byte must be the
   1409           *          endpoint that send this message.
   1410           * @param   len - data length
   1411           *
   1412           * @return  none
   1413           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1414          void MTProcessAppRspMsg( byte *pData, byte len )
   \                     MTProcessAppRspMsg:
   1415          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   8A..         MOV     ?V0 + 0,R2
   \   000007   8B..         MOV     ?V0 + 1,R3
   \   000009   E9           MOV     A,R1
   \   00000A   FE           MOV     R6,A
   1416            // Send out Reset Response message
   1417            MT_BuildAndSendZToolResponse( (SPI_0DATA_MSG_LEN + len),
   1418                                          (SPI_RESPONSE_BIT | SPI_CMD_SYS_APP_MSG),
   1419                                          len, pData );
   \   00000B                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   00000B   78..         MOV     R0,#?V0 + 0
   \   00000D   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000010   EE           MOV     A,R6
   \   000011   FC           MOV     R4,A
   \   000012   7A18         MOV     R2,#0x18
   \   000014   7B10         MOV     R3,#0x10
   \   000016   7405         MOV     A,#0x5
   \   000018   2E           ADD     A,R6
   \   000019   F9           MOV     R1,A
   \   00001A   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
   \   00001D   7402         MOV     A,#0x2
   \   00001F   12....       LCALL   ?DEALLOC_XSTACK8
   1420          }
   \   000022   7F02         MOV     R7,#0x2
   \   000024   02....       LJMP    ?BANKED_LEAVE_XDATA
   1421          #endif // ZTOOL_PORT
   1422          
   1423          
   1424          #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
   1425          #if defined ( MT_USER_TEST_FUNC )
   1426          /*********************************************************************
   1427           * @fn      MT_ProcessAppUserCmd
   1428           *
   1429           * @brief
   1430           *
   1431           *   Temp function for testing
   1432           *
   1433           * @param   data - received message
   1434           *
   1435           * @return  void
   1436           */
   1437          void MT_ProcessAppUserCmd( byte *pData) 						
   1438          {
   1439            uint16 app_cmd;
   1440            byte srcEp;
   1441            uint16 param1;
   1442            uint16 param2;
   1443            byte len;
   1444            uint16 ret;
   1445          
   1446            ret = INVALID_TASK;     //should be changed later
   1447          
   1448            srcEp = *pData++;
   1449          
   1450            app_cmd = BUILD_UINT16( pData[1] , pData[0] );
   1451            pData = pData + sizeof( uint16 );
   1452          
   1453            param1 = BUILD_UINT16( pData[1] , pData[0] );
   1454            pData = pData + sizeof( uint16 );
   1455          
   1456            param2 = BUILD_UINT16( pData[1] , pData[0] );
   1457          
   1458            len = SPI_RESP_MSG_LEN_DEFAULT;
   1459          
   1460          
   1461            switch ( app_cmd )
   1462            {
   1463          
   1464          #if defined (APP_TGEN)
   1465              case TGEN_START:
   1466                TrafficGenApp_SendCmdMSG( param1, param2, TRAFFICGENAPP_CMD_START );
   1467                ret = ZSUCCESS;
   1468                break;
   1469          
   1470              case TGEN_STOP:
   1471                TrafficGenApp_SendCmdMSG( param1, param2, TRAFFICGENAPP_CMD_STOP );
   1472                ret = ZSUCCESS;
   1473                break;
   1474          
   1475              case TGEN_COUNT:
   1476                ret = TrafficGenApp_CountPkt( param1, param2 );
   1477                return;		// so that spi_resp is not sent...
   1478                //ret = ZSUCCESS;
   1479                break;				
   1480          #endif
   1481          
   1482          #if defined (NWK_TEST)
   1483              case HW_TEST:
   1484                HwApp_Start( HI_UINT16(param1), LO_UINT16(param1), HI_UINT16(param2),
   1485                              1000, LO_UINT16(param2), 3, 0 );
   1486                break;
   1487          
   1488              case HW_DISPLAY_RESULT:
   1489                HwApp_TestInfo();
   1490                break;
   1491          
   1492              case HW_SEND_STATUS:
   1493                HwApp_SendStats();
   1494                break;
   1495          #endif
   1496          
   1497          #if defined( APP_TP ) || defined ( APP_TP2 )
   1498            #if defined( APP_TP )
   1499              case TP_SEND_NODATA:
   1500                ret = TestProfileApp_SendNoData( srcEp, (byte)param1 );
   1501                break;
   1502            #endif // APP_TP
   1503          			
   1504              case TP_SEND_BUFFERTEST:
   1505                ret = TestProfileApp_SendBufferReq( srcEp, (byte)param1 );
   1506                break;
   1507          			
   1508            #if defined( APP_TP )
   1509              case TP_SEND_UINT8:
   1510                ret = TestProfileApp_SendUint8( srcEp, (byte)param1 );
   1511                break;
   1512          
   1513              case TP_SEND_INT8:
   1514                ret = TestProfileApp_SendInt8( srcEp, (byte)param1 );
   1515                break;
   1516          
   1517              case TP_SEND_UINT16:
   1518                ret = TestProfileApp_SendUint16( srcEp, (byte)param1 );
   1519                break;
   1520          
   1521              case TP_SEND_INT16:
   1522                ret = TestProfileApp_SendInt16( srcEp, (byte)param1 );
   1523                break;
   1524          
   1525              case TP_SEND_SEMIPREC:
   1526                ret = TestProfileApp_SendSemiPrec( srcEp, (byte)param1 );
   1527                break;
   1528          
   1529              case TP_SEND_FREEFORM:
   1530                ret = TestProfileApp_SendFreeFormReq( srcEp, (byte)param1 );
   1531                break;
   1532          			
   1533            #else // APP_TP
   1534              case TP_SEND_FREEFORM:
   1535                ret = TestProfileApp_SendFreeFormReq(srcEp, (byte)param1, (byte)param2);
   1536                break;
   1537            #endif
   1538          			
   1539            #if defined( APP_TP )
   1540              case TP_SEND_ABS_TIME:
   1541                ret = TestProfileApp_SendAbsTime( srcEp, (byte)param1 );
   1542                break;
   1543          
   1544              case TP_SEND_REL_TIME:
   1545                ret = TestProfileApp_SendRelativeTime( srcEp, (byte)param1 );
   1546                break;
   1547          
   1548              case TP_SEND_CHAR_STRING:
   1549                ret = TestProfileApp_SendCharString( srcEp, (byte)param1 );
   1550                break;
   1551          
   1552              case TP_SEND_OCTET_STRING:
   1553                ret = TestProfileApp_SendOctetString( srcEp, (byte)param1 );
   1554                break;		
   1555            #endif // APP_TP
   1556          				
   1557              case TP_SET_DSTADDRESS:			
   1558                ret = TestProfileApp_SetDestAddress(HI_UINT16(param1), LO_UINT16(param1), param2);
   1559                break;	
   1560          
   1561            #if defined( APP_TP2 )
   1562              case TP_SEND_BUFFER_GROUP:
   1563                ret = TestProfileApp_SendBufferGroup( srcEp, (byte)param1 );
   1564                break;
   1565            #endif // APP_TP
   1566          
   1567              case TP_SEND_BUFFER:
   1568                ret = TestProfileApp_SendBuffer( srcEp, (byte)param1 );
   1569                break;
   1570          				
   1571            #if defined( APP_TP )
   1572              case TP_SEND_MULT_KVP_8BIT:
   1573                TestProfileApp_SendMultiKVP_8bit( srcEp, (byte)param1 );
   1574                ret = ZSuccess;
   1575                break;
   1576          
   1577              case TP_SEND_MULT_KVP_16BIT:
   1578                TestProfileApp_SendMultiKVP_16bit( srcEp, (byte)param1 );
   1579                ret = ZSuccess;
   1580                break;
   1581          
   1582              case TP_SEND_MULT_KVP_TIME:
   1583                TestProfileApp_SendMultiKVP_Time( srcEp, (byte)param1 );
   1584                ret = ZSuccess;
   1585                break;
   1586          
   1587              case TP_SEND_MULT_KVP_STRING:
   1588                TestProfileApp_SendMultiKVP_String( srcEp, (byte)param1 );
   1589                ret = ZSuccess;
   1590                break;
   1591          
   1592              case TP_SEND_MULTI_KVP_STR_TIME:
   1593                ret = ZSuccess;
   1594                TestProfileApp_SendMultiKVP_String_Time( srcEp, (byte)param1 );
   1595                break;
   1596            #endif // APP_TP
   1597          				
   1598              case TP_SEND_COUNTED_PKTS:
   1599                TestProfileApp_SendCountedPktsReq(HI_UINT16(param1), LO_UINT16(param1), param2);
   1600                ret = ZSuccess;
   1601                break;
   1602          
   1603              case TP_SEND_RESET_COUNTER:
   1604                TestProfileApp_CountedPakts_ResetCounterReq( (byte)param1 );
   1605                ret = ZSuccess;
   1606                break;
   1607          
   1608              case TP_SEND_GET_COUNTER:
   1609                TestProfileApp_CountedPakts_GetCounterReq( srcEp, (byte)param1 );
   1610                ret = ZSuccess;
   1611                break;
   1612          				
   1613              case TP_SET_PERMIT_JOIN:
   1614            #if defined ( RTR_NWK )
   1615                NLME_PermitJoiningRequest( (byte)param1 );
   1616                ret = ZSuccess;
   1617            #else
   1618                ret = ZFailure;
   1619            #endif
   1620                break;
   1621          
   1622            #if defined ( APP_TP2 )
   1623              case TP_ADD_GROUP:
   1624                ret = TestProfileApp_SetGroup( srcEp, param1 );
   1625                break;
   1626          
   1627              case TP_REMOVE_GROUP:
   1628                ret = TestProfileApp_RemoveGroup( srcEp, param1 );
   1629                break;
   1630          
   1631              case TP_SEND_UPDATE_KEY:
   1632                ret = TestProfileApp_UpdateKey( srcEp, (uint8)param1, param2 );
   1633                break;
   1634          
   1635              case TP_SEND_SWITCH_KEY:
   1636                ret = TestProfileApp_SwitchKey(  srcEp, (uint8)param1, param2 );
   1637                break;
   1638          			
   1639              case TP_SEND_BUFFERTEST_GROUP:
   1640                ret = TestProfileApp_SendBufferGroupReq( srcEp, (byte)param1 );
   1641                break;
   1642          
   1643              case TP_SEND_ROUTE_DISC_REQ:
   1644                ret = TestProfileApp_SendRouteDiscReq( srcEp, param1,
   1645                                            HI_UINT16( param2 ), LO_UINT16( param2 ) );
   1646                break;
   1647          
   1648              case TP_SEND_ROUTE_DISCOVERY:
   1649          #if defined ( RTR_NWK )
   1650                ret = TestProfileApp_SendRouteDiscovery( param1,
   1651                                            HI_UINT16( param2 ), LO_UINT16( param2 ) );
   1652          #endif
   1653                break;
   1654          
   1655            #endif // APP_TP2
   1656          
   1657          #endif  // APP_TP || APP_TP2
   1658          
   1659          #if defined ( OSAL_TOTAL_MEM )
   1660              case OSAL_MEM_STACK_HIGH_WATER:
   1661              case OSAL_MEM_HEAP_HIGH_WATER:
   1662                if ( app_cmd == OSAL_MEM_STACK_HIGH_WATER)
   1663                  param1 = osal_stack_used();
   1664                else
   1665                  param1 = osal_heap_high_water();
   1666                pData[0] = HI_UINT16( param1 );
   1667                pData[1] = LO_UINT16( param1 );
   1668          
   1669                // The pData for this response will only send one byte,
   1670                // so we are going to call it twice.
   1671                //        MT_BuildAndSendZToolResponse( (SPI_0DATA_MSG_LEN + sizeof( uint16 )),
   1672                //                                    (SPI_CMD_USER_TEST | SPI_RESPONSE_BIT),
   1673                //                                    sizeof( uint16 ), pData );
   1674                MT_SendSPIRespMsg( pData[0], SPI_CMD_USER_TEST, SPI_RESP_MSG_LEN_DEFAULT, 1);
   1675                MT_SendSPIRespMsg( pData[1], SPI_CMD_USER_TEST, SPI_RESP_MSG_LEN_DEFAULT, 1);
   1676                return;
   1677          #endif
   1678          
   1679          #if defined ( APP_DEBUG )
   1680              case DEBUG_GET:
   1681                DebugApp_SendQuery( param1 );
   1682                ret = ZSUCCESS;
   1683                break;
   1684          #endif
   1685          
   1686          #if defined ( APP_TP2 )
   1687              case TP_SEND_BCAST_RSP:
   1688                ret = TestProfileApp_SendBcastRsp( srcEp, (byte)param1 );
   1689                break;
   1690          #endif
   1691          			
   1692              default:
   1693                break;
   1694            }
   1695          
   1696            MT_SendSPIRespMsg( ( byte )ret, SPI_CMD_USER_TEST, len, 1);
   1697          
   1698          }
   1699          #endif // MT_USER_TEST_FUNC
   1700          #endif // ZTOOL
   1701          
   1702          #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
   1703          /***************************************************************************************************
   1704           * @fn      MT_RAMRead
   1705           *
   1706           * @brief
   1707           *
   1708           *   Process Serial Message.
   1709           *
   1710           * @param   UINT16 addr - address to read from
   1711           * @param   pData - pointer to buffer to put read data
   1712           *
   1713           * @return  ZSuccess or ZFailure
   1714           *
   1715           * @MT SPI_CMD_SYS_RAM_READ
   1716           *
   1717           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1718          byte MT_RAMRead( UINT16 addr, byte *pData  )
   \                     MT_RAMRead:
   1719          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   1720            byte *pAddr;
   1721          
   1722            if ( IS_MEM_VALID( addr ) )
   \   000005   C3           CLR     C
   \   000006   EA           MOV     A,R2
   \   000007   9400         SUBB    A,#0x0
   \   000009   EB           MOV     A,R3
   \   00000A   94E0         SUBB    A,#-0x20
   \   00000C   4006         JC      ??MT_RAMRead_0
   \   00000E   7801         MOV     R0,#0x1
   \   000010   7900         MOV     R1,#0x0
   \   000012   8004         SJMP    ??MT_RAMRead_1
   \                     ??MT_RAMRead_0:
   \   000014   7800         MOV     R0,#0x0
   \   000016   7900         MOV     R1,#0x0
   \                     ??MT_RAMRead_1:
   \   000018   7400         MOV     A,#0x0
   \   00001A   68           XRL     A,R0
   \   00001B   7003         JNZ     ??MT_RAMRead_2
   \   00001D   7400         MOV     A,#0x0
   \   00001F   69           XRL     A,R1
   \                     ??MT_RAMRead_2:
   \   000020   6012         JZ      ??MT_RAMRead_3
   1723            {
   1724              pAddr = (byte *)addr;
   \   000022   EA           MOV     A,R2
   \   000023   FE           MOV     R6,A
   \   000024   EB           MOV     A,R3
   \   000025   FF           MOV     R7,A
   1725              *pData = *pAddr;
   \   000026   8E82         MOV     DPL,R6
   \   000028   8F83         MOV     DPH,R7
   \   00002A   E0           MOVX    A,@DPTR
   \   00002B   8C82         MOV     DPL,R4
   \   00002D   8D83         MOV     DPH,R5
   \   00002F   F0           MOVX    @DPTR,A
   1726              return ( (byte)ZSuccess );
   \   000030   7900         MOV     R1,#0x0
   \   000032   8009         SJMP    ??MT_RAMRead_4
   1727            }
   1728            else
   1729            {
   1730              *pData = 0;
   \                     ??MT_RAMRead_3:
   \   000034   7400         MOV     A,#0x0
   \   000036   8C82         MOV     DPL,R4
   \   000038   8D83         MOV     DPH,R5
   \   00003A   F0           MOVX    @DPTR,A
   1731              return ( (byte)ZFailure );
   \   00003B   7901         MOV     R1,#0x1
   \                     ??MT_RAMRead_4:
   \   00003D   7F01         MOV     R7,#0x1
   \   00003F   02....       LJMP    ?BANKED_LEAVE_XDATA
   1732            }
   1733          }
   1734          #endif
   1735          
   1736          #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
   1737          /***************************************************************************************************
   1738           * @fn      MT_RAMWrite
   1739           *
   1740           * @brief
   1741           *
   1742           *   Process Serial Message.
   1743           *
   1744           * @param   UINT16 addr - address to write at
   1745           * @param   byte val  - values to fill in the above address and the next
   1746           *
   1747           * @return  ZSuccess or ZFailure
   1748           *
   1749           * @MT SPI_CMD_SYS_RAM_WRITE
   1750           *
   1751           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1752          byte MT_RAMWrite( UINT16 addr, byte val )
   \                     MT_RAMWrite:
   1753          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   \   000004   E9           MOV     A,R1
   \   000005   FC           MOV     R4,A
   1754            if ( IS_MEM_VALID( addr ) )
   \   000006   C3           CLR     C
   \   000007   EA           MOV     A,R2
   \   000008   9400         SUBB    A,#0x0
   \   00000A   EB           MOV     A,R3
   \   00000B   94E0         SUBB    A,#-0x20
   \   00000D   4006         JC      ??MT_RAMWrite_0
   \   00000F   7801         MOV     R0,#0x1
   \   000011   7900         MOV     R1,#0x0
   \   000013   8004         SJMP    ??MT_RAMWrite_1
   \                     ??MT_RAMWrite_0:
   \   000015   7800         MOV     R0,#0x0
   \   000017   7900         MOV     R1,#0x0
   \                     ??MT_RAMWrite_1:
   \   000019   7400         MOV     A,#0x0
   \   00001B   68           XRL     A,R0
   \   00001C   7003         JNZ     ??MT_RAMWrite_2
   \   00001E   7400         MOV     A,#0x0
   \   000020   69           XRL     A,R1
   \                     ??MT_RAMWrite_2:
   \   000021   600A         JZ      ??MT_RAMWrite_3
   1755            {
   1756              *((byte*)(addr)) = val;
   \   000023   EC           MOV     A,R4
   \   000024   8A82         MOV     DPL,R2
   \   000026   8B83         MOV     DPH,R3
   \   000028   F0           MOVX    @DPTR,A
   1757              return ( (byte)ZSuccess );
   \   000029   7900         MOV     R1,#0x0
   \   00002B   8002         SJMP    ??MT_RAMWrite_4
   1758            }
   1759            else
   1760              return ( (byte)ZFailure );
   \                     ??MT_RAMWrite_3:
   \   00002D   7901         MOV     R1,#0x1
   \                     ??MT_RAMWrite_4:
   \   00002F   D083         POP     DPH
   \   000031   D082         POP     DPL
   \   000033   02....       LJMP    ?BRET
   1761          }
   1762          #endif
   1763          
   1764          #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
   1765          /***************************************************************************************************
   1766           * @fn      MT_SetDebugThreshold
   1767           *
   1768           * @brief
   1769           *
   1770           *   Set Debug Threshold for software components.
   1771           *
   1772           * @param   comp_id   - software component ID.
   1773           * @param   threshold - threshold value for reporting debug messages.
   1774           *
   1775           * @return  ZSuccess
   1776           *
   1777           * @MT SPI_CMD_SYS_SET_DEBUG_THRESHOLD
   1778           *
   1779           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1780          byte MT_SetDebugThreshold( byte compID, byte threshold )
   \                     MT_SetDebugThreshold:
   1781          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   \   000004   E9           MOV     A,R1
   \   000005   FB           MOV     R3,A
   1782            // *** RKJ - for now if we get any threshold message, set it on
   1783            debugThreshold = threshold;
   \   000006   EA           MOV     A,R2
   \   000007   90....       MOV     DPTR,#debugThreshold
   \   00000A   F0           MOVX    @DPTR,A
   1784            debugCompId = compID;
   \   00000B   EB           MOV     A,R3
   \   00000C   90....       MOV     DPTR,#debugCompId
   \   00000F   F0           MOVX    @DPTR,A
   1785          
   1786            return ( (byte)ZSuccess );
   \   000010   7900         MOV     R1,#0x0
   \   000012   D083         POP     DPH
   \   000014   D082         POP     DPL
   \   000016   02....       LJMP    ?BRET
   1787          }
   1788          #endif
   1789          
   1790          /***************************************************************************************************
   1791           * @fn      MT_Reset
   1792           *
   1793           * @brief
   1794           *
   1795           *   Reset/reprogram the device.
   1796           *
   1797           * @param   typID: 0=reset, 1=serial bootloader
   1798           *
   1799           * @return  void
   1800           *
   1801           * @MT SPI_CMD_SYS_RESET
   1802           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1803          void MT_Reset( byte typID )
   \                     MT_Reset:
   1804          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   1805            if ( typID )
   \   000005   E9           MOV     A,R1
   \   000006   601B         JZ      ??MT_Reset_0
   1806            {
   1807              // Jump to bootloader
   1808              BootLoader();
   \   000008   C2AF         CLR     0xa8.7
   \   00000A   90....       MOV     DPTR,#__Constant_53544159
   \   00000D   78..         MOV     R0,#?V0 + 0
   \   00000F   12....       LCALL   ?L_MOV_X
   \   000012   90E000       MOV     DPTR,#-0x2000
   \   000015   78..         MOV     R0,#?V0 + 0
   \   000017   12....       LCALL   ?L_MOV_TO_X
   \   00001A   75C9AB       MOV     0xc9,#-0x55
   \   00001D   75C95B       MOV     0xc9,#0x5b
   \                     ??MT_Reset_1:
   \   000020   00           NOP
   \   000021   80FD         SJMP    ??MT_Reset_1
   1809            }
   1810            else
   1811            {
   1812              // Restart this program
   1813              SystemReset();
   \                     ??MT_Reset_0:
   \   000023   C2AF         CLR     0xa8.7
   \   000025   75C9AB       MOV     0xc9,#-0x55
   \   000028   75C95B       MOV     0xc9,#0x5b
   \                     ??MT_Reset_2:
   \   00002B   00           NOP
   \   00002C   80FD         SJMP    ??MT_Reset_2
   \   00002E                REQUIRE _A_IEN0
   \   00002E                REQUIRE WDCTL
   \   00002E                REQUIRE mboxMsg
   1814            }
   1815          }
   1816          
   1817          #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
   1818          /***************************************************************************************************
   1819           * @fn      MT_SendErrorNotification
   1820           *
   1821           * @brief
   1822           *
   1823           *   Send Error Notofication Message to Test Tool.
   1824           *
   1825           * @param   byte err
   1826           *
   1827           * @return  void
   1828           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1829          void MT_SendErrorNotification( byte err )
   \                     MT_SendErrorNotification:
   1830          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   85..82       MOV     DPL,?XSP + 0
   \   00000E   85..83       MOV     DPH,?XSP + 1
   \   000011   F0           MOVX    @DPTR,A
   1831            MT_BuildAndSendZToolResponse( (SPI_0DATA_MSG_LEN + 1),
   1832                                        (SPI_RESPONSE_BIT | SPI_CMD_SYS_RAM_WRITE),
   1833                                        1, &err );
   \   000012                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000012   85..82       MOV     DPL,?XSP + 0
   \   000015   85..83       MOV     DPH,?XSP + 1
   \   000018   8582..       MOV     ?V0 + 0,DPL
   \   00001B   8583..       MOV     ?V0 + 1,DPH
   \   00001E   78..         MOV     R0,#?V0 + 0
   \   000020   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000023   7C01         MOV     R4,#0x1
   \   000025   7A02         MOV     R2,#0x2
   \   000027   7B10         MOV     R3,#0x10
   \   000029   7906         MOV     R1,#0x6
   \   00002B   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
   \   00002E   7402         MOV     A,#0x2
   \   000030   12....       LCALL   ?DEALLOC_XSTACK8
   1834          }
   \   000033   7401         MOV     A,#0x1
   \   000035   12....       LCALL   ?DEALLOC_XSTACK8
   \   000038   7F02         MOV     R7,#0x2
   \   00003A   02....       LJMP    ?BANKED_LEAVE_XDATA
   1835          #endif
   1836          
   1837          /***************************************************************************************************
   1838           * @fn      MT_ReverseBytes
   1839           *
   1840           * @brief
   1841           *
   1842           *   Reverses bytes within an array
   1843           *
   1844           * @param   data - ptr to data buffer to reverse
   1845           * @param    len - number of bytes in buffer
   1846           *
   1847           * @return  void
   1848           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1849          void MT_ReverseBytes( byte *pData, byte len )
   \                     MT_ReverseBytes:
   1850          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   1851            byte i,j;
   1852            byte temp;
   1853          
   1854            for ( i = 0, j = len-1; len > 1; len-=2 ) {
   \   000005   7D00         MOV     R5,#0x0
   \   000007   74FF         MOV     A,#-0x1
   \   000009   29           ADD     A,R1
   \   00000A   FC           MOV     R4,A
   \                     ??MT_ReverseBytes_0:
   \   00000B   E9           MOV     A,R1
   \   00000C   C3           CLR     C
   \   00000D   9402         SUBB    A,#0x2
   \   00000F   4050         JC      ??MT_ReverseBytes_1
   1855              temp = pData[i];
   \   000011   8D..         MOV     ?V0 + 0,R5
   \   000013   75..00       MOV     ?V0 + 1,#0x0
   \   000016   EA           MOV     A,R2
   \   000017   25..         ADD     A,?V0 + 0
   \   000019   F582         MOV     DPL,A
   \   00001B   EB           MOV     A,R3
   \   00001C   35..         ADDC    A,?V0 + 1
   \   00001E   F583         MOV     DPH,A
   \   000020   E0           MOVX    A,@DPTR
   \   000021   FE           MOV     R6,A
   1856              pData[i++] = pData[j];
   \   000022   8C..         MOV     ?V0 + 0,R4
   \   000024   75..00       MOV     ?V0 + 1,#0x0
   \   000027   EA           MOV     A,R2
   \   000028   25..         ADD     A,?V0 + 0
   \   00002A   F582         MOV     DPL,A
   \   00002C   EB           MOV     A,R3
   \   00002D   35..         ADDC    A,?V0 + 1
   \   00002F   F583         MOV     DPH,A
   \   000031   E0           MOVX    A,@DPTR
   \   000032   C0E0         PUSH    A
   \   000034   8D..         MOV     ?V0 + 0,R5
   \   000036   75..00       MOV     ?V0 + 1,#0x0
   \   000039   EA           MOV     A,R2
   \   00003A   25..         ADD     A,?V0 + 0
   \   00003C   F582         MOV     DPL,A
   \   00003E   EB           MOV     A,R3
   \   00003F   35..         ADDC    A,?V0 + 1
   \   000041   F583         MOV     DPH,A
   \   000043   D0E0         POP     A
   \   000045   F0           MOVX    @DPTR,A
   \   000046   0D           INC     R5
   1857              pData[j--] = temp;
   \   000047   EE           MOV     A,R6
   \   000048   C0E0         PUSH    A
   \   00004A   8C..         MOV     ?V0 + 0,R4
   \   00004C   75..00       MOV     ?V0 + 1,#0x0
   \   00004F   EA           MOV     A,R2
   \   000050   25..         ADD     A,?V0 + 0
   \   000052   F582         MOV     DPL,A
   \   000054   EB           MOV     A,R3
   \   000055   35..         ADDC    A,?V0 + 1
   \   000057   F583         MOV     DPH,A
   \   000059   D0E0         POP     A
   \   00005B   F0           MOVX    @DPTR,A
   \   00005C   1C           DEC     R4
   1858            }
   \   00005D   19           DEC     R1
   \   00005E   19           DEC     R1
   \   00005F   80AA         SJMP    ??MT_ReverseBytes_0
   1859          }
   \                     ??MT_ReverseBytes_1:
   \   000061   7F02         MOV     R7,#0x2
   \   000063   02....       LJMP    ?BANKED_LEAVE_XDATA
   1860          
   1861          /***************************************************************************************************
   1862           * @fn      MT_SendSPIRespMsg
   1863           *
   1864           * @brief
   1865           *
   1866           *   This function is used to process messages in the queue
   1867           *
   1868           * @param   none
   1869           *
   1870           * @return  void
   1871           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1872          void MT_SendSPIRespMsg( byte ret, uint16 cmd_id, byte msgLen, byte respLen)
   \                     MT_SendSPIRespMsg:
   1873          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   85..82       MOV     DPL,?XSP + 0
   \   00000E   85..83       MOV     DPH,?XSP + 1
   \   000011   F0           MOVX    @DPTR,A
   \   000012   8A..         MOV     ?V0 + 4,R2
   \   000014   8B..         MOV     ?V0 + 5,R3
   \   000016   8C..         MOV     ?V0 + 1,R4
   \   000018   8D..         MOV     ?V0 + 0,R5
   1874            byte *msgPtr;
   1875          
   1876            msgPtr = osal_mem_alloc( msgLen );
   \   00001A                ; Setup parameters for call to function osal_mem_alloc
   \   00001A   E5..         MOV     A,?V0 + 1
   \   00001C   F5..         MOV     ?V0 + 2,A
   \   00001E   AA..         MOV     R2,?V0 + 2
   \   000020   7B00         MOV     R3,#0x0
   \   000022   12....       LCALL   ??osal_mem_alloc?relay
   \   000025   8A..         MOV     ?V0 + 2,R2
   \   000027   8B..         MOV     ?V0 + 3,R3
   \   000029   AE..         MOV     R6,?V0 + 2
   \   00002B   AF..         MOV     R7,?V0 + 3
   1877            if ( msgPtr )
   \   00002D   EE           MOV     A,R6
   \   00002E   6400         XRL     A,#0x0
   \   000030   7003         JNZ     ??MT_SendSPIRespMsg_0
   \   000032   EF           MOV     A,R7
   \   000033   6400         XRL     A,#0x0
   \                     ??MT_SendSPIRespMsg_0:
   \   000035   6041         JZ      ??MT_SendSPIRespMsg_1
   1878            {
   1879          #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
   1880              MT_BuildSPIMsg( (SPI_RESPONSE_BIT | cmd_id), msgPtr, respLen, &ret );
   \   000037                ; Setup parameters for call to function MT_BuildSPIMsg
   \   000037   85..82       MOV     DPL,?XSP + 0
   \   00003A   85..83       MOV     DPH,?XSP + 1
   \   00003D   8582..       MOV     ?V0 + 2,DPL
   \   000040   8583..       MOV     ?V0 + 3,DPH
   \   000043   78..         MOV     R0,#?V0 + 2
   \   000045   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000048   A9..         MOV     R1,?V0 + 0
   \   00004A   EE           MOV     A,R6
   \   00004B   FC           MOV     R4,A
   \   00004C   EF           MOV     A,R7
   \   00004D   FD           MOV     R5,A
   \   00004E   7400         MOV     A,#0x0
   \   000050   45..         ORL     A,?V0 + 4
   \   000052   FA           MOV     R2,A
   \   000053   7410         MOV     A,#0x10
   \   000055   45..         ORL     A,?V0 + 5
   \   000057   FB           MOV     R3,A
   \   000058   12....       LCALL   ??MT_BuildSPIMsg?relay
   \   00005B   7402         MOV     A,#0x2
   \   00005D   12....       LCALL   ?DEALLOC_XSTACK8
   1881              HalUARTWrite ( SPI_MGR_DEFAULT_PORT, msgPtr, msgLen );
   \   000060                ; Setup parameters for call to function HalUARTWrite
   \   000060   E5..         MOV     A,?V0 + 1
   \   000062   F5..         MOV     ?V0 + 2,A
   \   000064   AC..         MOV     R4,?V0 + 2
   \   000066   7D00         MOV     R5,#0x0
   \   000068   EE           MOV     A,R6
   \   000069   FA           MOV     R2,A
   \   00006A   EF           MOV     A,R7
   \   00006B   FB           MOV     R3,A
   \   00006C   7900         MOV     R1,#0x0
   \   00006E   12....       LCALL   ??HalUARTWrite?relay
   1882          #endif
   1883          
   1884              osal_mem_free( msgPtr );
   \   000071                ; Setup parameters for call to function osal_mem_free
   \   000071   EE           MOV     A,R6
   \   000072   FA           MOV     R2,A
   \   000073   EF           MOV     A,R7
   \   000074   FB           MOV     R3,A
   \   000075   12....       LCALL   ??osal_mem_free?relay
   1885            }
   1886          }
   \                     ??MT_SendSPIRespMsg_1:
   \   000078   7401         MOV     A,#0x1
   \   00007A   12....       LCALL   ?DEALLOC_XSTACK8
   \   00007D   7F06         MOV     R7,#0x6
   \   00007F   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for <Constant "1.00 (F8W1.4.3)">`:
   \   000000   312E3030     DB "1.00 (F8W1.4.3)"
   \            20284638
   \            57312E34
   \            2E332900

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for <Constant "1.10 (F8W1.4.3)">`:
   \   000000   312E3130     DB "1.10 (F8W1.4.3)"
   \            20284638
   \            57312E34
   \            2E332900

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for MTVersionString>`:
   \   000000   ........     DW `?<Constant "1.00 (F8W1.4.3)">`, `?<Constant "1.10 (F8W1.4.3)">`

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for __Constant_3e8>`:
   \   000000   E8030000     DD 1000

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for __Constant_53544159>`:
   \   000000   59415453     DD 1398030681

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_TaskInit?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_TaskInit

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_IndReset?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_IndReset

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_ProcessEvent?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_ProcessEvent

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_BuildSPIMsg?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_BuildSPIMsg

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_BuildAndSendZToolResponse?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_BuildAndSendZToolResponse

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_BuildAndSendZToolCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_BuildAndSendZToolCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_ProcessCommand?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_ProcessCommand

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_ProcessDebugMsg?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_ProcessDebugMsg

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_ProcessDebugStr?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_ProcessDebugStr

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_ProcessSetNV?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_ProcessSetNV

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_ProcessGetNV?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_ProcessGetNV

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_ProcessGetNvInfo?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_ProcessGetNvInfo

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_ProcessGetDeviceInfo?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_ProcessGetDeviceInfo

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_ProcessSerialCommand?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_ProcessSerialCommand

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MTProcessLedControl?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MTProcessLedControl

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MTProcessAppMsg?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MTProcessAppMsg

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MTProcessAppRspMsg?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MTProcessAppRspMsg

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_RAMRead?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_RAMRead

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_RAMWrite?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_RAMWrite

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_SetDebugThreshold?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_SetDebugThreshold

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_Reset?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_Reset

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_SendErrorNotification?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_SendErrorNotification

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_ReverseBytes?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_ReverseBytes

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_SendSPIRespMsg?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_SendSPIRespMsg

   \                                 In  segment XDATA_I, align 1, keep-with-next
   \                     `?<Constant "1.00 (F8W1.4.3)">`:
   \   000000                DS 16
   \   000010                REQUIRE `?<Initializer for <Constant "1.00 (F8W1.4.3)">`
   \   000010                REQUIRE __INIT_XDATA_I

   \                                 In  segment XDATA_I, align 1, keep-with-next
   \                     `?<Constant "1.10 (F8W1.4.3)">`:
   \   000000                DS 16
   \   000010                REQUIRE `?<Initializer for <Constant "1.10 (F8W1.4.3)">`
   \   000010                REQUIRE __INIT_XDATA_I

   \                                 In  segment XDATA_I, align 1, keep-with-next
   \                     __Constant_3e8:
   \   000000                DS 4
   \   000004                REQUIRE `?<Initializer for __Constant_3e8>`
   \   000004                REQUIRE __INIT_XDATA_I

   \                                 In  segment XDATA_I, align 1, keep-with-next
   \                     __Constant_53544159:
   \   000000                DS 4
   \   000004                REQUIRE `?<Initializer for __Constant_53544159>`
   \   000004                REQUIRE __INIT_XDATA_I
   1887          
   1888          #endif  // MT_TASK
   1889          
   1890          /***************************************************************************************************
   1891          ***************************************************************************************************/

   Maximum stack usage in bytes:

     Function                       ISTACK PSTACK XSTACK
     --------                       ------ ------ ------
     MTProcessAppMsg                    1      0     64
       -> afFindEndPointDesc            0      0     36
       -> osal_msg_allocate             0      0     36
       -> osal_memcpy                   0      0     42
       -> osal_msg_send                 0      0     36
     MTProcessAppRspMsg                 0      0     26
       -> MT_BuildAndSendZToolResponse
                                        0      0     24
     MTProcessLedControl                0      0     55
       -> HalLedSet                     0      0     24
     MT_BuildAndSendZToolCB             1      0     22
       -> osal_msg_allocate             0      0     38
       -> osal_memcpy                   0      0     44
       -> osal_msg_send                 0      0     38
     MT_BuildAndSendZToolResponse       0      0     63
       -> osal_mem_alloc                0      0     32
       -> MT_BuildSPIMsg                0      0     36
       -> HalUARTWrite                  0      0     32
       -> osal_mem_free                 0      0     32
     MT_BuildSPIMsg                     1      0     50
       -> osal_memcpy                   0      0     42
       -> SPIMgr_CalcFCS                0      0     36
     MT_IndReset                        1      0     13
       -> MT_BuildAndSendZToolResponse
                                        0      0     26
     MT_ProcessCommand                  1      0     28
       -> MT_ProcessSerialCommand       0      0     28
       -> MT_ProcessDebugMsg            0      0     28
       -> MT_ProcessDebugStr            0      0     28
       -> SPIMgr_CalcFCS                0      0     28
       -> HalUARTWrite                  0      0     28
       -> MTProcessAppRspMsg            0      0     28
       -> osal_msg_deallocate           0      0     28
     MT_ProcessDebugMsg                 1      0     43
       -> osal_msg_allocate             0      0     54
       -> MT_BuildSPIMsg                0      0     58
       -> HalUARTWrite                  0      0     54
       -> osal_msg_deallocate           0      0     54
     MT_ProcessDebugStr                 0      0     28
       -> osal_mem_alloc                0      0     24
       -> MT_BuildSPIMsg                0      0     28
       -> HalUARTWrite                  0      0     24
       -> osal_mem_free                 0      0     24
     MT_ProcessEvent                    0      0     14
       -> osal_msg_receive              0      0     28
       -> MT_ProcessCommand             0      0     28
       -> MT_SendErrorNotification      0      0     28
     MT_ProcessGetDeviceInfo            1      0     68
       -> osal_mem_alloc                0      0     42
       -> osal_nv_read                  0      0     50
       -> MT_ReverseBytes               0      0     42
       -> NLME_GetShortAddr             0      0     42
       -> osal_memset                   0      0     42
       -> osal_mem_free                 0      0     42
       -> MT_BuildAndSendZToolResponse
                                        0      0     46
       -> osal_mem_free                 0      0     42
     MT_ProcessGetNV                    1      0     65
       -> osal_nv_item_len              0      0     36
       -> osal_mem_alloc                0      0     36
       -> osal_memset                   0      0     36
       -> osal_nv_read                  0      0     44
       -> MT_BuildAndSendZToolResponse
                                        0      0     40
       -> osal_mem_free                 0      0     36
     MT_ProcessGetNvInfo                1      0     71
       -> osal_mem_alloc                0      0     48
       -> osal_memset                   0      0     48
       -> osal_nv_read                  0      0     56
       -> MT_ReverseBytes               0      0     48
       -> osal_nv_read                  0      0     56
       -> osal_nv_read                  0      0     56
       -> osal_nv_read                  0      0     56
       -> osal_nv_read                  0      0     56
       -> MT_BuildAndSendZToolResponse
                                        0      0     52
       -> osal_mem_free                 0      0     48
     MT_ProcessSerialCommand            1      0     61
       -> MT_RAMRead                    0      0     86
       -> MT_RAMWrite                   0      0     86
       -> MT_SetDebugThreshold          0      0     86
       -> MT_Reset                      0      0     86
       -> NLME_GetProtocolVersion       0      0     86
       -> osal_strlen                   0      0     86
       -> MT_ReverseBytes               0      0     86
       -> ZMacSetReq                    0      0     86
       -> osal_nv_write                 0      0     94
       -> ZMacGetReq                    0      0     86
       -> MT_ReverseBytes               0      0     86
       -> osal_nv_item_len              0      0     86
       -> osal_nv_write                 0      0     94
       -> osal_nv_item_len              0      0     86
       -> osal_nv_write                 0      0     94
       -> osal_nv_item_len              0      0     86
       -> osal_nv_write                 0      0     94
       -> osal_nv_item_len              0      0     86
       -> osal_nv_write                 0      0     94
       -> MT_ProcessGetNvInfo           0      0     86
       -> MT_ProcessGetDeviceInfo       0      0     86
       -> MT_ProcessSetNV               0      0     86
       -> MT_ProcessGetNV               0      0     86
       -> osal_GetSystemClock           0      0     86
       -> OnBoard_SendKeys              0      0     86
       -> MTProcessAppMsg               0      0     86
       -> MTProcessLedControl           0      0     86
       -> MT_BuildAndSendZToolResponse
                                        0      0     90
     MT_ProcessSetNV                    0      0     61
       -> osal_nv_item_len              0      0     28
       -> osal_nv_write                 0      0     36
     MT_RAMRead                         1      0     52
     MT_RAMWrite                        3      0     43
     MT_Reset                           0      0     55
     MT_ReverseBytes                    1      0     53
     MT_SendErrorNotification           1      0     27
       -> MT_BuildAndSendZToolResponse
                                        0      0     26
     MT_SendSPIRespMsg                  1      0     17
       -> osal_mem_alloc                0      0     30
       -> MT_BuildSPIMsg                0      0     34
       -> HalUARTWrite                  0      0     30
       -> osal_mem_free                 0      0     30
     MT_SetDebugThreshold               2      0     43
     MT_TaskInit                        0      0      9
       -> SPIMgr_Init                   0      0     18


   Segment part sizes:

     Function/Label                 Bytes
     --------------                 -----
     _A_IEN0                           1
     WDCTL                             1
     mboxMsg                           8
     MTVersionString                   4
     MT_TaskID                         1
     debugThreshold                    1
     debugCompId                       1
     save_cmd                          2
     longvar                           4
     temp_glob_ptr1                    2
     temp_glob_ptr2                    2
     MT_TaskInit                      30
     MT_IndReset                      62
     MT_ProcessEvent                 105
     MT_BuildSPIMsg                  214
     MT_BuildAndSendZToolResponse    112
     MT_BuildAndSendZToolCB          253
     MT_ProcessCommand               209
     MT_ProcessDebugMsg              516
     MT_ProcessDebugStr              126
     MT_ProcessSetNV                  81
     MT_ProcessGetNV                 223
     MT_ProcessGetNvInfo             585
     MT_ProcessGetDeviceInfo         480
     MT_ProcessSerialCommand        1933
     MTProcessLedControl             168
     MTProcessAppMsg                 266
     MTProcessAppRspMsg               39
     MT_RAMRead                       66
     MT_RAMWrite                      54
     MT_SetDebugThreshold             25
     MT_Reset                         46
     MT_SendErrorNotification         61
     MT_ReverseBytes                 102
     MT_SendSPIRespMsg               130
     ?<Initializer for <Constant "1.00 (F8W1.4.3)">
                                      16
     ?<Initializer for <Constant "1.10 (F8W1.4.3)">
                                      16
     ?<Initializer for MTVersionString>
                                       4
     ?<Initializer for __Constant_3e8>
                                       4
     ?<Initializer for __Constant_53544159>
                                       4
     ??MT_TaskInit?relay               6
     ??MT_IndReset?relay               6
     ??MT_ProcessEvent?relay           6
     ??MT_BuildSPIMsg?relay            6
     ??MT_BuildAndSendZToolResponse?relay
                                       6
     ??MT_BuildAndSendZToolCB?relay    6
     ??MT_ProcessCommand?relay         6
     ??MT_ProcessDebugMsg?relay        6
     ??MT_ProcessDebugStr?relay        6
     ??MT_ProcessSetNV?relay           6
     ??MT_ProcessGetNV?relay           6
     ??MT_ProcessGetNvInfo?relay       6
     ??MT_ProcessGetDeviceInfo?relay
                                       6
     ??MT_ProcessSerialCommand?relay
                                       6
     ??MTProcessLedControl?relay       6
     ??MTProcessAppMsg?relay           6
     ??MTProcessAppRspMsg?relay        6
     ??MT_RAMRead?relay                6
     ??MT_RAMWrite?relay               6
     ??MT_SetDebugThreshold?relay      6
     ??MT_Reset?relay                  6
     ??MT_SendErrorNotification?relay
                                       6
     ??MT_ReverseBytes?relay           6
     ??MT_SendSPIRespMsg?relay         6
     ?<Constant "1.00 (F8W1.4.3)">    16
     ?<Constant "1.10 (F8W1.4.3)">    16
     __Constant_3e8                    4
     __Constant_53544159               4

 
 5 886 bytes in segment BANKED_CODE
   144 bytes in segment BANK_RELAYS
     2 bytes in segment SFR_AN
     8 bytes in segment XDATA_AN
    44 bytes in segment XDATA_I
    44 bytes in segment XDATA_ID
    13 bytes in segment XDATA_Z
 
 6 066 bytes of CODE  memory (+  8 bytes shared)
     0 bytes of DATA  memory (+  2 bytes shared)
    49 bytes of XDATA memory (+ 16 bytes shared)

Errors: none
Warnings: none
